!function(){function t(t){return t&&t.__esModule?t.default:t}var e={};function n(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t,e,n,i,r,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var s=t.apply(e,n);function a(t){i(s,r,o,a,u,"next",t)}function u(t){i(s,r,o,a,u,"throw",t)}a(void 0)}))}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){return c(t)}function h(t,e,n){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n||t):r.value}})(t,e,n)}function f(t,e,n){return h(t,e,n)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){u(t,e,n[e])}))}return t}function y(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function m(t,e){return!e||"object"!=((i=e)&&i.constructor===Symbol?"symbol":typeof i)&&"function"!=typeof e?n(t):e;var i}function _(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function g(t,e){return function(t){if(Array.isArray(t))return t}(t)||_(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function k(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||_(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function x(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=l(t);if(e){var r=l(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return m(this,n)}}var b,w,T={},S=function(t){var e,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,i){var r=e&&e.prototype instanceof y?e:y,o=Object.create(r.prototype),s=new O(i||[]);return o._invoke=function(t,e,n){var i=h;return function(r,o){if(i===p)throw new Error("Generator is already running");if(i===d){if("throw"===r)throw o;return E()}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=S(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var u=l(t,e,n);if("normal"===u.type){if(i=n.done?d:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=d,n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",f="suspendedYield",p="executing",d="completed",v={};function y(){}function m(){}function _(){}var g={};u(g,o,(function(){return this}));var k=Object.getPrototypeOf,x=k&&k(k(C([])));x&&x!==n&&i.call(x,o)&&(g=x);var b=_.prototype=y.prototype=Object.create(g);function w(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(r,o,s,a){var u=l(t[r],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,a)}))}a(u.arg)}var r;this._invoke=function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}}function S(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=l(i,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,v;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function n(){for(;++r<t.length;)if(i.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:E}}function E(){return{value:e,done:!0}}return m.prototype=_,u(b,"constructor",_),u(_,"constructor",m),m.displayName=u(_,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,a,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},w(T.prototype),u(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,i,r,o){void 0===o&&(o=Promise);var s=new T(c(e,n,i,r),o);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(b),u(b,a,"Generator"),u(b,o,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=C,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(i,r){return a.type="throw",a.arg=t,n.next=i,r&&(n.method="next",n.arg=e),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var u=i.call(s,"catchLoc"),c=i.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),D(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;D(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:C(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}(T);try{regeneratorRuntime=S}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=S:Function("r","regeneratorRuntime = r")(S)}
/*! For license information please see Tone.js.LICENSE.txt */b="undefined"!=typeof self?self:void 0,w=function(){return function(){var e={228:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.default=t.exports,t.exports.__esModule=!0},858:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0},575:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},913:function(t){function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t},t.exports.default=t.exports,t.exports.__esModule=!0},884:function(t){t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);s=!0);}catch(t){a=!0,r=t}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}},t.exports.default=t.exports,t.exports.__esModule=!0},521:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},38:function(t,e,n){var i=n(858),r=n(884),o=n(379),s=n(521);t.exports=function(t,e){return i(t)||r(t,e)||o(t,e)||s()},t.exports.default=t.exports,t.exports.__esModule=!0},379:function(t,e,n){var i=n(228);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},382:function(t,e,n){!function(t,e,n,i){function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=r(e),s=r(n),a=r(i),u=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},c=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},f=function(t,e,n){var i=n.startTime,r=n.target,o=n.timeConstant;return r+(e-r)*Math.exp((i-t)/o)},p=function(t){return"exponentialRampToValue"===t.type},d=function(t){return"linearRampToValue"===t.type},v=function(t){return p(t)||d(t)},y=function(t){return"setValue"===t.type},m=function(t){return"setValueCurve"===t.type},_=function t(e,n,i,r){var o=e[n];return void 0===o?r:v(o)||y(o)?o.value:m(o)?o.values[o.values.length-1]:f(i,t(e,n-1,o.startTime,r),o)},g=function(t,e,n,i,r){return void 0===n?[i.insertTime,r]:v(n)?[n.endTime,n.value]:y(n)?[n.startTime,n.value]:m(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,_(t,e-1,n.startTime,r)]},k=function(t){return"cancelAndHold"===t.type},x=function(t){return"cancelScheduledValues"===t.type},b=function(t){return k(t)||x(t)?t.cancelTime:p(t)||d(t)?t.endTime:t.startTime},w=function(t,e,n,i){var r=i.endTime,o=i.value;return n===o?o:0<n&&0<o||n<0&&o<0?n*Math.pow(o/n,(t-e)/(r-e)):0},T=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},S=function(t){return"setTarget"===t.type},A=function(t){function e(t){s.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return a.default(e,[{key:t,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=b(t);if(k(t)||x(t)){var n=this._automationEvents.findIndex((function(n){return x(t)&&m(n)?n.startTime+n.duration>=e:b(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),k(t)){var r=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&v(i)){if(S(r))throw new Error("The internal list is malformed.");var o=m(r)?r.startTime+r.duration:b(r),s=m(r)?r.values[r.values.length-1]:r.value,a=p(i)?w(e,o,s,i):T(e,o,s,i),f=p(i)?u(a,e,this._currenTime):c(a,e,this._currenTime);this._automationEvents.push(f)}void 0!==r&&S(r)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==r&&m(r)&&r.startTime+r.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),r.startTime,e-r.startTime))}}else{var y=this._automationEvents.findIndex((function(t){return b(t)>e})),_=-1===y?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[y-1];if(void 0!==_&&m(_)&&b(_)+_.duration>e)return!1;var g=p(t)?u(t.value,t.endTime,this._currenTime):d(t)?c(t.value,e,this._currenTime):t;if(-1===y)this._automationEvents.push(g);else{if(m(t)&&e+t.duration>b(this._automationEvents[y]))return!1;this._automationEvents.splice(y,0,g)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return b(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];S(i)&&n.unshift(l(_(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return b(e)>t})),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,r=this._automationEvents[i];if(void 0!==r&&S(r)&&(void 0===n||!v(n)||n.insertTime>t))return f(t,_(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(void 0!==r&&y(r)&&(void 0===n||!v(n)))return r.value;if(void 0!==r&&m(r)&&(void 0===n||!v(n)||r.startTime+r.duration>t))return t<r.startTime+r.duration?function(t,e){var n,i,r,o,s=e.duration,a=e.startTime,u=e.values;return n=u,i=(t-a)/s*(u.length-1),r=Math.floor(i),o=Math.ceil(i),r===o?n[r]:(1-(i-r))*n[r]+(1-(o-i))*n[o]}(t,r):r.values[r.values.length-1];if(void 0!==r&&v(r)&&(void 0===n||!v(n)))return r.value;if(void 0!==n&&p(n)){var s=g(this._automationEvents,i,r,n,this._defaultValue),a=o.default(s,2),u=a[0],c=a[1];return w(t,u,c,n)}if(void 0!==n&&d(n)){var l=g(this._automationEvents,i,r,n,this._defaultValue),h=o.default(l,2),k=h[0],x=h[1];return T(t,k,x,n)}return this._defaultValue}}]),e}(Symbol.iterator);t.AutomationEventList=A,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},t.createSetTargetAutomationEvent=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}},t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(38),n(575),n(913))}},i={};function s(t){var n=i[t];if(void 0!==n)return n.exports;var r=i[t]={exports:{}};return e[t].call(r.exports,r,r.exports,s),r.exports}s.d=function(t,e){for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var c={};return function(){var e=t(T).mark(Ja),i=t(T).mark(Ha),h=t(T).mark(Qa),p=t(T).mark(Xa),_=t(T).mark(Za),b=t(T).mark(Ua),w=t(T).mark(Ga),S=t(T).mark(Ba);s.r(c),s.d(c,{AMOscillator:function(){return Ls},AMSynth:function(){return _a},Abs:function(){return na},Add:function(){return Zs},AmplitudeEnvelope:function(){return va},Analyser:function(){return Nu},AudioToGain:function(){return Is},AutoFilter:function(){return iu},AutoPanner:function(){return ou},AutoWah:function(){return au},BaseContext:function(){return Hr},BiquadFilter:function(){return ga},BitCrusher:function(){return cu},Buffer:function(){return kc},BufferSource:function(){return bc},Buffers:function(){return xc},Channel:function(){return Xu},Chebyshev:function(){return hu},Chorus:function(){return yu},Clock:function(){return Bo},Compressor:function(){return tc},Context:function(){return Jr},Convolver:function(){return sc},CrossFade:function(){return tu},DCMeter:function(){return Gu},Delay:function(){return Go},Destination:function(){return hc},Distortion:function(){return mu},Draw:function(){return yc},DuoSynth:function(){return wa},EQ3:function(){return oc},Emitter:function(){return Qr},Envelope:function(){return ha},FFT:function(){return Bu},FMOscillator:function(){return zs},FMSynth:function(){return Ta},FatOscillator:function(){return Bs},FeedbackCombFilter:function(){return Va},FeedbackDelay:function(){return gu},Filter:function(){return ka},Follower:function(){return su},Freeverb:function(){return Tu},Frequency:function(){return To},FrequencyClass:function(){return xo},FrequencyEnvelope:function(){return xa},FrequencyShifter:function(){return xu},Gain:function(){return Fo},GainToAudio:function(){return ia},Gate:function(){return ec},GrainPlayer:function(){return ea},GreaterThan:function(){return aa},GreaterThanZero:function(){return sa},IntervalTimeline:function(){return $o},JCReverb:function(){return Ou},LFO:function(){return Hs},Limiter:function(){return nc},Listener:function(){return dc},Loop:function(){return za},LowpassCombFilter:function(){return Ia},Master:function(){return fc},MembraneSynth:function(){return Da},Merge:function(){return pu},MetalSynth:function(){return Aa},Meter:function(){return Wu},MidSideCompressor:function(){return ic},MidSideMerge:function(){return Fu},MidSideSplit:function(){return Vu},Midi:function(){return Xo},MidiClass:function(){return Zo},Mono:function(){return Qu},MonoSynth:function(){return ba},MultibandCompressor:function(){return rc},MultibandSplit:function(){return Hu},Multiply:function(){return Ps},Negate:function(){return ra},Noise:function(){return ms},NoiseSynth:function(){return Oa},Offline:function(){return Uo},OfflineContext:function(){return no},OmniOscillator:function(){return Ys},OnePoleFilter:function(){return Fa},Oscillator:function(){return Os},PWMOscillator:function(){return Gs},PanVol:function(){return Zu},Panner:function(){return ru},Panner3D:function(){return $u},Param:function(){return Co},Part:function(){return Wa},Pattern:function(){return $a},Phaser:function(){return qu},PingPongDelay:function(){return Eu},PitchShift:function(){return Mu},Player:function(){return Ks},Players:function(){return ta},PluckSynth:function(){return Pa},PolySynth:function(){return ja},Pow:function(){return ua},PulseOscillator:function(){return Ws},Recorder:function(){return Ku},Reverb:function(){return Ru},Sampler:function(){return La},Scale:function(){return Xs},ScaleExp:function(){return ca},Sequence:function(){return Ka},Signal:function(){return jo},Solo:function(){return Yu},Split:function(){return fu},StateTimeline:function(){return Oo},StereoWidener:function(){return Pu},Subtract:function(){return oa},SyncedSignal:function(){return la},Synth:function(){return ya},Ticks:function(){return Ho},TicksClass:function(){return Qo},Time:function(){return ko},TimeClass:function(){return go},Timeline:function(){return Gr},ToneAudioBuffer:function(){return eo},ToneAudioBuffers:function(){return Yo},ToneAudioNode:function(){return Eo},ToneBufferSource:function(){return ys},ToneEvent:function(){return Na},ToneOscillatorNode:function(){return Ds},Transport:function(){return cc},TransportTime:function(){return Ao},TransportTimeClass:function(){return So},Tremolo:function(){return ju},Unit:function(){return D},UserMedia:function(){return Ss},Vibrato:function(){return Lu},Volume:function(){return es},WaveShaper:function(){return Fs},Waveform:function(){return Uu},Zero:function(){return Qs},connect:function(){return qo},connectSeries:function(){return Mo},connectSignal:function(){return Lo},context:function(){return _c},dbToGain:function(){return lo},debug:function(){return A},defaultArg:function(){return Fr},disconnect:function(){return Ro},fanIn:function(){return Vo},ftom:function(){return vo},gainToDb:function(){return ho},getContext:function(){return oo},getDestination:function(){return pc},getDraw:function(){return mc},getListener:function(){return vc},getTransport:function(){return lc},immediate:function(){return uc},intervalToFrequencyRatio:function(){return fo},isArray:function(){return ur},isBoolean:function(){return ar},isDefined:function(){return ir},isFunction:function(){return rr},isNote:function(){return lr},isNumber:function(){return or},isObject:function(){return sr},isString:function(){return cr},isUndef:function(){return nr},loaded:function(){return gc},mtof:function(){return mo},now:function(){return ac},optionsFromArguments:function(){return Vr},setContext:function(){return so},start:function(){return ao},supported:function(){return er},version:function(){return O}});var A={};s.r(A),s.d(A,{assert:function(){return hr},assertContextRunning:function(){return pr},assertRange:function(){return fr},assertUsedScheduleTime:function(){return mr},enterScheduledCallback:function(){return yr},log:function(){return kr},setLogger:function(){return gr},warn:function(){return xr}});var D={};s.r(D);var O="14.8.36",C=s(382),E=new WeakSet,M=new WeakMap,q=new WeakMap,R=new WeakMap,V=new WeakMap,F=new WeakMap,I=new WeakMap,P=new WeakMap,j=new WeakMap,L=new WeakMap,N={construct:function(){return N}},z=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,W=function(t,e){for(var n=[],i=t.replace(/^[\s]+/,""),r=i.match(z);null!==r;){var o=r[1].slice(1,-1),s=r[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,e).toString());n.push(s),r=(i=i.slice(r[0].length).replace(/^[\s]+/,"")).match(z)}return[n.join(";"),i]},B=function(t){if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},G=function(t){if(!function(t){try{new new Proxy(t,N)}catch(t){return!1}return!0}(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},U=function(t,e){var n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},Y=function(t,e){var n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");var i=g(n)[0];return t.delete(i),i},Z=function(t,e,n,i){var r=U(t,e),o=Y(r,(function(t){return t[0]===n&&t[1]===i}));return 0===r.size&&t.delete(e),o},X=function(t){return U(I,t)},Q=function(t){if(E.has(t))throw new Error("The AudioNode is already stored.");E.add(t),X(t).forEach((function(t){return t(!0)}))},H=function(t){return"port"in t},J=function(t){if(!E.has(t))throw new Error("The AudioNode is not stored.");E.delete(t),X(t).forEach((function(t){return t(!1)}))},$=function(t,e){!H(t)&&e.every((function(t){return 0===t.size}))&&J(t)},K={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},tt=function(t,e){return t.context===e},et=function(t){try{t.copyToChannel(new Float32Array(1),0,-1)}catch(t){return!1}return!0},nt=function(){return new DOMException("","IndexSizeError")},it=function(t){var e;t.getChannelData=(e=t.getChannelData,function(n){try{return e.call(t,n)}catch(t){if(12===t.code)throw nt();throw t}})},rt={numberOfChannels:1},ot=-34028234663852886e22,st=-ot,at=function(t){return E.has(t)},ut=function(t){return U(M,t)},ct=function(t){return U(R,t)},lt=function(t,e){ut(t).activeInputs.forEach((function(n){return n.forEach((function(n){var i=g(n)[0];e.includes(t)||lt(i,k(e).concat([t]))}))}));var n="playbackRate"in t?[t.playbackRate]:H(t)?Array.from(t.parameters.values()):function(t){return"frequency"in t&&"gain"in t}(t)?[t.Q,t.detune,t.frequency,t.gain]:function(t){return"offset"in t}(t)?[t.offset]:function(t){return!("frequency"in t)&&"gain"in t}(t)?[t.gain]:function(t){return"detune"in t&&"frequency"in t}(t)?[t.detune,t.frequency]:function(t){return"pan"in t}(t)?[t.pan]:[],i=!0,r=!1,o=void 0;try{for(var s,a=n[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var u=s.value,c=ct(u);void 0!==c&&c.activeInputs.forEach((function(t){var n=g(t)[0];return lt(n,e)}))}}catch(t){r=!0,o=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}at(t)&&J(t)},ht=function(t){lt(t.destination,[])},ft=function(t){return"context"in t},pt=function(t){return ft(t[0])},dt=function(t,e,n,i){var r=!0,o=!1,s=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done);r=!0)if(n(a.value)){if(i)return!1;throw Error("The set contains at least one similar element.")}}catch(t){o=!0,s=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw s}}return t.add(e),!0},vt=function(t,e,n,i){var r=g(n),o=r[0],s=r[1];dt(t,[e,o,s],(function(t){return t[0]===e&&t[1]===o}),i)},yt=function(t,e,n){var i=g(e),r=i[0],o=i[1],s=i[2],a=t.get(r);void 0===a?t.set(r,new Set([[o,s]])):dt(a,[o,s],(function(t){return t[0]===o}),n)},mt=function(t){return"inputs"in t},_t=function(t,e,n,i){if(mt(e)){var r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},gt=function(t,e,n){var i=!0,r=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var u=s.value;if(u[0]===e&&u[1]===n)return t.delete(u),u}}catch(t){r=!0,o=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return null},kt=function(t,e){if(!X(t).delete(e))throw new Error("Missing the expected event listener.")},xt=function(t,e,n){var i=U(t,e),r=Y(i,(function(t){return t[0]===n}));return 0===i.size&&t.delete(e),r},bt=function(t,e,n,i){mt(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},wt=function(t){return U(q,t)},Tt=function(t){return U(V,t)},St=function(t){return P.has(t)},At=function(t){return!E.has(t)},Dt=function(t,e){return new Promise((function(n){if(null!==e)n(!0);else{var i=t.createScriptProcessor(256,1,1),r=t.createGain(),o=t.createBuffer(1,2,44100),s=o.getChannelData(0);s[0]=1,s[1]=1;var a=t.createBufferSource();a.buffer=o,a.loop=!0,a.connect(i).connect(t.destination),a.connect(r),a.disconnect(r),i.onaudioprocess=function(e){var r=e.inputBuffer.getChannelData(0);Array.prototype.some.call(r,(function(t){return 1===t}))?n(!0):n(!1),a.stop(),i.onaudioprocess=null,a.disconnect(i),i.disconnect(t.destination)},a.start()}}))},Ot=function(t,e){var n=new Map,i=!0,r=!1,o=void 0,s=!0,a=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h=c.value;try{for(var f,p=h[Symbol.iterator]();!(i=(f=p.next()).done);i=!0){var d=f.value,v=n.get(d);n.set(d,void 0===v?1:v+1)}}catch(t){r=!0,o=t}finally{try{i||null==p.return||p.return()}finally{if(r)throw o}}}}catch(t){a=!0,u=t}finally{try{s||null==l.return||l.return()}finally{if(a)throw u}}n.forEach((function(t,n){return e(n,t)}))},Ct=function(t){return"context"in t},Et=function(t,e,n,i,r){var o,s,a,u,c,l,h,f=g((o=t,s=i,a=r,u=ut(n),c=u.activeInputs,l=u.passiveInputs,null===(h=gt(c[a],o,s))?[Z(l,o,s,a)[2],!1]:[h[2],!0])),p=f[0],d=f[1];if(null!==p&&(kt(t,p),!d||e||St(t)||bt(wt(t),wt(n),i,r)),at(n)){var v=ut(n).activeInputs;$(n,v)}},Mt=function(t,e,n,i){var r,o,s,a,u,c,l=g((r=t,o=i,s=ct(n),a=s.activeInputs,u=s.passiveInputs,null===(c=gt(a,r,o))?[xt(u,r,o)[1],!1]:[c[2],!0])),h=l[0],f=l[1];null!==h&&(kt(t,h),!f||e||St(t)||wt(t).disconnect(Tt(n),i))},qt=function(){"use strict";function t(e){o(this,t),this._map=new Map(e)}return a(t,[{key:"size",get:function(){return this._map.size}},{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this;return this._map.forEach((function(i,r){return t.call(e,i,r,n)}))}},{key:"get",value:function(t){return this._map.get(t)}},{key:"has",value:function(t){return this._map.has(t)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}}]),t}(),Rt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function Vt(t,e,n,i,r){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{var o=t.getChannelData(i);if(0===e[n].byteLength)e[n]=o.slice(r,r+128);else{var s=new Float32Array(o.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(s)}}}var Ft=function(t,e,n,i,r){"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,r):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],r)},It=function(t,e){for(var n=[],i=0;i<t;i+=1){for(var r=[],o="number"==typeof e?e:e[i],s=0;s<o;s+=1)r.push(new Float32Array(128));n.push(r)}return n},Pt=r(t(T).mark((function e(n,i,r,o,s,a,c){var l,h,f,p,d,y,m,_,g,k,x,b,w,S,A,D,O,C,E;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=null===i?128*Math.ceil(n.context.length/128):i.length,h=o.channelCount*o.numberOfInputs,f=s.reduce((function(t,e){return t+e}),0),p=0===f?null:r.createBuffer(f,l,r.sampleRate),void 0!==a){t.next=3;break}throw new Error("Missing the processor constructor.");case 3:return d=ut(n),t.next=6,e=n,T=void 0,M=void 0,T=U(L,r),M=wt(e),U(T,M);case 6:y=t.sent,m=It(o.numberOfInputs,o.channelCount),_=It(o.numberOfOutputs,s),g=Array.from(n.parameters.keys()).reduce((function(t,e){return v({},t,u({},e,new Float32Array(128)))}),{}),k=0;case 11:if(!(k<l)){t.next=29;break}if(o.numberOfInputs>0&&null!==i)for(x=0;x<o.numberOfInputs;x+=1)for(b=0;b<o.channelCount;b+=1)Vt(i,m[x],b,b,k);for(void 0!==a.parameterDescriptors&&null!==i&&a.parameterDescriptors.forEach((function(t,e){var n=t.name;Vt(i,g,n,h+e,k)})),w=0;w<o.numberOfInputs;w+=1)for(S=0;S<s[w];S+=1)0===_[w][S].byteLength&&(_[w][S]=new Float32Array(128));if(t.prev=15,A=m.map((function(t,e){return 0===d.activeInputs[e].size?[]:t})),D=c(k/r.sampleRate,r.sampleRate,(function(){return y.process(A,_,g)})),null!==p)for(O=0,C=0;O<o.numberOfOutputs;O+=1){for(E=0;E<s[O];E+=1)Ft(p,_[O],E,C+E,k);C+=s[O]}if(D){t.next=20;break}return t.abrupt("break",29);case 20:t.next=26;break;case 22:return t.prev=22,t.t0=t.catch(15),n.dispatchEvent(new ErrorEvent("processorerror",{colno:t.t0.colno,filename:t.t0.filename,lineno:t.t0.lineno,message:t.t0.message})),t.abrupt("break",29);case 26:k+=128,t.next=11;break;case 29:return t.abrupt("return",p);case 30:case"end":return t.stop()}var e,T,M}),e,null,[[15,22]])}))),jt=function(t){var e=new MessageChannel,n=e.port1,i=e.port2;return new Promise((function(e){var r=function(){i.onmessage=null,n.close(),i.close(),e()};i.onmessage=function(){return r()};try{n.postMessage(t,[t])}finally{r()}}))},Lt=function(t,e,n){var i=e[n];if(void 0===i)throw t();return i},Nt=function(){return new DOMException("","InvalidStateError")},zt=function(){return new DOMException("","InvalidAccessError")},Wt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Bt=function(t){var e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{var n=t.decodeAudioData(e.buffer,(function(){}));return void 0!==n&&(n.catch((function(){})),!0)}catch(t){}return!1},Gt=function(t,e,n){var i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},Ut=function(t,e){Gt(t,e,"channelCount"),Gt(t,e,"channelCountMode"),Gt(t,e,"channelInterpretation")},Yt=function(t){return"function"==typeof t.getFloatTimeDomainData},Zt=function(t,e,n){var i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},Xt=function(t){var e;t.start=(e=t.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if("number"==typeof r&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})},Qt=function(t){var e;t.stop=(e=t.stop,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},Ht=function(t,e){return null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e)))))},Jt=function(t,e){var n,i,r=t.createChannelSplitter(e.numberOfOutputs);return Ut(r,e),i=(n=r).numberOfOutputs,Object.defineProperty(n,"channelCount",{get:function(){return i},set:function(t){if(t!==i)throw Nt()}}),Object.defineProperty(n,"channelCountMode",{get:function(){return"explicit"},set:function(t){if("explicit"!==t)throw Nt()}}),Object.defineProperty(n,"channelInterpretation",{get:function(){return"discrete"},set:function(t){if("discrete"!==t)throw Nt()}}),r},$t=function(t,e){return t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t},Kt=function(t,e){var n=t.createGain();return Ut(n,e),Zt(n,e,"gain"),n};var te,ee,ne,ie,re,oe,se,ae,ue,ce,le,he,fe,pe,de,ve,ye,me,_e,ge,ke,xe,be,we,Te,Se,Ae,De,Oe,Ce,Ee,Me,qe,Re,Ve,Fe,Ie,Pe,je,Le,Ne,ze,We,Be,Ge,Ue,Ye,Ze,Xe,Qe,He,Je,$e,Ke,tn,en,nn,rn,on,sn,an,un,cn,ln=function(t,e,n,i){return t.createScriptProcessor(e,n,i)},hn=function(){return new DOMException("","NotSupportedError")},fn={numberOfChannels:1},pn={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},dn={disableNormalization:!1},vn={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},yn={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},mn=function(t,e,n){return void 0===t.copyFromChannel?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0])},_n=function(t){if(null===t)return!1;var e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},gn=function(t,e,n,i){for(var r=t;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);var o=Object.getOwnPropertyDescriptor(r,e),s=o.get,a=o.set;Object.defineProperty(t,e,{get:n(s),set:i(a)})},kn=function(t,e,n){try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;kn(t,e,n+1e-7)}},xn=function(t){var e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},bn=function(t){var e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch(t){return!1}},wn=function(t){var e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Tn=function(){try{new DOMException}catch(t){return!1}return!0},Sn=function(){return new Promise((function(t){var e=new ArrayBuffer(0),n=new MessageChannel,i=n.port1,r=n.port2;i.onmessage=function(e){var n=e.data;return t(null!==n)},r.postMessage(e,[e])}))},An=function(t,e){var n=e.createGain();t.connect(n);var i,r=(i=t.disconnect,function(){i.call(t,n),t.removeEventListener("ended",r)});t.addEventListener("ended",r),$t(t,n),t.stop=function(e){var i=!1;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(i)try{e.call(t,r)}catch(t){n.gain.setValueAtTime(0,r)}else e.call(t,r),i=!0}}(t.stop)},Dn=function(t,e){return function(n){var i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)}},On=(ie=dt,function(t,e,n,i){var r=g(n),o=r[0],s=r[1],a=r[2];ie(t[s],[e,o,a],(function(t){return t[0]===e&&t[1]===o}),i)}),Cn=(ne=dt,function(t,e,n,i){var r=g(n),o=r[0],s=r[1],a=r[2],u=t.get(o);void 0===u?t.set(o,new Set([[s,e,a]])):ne(u,[s,e,a],(function(t){return t[0]===s&&t[1]===e}),i)}),En=(ee=Y,function(t,e,n,i){return ee(t[i],(function(t){return t[0]===e&&t[1]===n}))}),Mn=new WeakMap,qn=(te=Mn,function(t){var e;return null!==(e=te.get(t))&&void 0!==e?e:0}),Rn=(re=new Map,oe=new WeakMap,function(t,e){var n=oe.get(t);if(void 0!==n)return n;var i=re.get(t);if(void 0!==i)return i;try{var r=e();return r instanceof Promise?(re.set(t,r),r.catch((function(){return!1})).then((function(e){return re.delete(t),oe.set(t,e),e}))):(oe.set(t,r),r)}catch(e){return oe.set(t,!1),!1}}),Vn="undefined"==typeof window?null:window,Fn=(ce=Rn,le=nt,function(t,e){var n=t.createAnalyser();if(Ut(n,e),!(e.maxDecibels>e.minDecibels))throw le();return Gt(n,e,"fftSize"),Gt(n,e,"maxDecibels"),Gt(n,e,"minDecibels"),Gt(n,e,"smoothingTimeConstant"),ce(Yt,(function(){return Yt(n)}))||function(t){t.getFloatTimeDomainData=function(e){var n=new Uint8Array(e.length);t.getByteTimeDomainData(n);for(var i=Math.max(n.length,t.fftSize),r=0;r<i;r+=1)e[r]=.0078125*(n[r]-128);return e}}(n),n}),In=function(t){return function(e){var n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer}}(ut),Pn=(se=ut,ae=In,ue=St,r(t(T).mark((function e(n,i,o){var s;return t(T).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=se(n),e.next=3,Promise.all(s.activeInputs.map((function(e,s){return Array.from(e).map(r(t(T).mark((function e(r){var a,u,c,l,h,f;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=g(r),u=a[0],c=a[1],l=ae(u),t.next=4,l.render(u,i);case 4:h=t.sent,f=n.context.destination,ue(u)||n===f&&ue(n)||h.connect(o,c,s);case 7:case"end":return t.stop()}}),e)}))))})).reduce((function(t,e){return k(t).concat(k(e))}),[]));case 3:case"end":return e.stop()}}),e)})))),jn=function(e,n,i){return function(){var o=new WeakMap;return{render:function(s,a){var u=o.get(a);return void 0!==u?Promise.resolve(u):r(t(T).mark((function r(s,a){var u,c;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=n(s),tt(u,a)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,fftSize:u.fftSize,maxDecibels:u.maxDecibels,minDecibels:u.minDecibels,smoothingTimeConstant:u.smoothingTimeConstant},u=e(a,c)),o.set(a,u),t.next=5,i(s,a,u);case 5:return t.abrupt("return",(t.sent,u));case 6:case"end":return t.stop()}}),r)})))(s,a)}}}}(Fn,wt,Pn),Ln=(he=F,function(t){var e=he.get(t);if(void 0===e)throw Nt();return e}),Nn=function(t){return null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null}(Vn),zn=function(t){return function(e){return null!==t&&e instanceof t}}(Nn),Wn=new WeakMap,Bn=(fe=Dn,pe=function(){"use strict";function t(e){o(this,t),this._nativeEventTarget=e,this._listeners=new WeakMap}return a(t,[{key:"addEventListener",value:function(t,e,n){if(null!==e){var i=this._listeners.get(e);void 0===i&&(i=fe(this,e),"function"==typeof e&&this._listeners.set(e,i)),this._nativeEventTarget.addEventListener(t,i,n)}}},{key:"dispatchEvent",value:function(t){return this._nativeEventTarget.dispatchEvent(t)}},{key:"removeEventListener",value:function(t,e,n){var i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}}]),t}(),pe),Gn=function(t){return null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null}(Vn),Un=function(t){return function(e){return null!==t&&e instanceof t}}(Gn),Yn=function(t){return function(e){return null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode}}(Vn),Zn=function(t){return function(e){return null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam}}(Vn),Xn=function(t){return null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null}(Vn),Qn=function(t,e,i,r,s,u,c,l,h,f,p,v,y,_,b,w){var T=function(f){"use strict";d(S,f);var T=x(S);function S(e,r,s,a){var u;o(this,S),(u=T.call(this,s))._context=e,u._nativeAudioNode=s;var c,l,h,f,d=p(e);return v(d)&&!0!==i(Dt,(function(){return Dt(d,w)}))&&(c=s,f=new Map,c.connect=(h=c.connect.bind(c),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Ct(t)?h(t,e,n):h(t,e),r=f.get(t);return void 0===r?f.set(t,[{input:n,output:e}]):r.every((function(t){return t.input!==n||t.output!==e}))&&r.push({input:n,output:e}),i}),c.disconnect=(l=c.disconnect,function(t,e,n){var i=!0,r=!1,o=void 0;if(l.apply(c),void 0===t)f.clear();else if("number"==typeof t)try{for(var s,a=f[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var u=g(s.value),h=u[0],p=u[1].filter((function(e){return e.output!==t}));0===p.length?f.delete(h):f.set(h,p)}}catch(t){r=!0,o=t}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}else if(f.has(t))if(void 0===e)f.delete(t);else{var d=f.get(t);if(void 0!==d){var v=d.filter((function(t){return t.output!==e&&(t.input!==n||void 0===n)}));0===v.length?f.delete(t):f.set(t,v)}}var y=!0,m=!1,_=void 0;try{for(var k,x=function(t,e){var n=g(e.value),i=n[0];n[1].forEach((function(t){Ct(i)?c.connect(i,t.output,t.input):c.connect(i,t.output)}))},b=f[Symbol.iterator]();!(y=(k=b.next()).done);y=!0)x(0,k)}catch(t){m=!0,_=t}finally{try{y||null==b.return||b.return()}finally{if(m)throw _}}})),q.set(n(u),s),I.set(n(u),new Set),"closed"!==e.state&&r&&Q(n(u)),t(n(u),a,s),m(u)}return a(S,[{key:"channelCount",get:function(){return this._nativeAudioNode.channelCount},set:function(t){this._nativeAudioNode.channelCount=t}},{key:"channelCountMode",get:function(){return this._nativeAudioNode.channelCountMode},set:function(t){this._nativeAudioNode.channelCountMode=t}},{key:"channelInterpretation",get:function(){return this._nativeAudioNode.channelInterpretation},set:function(t){this._nativeAudioNode.channelInterpretation=t}},{key:"context",get:function(){return this._context}},{key:"numberOfInputs",get:function(){return this._nativeAudioNode.numberOfInputs}},{key:"numberOfOutputs",get:function(){return this._nativeAudioNode.numberOfOutputs}},{key:"connect",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw s();var o=p(this._context),a=b(o);if(y(t)||_(t))throw u();if(ft(t)){var l=wt(t);try{var f,d=_t(this._nativeAudioNode,l,n,i),v=At(this);(a||v)&&(f=this._nativeAudioNode).disconnect.apply(f,k(d)),"closed"!==this.context.state&&!v&&At(t)&&Q(t)}catch(t){if(12===t.code)throw u();throw t}if(e(this,t,n,i,a)){var m=h([this],t);Ot(m,r(a))}return t}var g=Tt(t);if("playbackRate"===g.name&&1024===g.maxValue)throw c();try{this._nativeAudioNode.connect(g,n),(a||At(this))&&this._nativeAudioNode.disconnect(g,n)}catch(t){if(12===t.code)throw u();throw t}if(function(t,e,n,i){var r=ct(e),o=r.activeInputs,s=r.passiveInputs,a=ut(t).outputs,u=X(t),c=function(r){var a=wt(t),u=Tt(e);if(r){var c=xt(s,t,n);vt(o,t,c,!1),i||St(t)||a.connect(u,n)}else{var l=function(t,e,n){return Y(t,(function(t){return t[0]===e&&t[1]===n}))}(o,t,n);yt(s,l,!1),i||St(t)||a.disconnect(u,n)}};return!!dt(a,[e,n],(function(t){return t[0]===e&&t[1]===n}),!0)&&(u.add(c),at(t)?vt(o,t,[n,c],!0):yt(s,[t,n,c],!0),!0)}(this,t,n,a)){var x=h([this],t);Ot(x,r(a))}}},{key:"disconnect",value:function(t,e,n){var i,r,o,a,c,f,d,v=p(this._context),y=b(v);if(void 0===t)i=function(t,e){var n=ut(t),i=[],r=!0,o=!1,s=void 0;try{for(var a,u=n.outputs[Symbol.iterator]();!(r=(a=u.next()).done);r=!0){var c=a.value;pt(c)?Et.apply(void 0,[t,e].concat(k(c))):Mt.apply(void 0,[t,e].concat(k(c))),i.push(c[0])}}catch(t){o=!0,s=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw s}}return n.outputs.clear(),i}(this,y);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw s();i=function(t,e,n){var i=ut(t),r=[],o=!0,s=!1,a=void 0;try{for(var u,c=i.outputs[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;l[1]===n&&(pt(l)?Et.apply(void 0,[t,e].concat(k(l))):Mt.apply(void 0,[t,e].concat(k(l))),r.push(l[0]),i.outputs.delete(l))}}catch(t){s=!0,a=t}finally{try{o||null==c.return||c.return()}finally{if(s)throw a}}return r}(this,y,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw s();if(ft(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw s();if(o=y,a=t,c=e,f=n,d=ut(r=this),i=Array.from(d.outputs).filter((function(t){return!(t[0]!==a||void 0!==c&&t[1]!==c||void 0!==f&&t[2]!==f)})).map((function(t){return pt(t)?Et.apply(void 0,[r,o].concat(k(t))):Mt.apply(void 0,[r,o].concat(k(t))),d.outputs.delete(t),t[0]})),0===i.length)throw u()}var m=!0,_=!1,g=void 0;try{for(var x,w=i[Symbol.iterator]();!(m=(x=w.next()).done);m=!0){var T=x.value,S=h([this],T);Ot(S,l)}}catch(t){_=!0,g=t}finally{try{m||null==w.return||w.return()}finally{if(_)throw g}}}}]),S}(f);return T}((de=M,function(t,e,n){for(var i=[],r=0;r<n.numberOfInputs;r+=1)i.push(new Set);de.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),function(t,e,n,i,r,o,s,a,u,c,l,h,f){var p=new WeakMap;return function(d,v,y,m,_){var g=o(v),k=g.activeInputs,x=g.passiveInputs,b=o(d).outputs,w=a(d),T=function(o){var a=u(v),c=u(d);if(o){var g=Z(x,d,y,m);t(k,d,g,!1),_||h(d)||n(c,a,y,m),f(v)&&Q(v)}else{var b=i(k,d,y,m);e(x,m,b,!1),_||h(d)||r(c,a,y,m);var w=s(v);if(0===w)l(v)&&$(v,k);else{var T=p.get(v);void 0!==T&&clearTimeout(T),p.set(v,setTimeout((function(){l(v)&&$(v,k)}),1e3*w))}}};return!!c(b,[v,y,m],(function(t){return t[0]===v&&t[1]===y&&t[2]===m}),!0)&&(w.add(T),l(d)?t(k,d,[y,m,T],!0):e(x,m,[d,y,T],!0),!0)}}(On,Cn,_t,En,bt,ut,qn,X,wt,dt,at,St,At),Rn,function(t,e,n,i,r,o){return function(s){return function(a,u){var c=t.get(a);if(void 0===c){if(!s&&o(a)){var l=i(a),h=n(a).outputs,f=!0,p=!1,d=void 0;try{for(var v,y=h[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var m=v.value;if(pt(m)){var _=i(m[0]);e(l,_,m[1],m[2])}else{var g=r(m[0]);l.disconnect(g,m[1])}}}catch(t){p=!0,d=t}finally{try{f||null==y.return||y.return()}finally{if(p)throw d}}}t.set(a,u)}else t.set(a,c+u)}}}(P,bt,ut,wt,Tt,at),nt,zt,hn,function(t,e,n,i,r,o,s,a){return function(u,c){var l=e.get(u);if(void 0===l)throw new Error("Missing the expected cycle count.");var h=o(u.context),f=a(h);if(l===c){if(e.delete(u),!f&&s(u)){var p=i(u),d=n(u).outputs,v=!0,y=!1,m=void 0;try{for(var _,g=d[Symbol.iterator]();!(v=(_=g.next()).done);v=!0){var k=_.value;if(pt(k)){var x=i(k[0]);t(p,x,k[1],k[2])}else{var b=r(k[0]);p.connect(b,k[1])}}}catch(t){y=!0,m=t}finally{try{v||null==g.return||g.return()}finally{if(y)throw m}}}}else e.set(u,l-c)}}(_t,P,ut,wt,Tt,Ln,at,zn),function(t,e,n){return function i(r,o){var s=ft(o)?o:n(t,o);if(function(t){return"delayTime"in t}(s))return[];if(r[0]===s)return[r];if(r.includes(s))return[];var a=e(s).outputs;return Array.from(a).map((function(t){return i(k(r).concat([s]),t[0])})).reduce((function(t,e){return t.concat(e)}),[])}}(Wn,ut,U),Bn,Ln,Un,Yn,Zn,zn,Xn),Hn=function(t,e,n,i,r,s){var u=function(t){"use strict";d(c,t);var u=x(c);function c(t,n){var a;o(this,c);var l=r(t),h=v({},K,n),f=i(l,h);return(a=u.call(this,t,!1,f,s(l)?e():null))._nativeAnalyserNode=f,m(a)}return a(c,[{key:"fftSize",get:function(){return this._nativeAnalyserNode.fftSize},set:function(t){this._nativeAnalyserNode.fftSize=t}},{key:"frequencyBinCount",get:function(){return this._nativeAnalyserNode.frequencyBinCount}},{key:"maxDecibels",get:function(){return this._nativeAnalyserNode.maxDecibels},set:function(t){var e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}},{key:"minDecibels",get:function(){return this._nativeAnalyserNode.minDecibels},set:function(t){var e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}},{key:"smoothingTimeConstant",get:function(){return this._nativeAnalyserNode.smoothingTimeConstant},set:function(t){this._nativeAnalyserNode.smoothingTimeConstant=t}},{key:"getByteFrequencyData",value:function(t){this._nativeAnalyserNode.getByteFrequencyData(t)}},{key:"getByteTimeDomainData",value:function(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}},{key:"getFloatFrequencyData",value:function(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}},{key:"getFloatTimeDomainData",value:function(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}}]),c}(t);return u}(Qn,jn,nt,Fn,Ln,zn),Jn=new WeakSet,$n=function(t){return null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null}(Vn),Kn=(ve=new Uint32Array(1),function(t){return ve[0]=t,ve[0]}),ti=function(t,e){return function(n){n.copyFromChannel=function(i,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=t(o),a=t(r);if(a>=n.numberOfChannels)throw e();for(var u=n.length,c=n.getChannelData(a),l=i.length,h=s<0?-s:0;h+s<u&&h<l;h+=1)i[h]=c[h+s]},n.copyToChannel=function(i,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=t(o),a=t(r);if(a>=n.numberOfChannels)throw e();for(var u=n.length,c=n.getChannelData(a),l=i.length,h=s<0?-s:0;h+s<u&&h<l;h+=1)c[h+s]=i[h]}}}(Kn,nt),ei=function(t){return function(e){e.copyFromChannel=function(n){return function(i,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=t(o),a=t(r);if(s<e.length)return n.call(e,i,a,s)}}(e.copyFromChannel),e.copyToChannel=function(n){return function(i,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=t(o),a=t(r);if(s<e.length)return n.call(e,i,a,s)}}(e.copyToChannel)}}(Kn),ni=function(t,e,n,i,r,s,u,c){var l,h=null;return l=Symbol.hasInstance,function(){"use strict";function f(a){if(o(this,f),null===r)throw new Error("Missing the native OfflineAudioContext constructor.");var l=v({},rt,a),p=l.length,d=l.numberOfChannels,y=l.sampleRate;null===h&&(h=new r(1,1,44100));var m=null!==i&&e(s,s)?new i({length:p,numberOfChannels:d,sampleRate:y}):h.createBuffer(d,p,y);if(0===m.numberOfChannels)throw n();return"function"!=typeof m.copyFromChannel?(u(m),it(m)):e(et,(function(){return et(m)}))||c(m),t.add(m),m}return a(f,null,[{key:l,value:function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===f.prototype||t.has(e)}}]),f}()}(Jn,Rn,hn,$n,Nn,function(t){return function(){if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch(t){return!1}return!0}}($n),ti,ei),ii=function(t){return function(e,n){var i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);var r=function(){n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)}}(Kt),ri=function(e,n,i){return r(t(T).mark((function o(s,a,u){var c;return t(T).wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=n(s),o.next=3,Promise.all(Array.from(c.activeInputs).map(r(t(T).mark((function n(r){var o,s,c,l,h;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=g(r),s=o[0],c=o[1],l=e(s),t.next=4,l.render(s,a);case 4:h=t.sent,i(s)||h.connect(u,c);case 6:case"end":return t.stop()}}),n)})))));case 3:case"end":return o.stop()}}),o)})))}(In,ct,St),oi=function(t){return function(e,n,i){return t(n,e,i)}}(ri),si=(Oe=ii,Ce=Rn,Ee=function(t){var e=t.createBufferSource();e.start();try{e.start()}catch(t){return!0}return!1},Me=function(t){var e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch(t){return!1}return!0},qe=function(t){var e=t.createBufferSource();e.start();try{e.stop()}catch(t){return!1}return!0},Re=xn,Ve=bn,Fe=wn,je=gn,Ie=function(t,e){var n=e.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=n),je(t,"buffer",(function(e){return function(){var i=e.call(t);return i===n?null:i}}),(function(e){return function(i){return e.call(t,null===i?n:i)}}))},Pe=An,function(t,e){var n=t.createBufferSource();return Ut(n,e),Zt(n,e,"playbackRate"),Gt(n,e,"buffer"),Gt(n,e,"loop"),Gt(n,e,"loopEnd"),Gt(n,e,"loopStart"),Ce(Ee,(function(){return Ee(t)}))||function(t){t.start=function(e){var n=!1;return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0;if(n)throw Nt();e.call(t,i,r,o),n=!0}}(t.start)}(n),Ce(Me,(function(){return Me(t)}))||function(t){var e;t.start=(e=t.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=t.buffer,s=null===o?i:Math.min(o.duration,i);null!==o&&s>o.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,s,r)})}(n),Ce(qe,(function(){return qe(t)}))||Ie(n,t),Ce(Re,(function(){return Re(t)}))||Xt(n),Ce(Ve,(function(){return Ve(t)}))||Pe(n,t),Ce(Fe,(function(){return Fe(t)}))||Qt(n),Oe(t,n),n}),ai=function(t,e){return function(n,i,r){return t(i).replay(r),e(i,n,r)}}(function(t){return function(e){var n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}}(ct),ri),ui=(function(t,e,n,i,r){}(oi,si,wt,ai,Pn),Le=R,ye=function(t,e){Le.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})},me=Wn,_e=V,ge=C.createCancelAndHoldAutomationEvent,ke=C.createCancelScheduledValuesAutomationEvent,xe=C.createExponentialRampToValueAutomationEvent,be=C.createLinearRampToValueAutomationEvent,we=C.createSetTargetAutomationEvent,Te=C.createSetValueAutomationEvent,Se=C.createSetValueCurveAutomationEvent,Ae=Gn,De=kn,function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=new C.AutomationEventList(n.defaultValue),s=e?function(t){return u({},"replay",(function(e){var n=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;if("exponentialRampToValue"===a.type){var u=a.endTime,c=a.value;e.exponentialRampToValueAtTime(c,u)}else if("linearRampToValue"===a.type){var l=a.endTime,h=a.value;e.linearRampToValueAtTime(h,l)}else if("setTarget"===a.type){var f=a.startTime,p=a.target,d=a.timeConstant;e.setTargetAtTime(p,f,d)}else if("setValue"===a.type){var v=a.startTime,y=a.value;e.setValueAtTime(y,v)}else{if("setValueCurve"!==a.type)throw new Error("Can't apply an unknown automation.");var m=a.duration,_=a.startTime,g=a.values;e.setValueCurveAtTime(g,_,m)}}}catch(t){i=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}}))}(o):null,a={get defaultValue(){return n.defaultValue},get maxValue(){return null===i?n.maxValue:i},get minValue(){return null===r?n.minValue:r},get value(){return n.value},set value(e){n.value=e,a.setValueAtTime(e,t.context.currentTime)},cancelAndHoldAtTime:function(e){if("function"==typeof n.cancelAndHoldAtTime)null===s&&o.flush(t.context.currentTime),o.add(ge(e)),n.cancelAndHoldAtTime(e);else{var i=Array.from(o).pop();null===s&&o.flush(t.context.currentTime),o.add(ge(e));var r=Array.from(o).pop();n.cancelScheduledValues(e),i!==r&&void 0!==r&&("exponentialRampToValue"===r.type?n.exponentialRampToValueAtTime(r.value,r.endTime):"linearRampToValue"===r.type?n.linearRampToValueAtTime(r.value,r.endTime):"setValue"===r.type?n.setValueAtTime(r.value,r.startTime):"setValueCurve"===r.type&&n.setValueCurveAtTime(r.values,r.startTime,r.duration))}return a},cancelScheduledValues:function(e){return null===s&&o.flush(t.context.currentTime),o.add(ke(e)),n.cancelScheduledValues(e),a},exponentialRampToValueAtTime:function(e,i){if(0===e)throw new RangeError;if(!Number.isFinite(i)||i<0)throw new RangeError;return null===s&&o.flush(t.context.currentTime),o.add(xe(e,i)),n.exponentialRampToValueAtTime(e,i),a},linearRampToValueAtTime:function(e,i){return null===s&&o.flush(t.context.currentTime),o.add(be(e,i)),n.linearRampToValueAtTime(e,i),a},setTargetAtTime:function(e,i,r){return null===s&&o.flush(t.context.currentTime),o.add(we(e,i,r)),n.setTargetAtTime(e,i,r),a},setValueAtTime:function(e,i){return null===s&&o.flush(t.context.currentTime),o.add(Te(e,i)),n.setValueAtTime(e,i),a},setValueCurveAtTime:function(e,i,r){var u=e instanceof Float32Array?e:new Float32Array(e);if(null!==Ae&&"webkitAudioContext"===Ae.name){for(var c=i+r,l=t.context.sampleRate,h=Math.ceil(i*l),f=Math.floor(c*l),p=f-h,d=new Float32Array(p),v=0;v<p;v+=1){var y=(u.length-1)/r*((h+v)/l-i),m=Math.floor(y),_=Math.ceil(y);d[v]=m===_?u[m]:(1-(y-m))*u[m]+(1-(_-y))*u[_]}null===s&&o.flush(t.context.currentTime),o.add(Se(d,i,r)),n.setValueCurveAtTime(d,i,r);var g=f/l;g<c&&De(a,d[d.length-1],g),De(a,u[u.length-1],c)}else null===s&&o.flush(t.context.currentTime),o.add(Se(u,i,r)),n.setValueCurveAtTime(u,i,r);return a}};return _e.set(a,n),me.set(a,t),ye(a,s),a}),ci=(Ke=_t,tn=Nt,en=as,nn=Kt,rn=ln,on=js,sn=hn,an=bt,un=mn,cn=os,function(t,e){r=Ns,o=Nt,s=Kt,a=_n,u=os;var n,i,r,o,s,a,u,c=(Ns,os,e.coneInnerAngle),l=e.coneOuterAngle,h=e.coneOuterGain,f=e.distanceModel,p=e.maxDistance,d=e.orientationX,m=e.orientationY,_=e.orientationZ,g=e.panningModel,x=e.positionX,b=e.positionY,w=e.positionZ,T=e.refDistance,S=e.rolloffFactor,A=y(e,["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"]),D=t.createPanner();if(A.channelCount>2)throw sn();if("max"===A.channelCountMode)throw sn();Ut(D,A);var O={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},C=en(t,v({},O,{channelInterpretation:"speakers",numberOfInputs:6})),E=nn(t,v({},A,{gain:1})),M=nn(t,v({},O,{gain:1})),q=nn(t,v({},O,{gain:0})),R=nn(t,v({},O,{gain:0})),V=nn(t,v({},O,{gain:0})),F=nn(t,v({},O,{gain:0})),I=nn(t,v({},O,{gain:0})),P=rn(t,256,6,1),j=on(t,v({},O,{curve:new Float32Array([1,1]),oversample:"none"})),L=[d,m,_],N=[x,b,w],z=new Float32Array(1);P.onaudioprocess=function(t){var e,n,i=t.inputBuffer,r=[un(i,z,0),un(i,z,1),un(i,z,2)];r.some((function(t,e){return t!==L[e]}))&&((e=D).setOrientation.apply(e,k(r)),L=r);var o=[un(i,z,3),un(i,z,4),un(i,z,5)];o.some((function(t,e){return t!==N[e]}))&&((n=D).setPosition.apply(n,k(o)),N=o)},Object.defineProperty(q.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(R.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(V.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(F.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(I.gain,"defaultValue",{get:function(){return 0}});var W={get bufferSize(){},get channelCount(){return D.channelCount},set channelCount(t){if(t>2)throw sn();E.channelCount=t,D.channelCount=t},get channelCountMode(){return D.channelCountMode},set channelCountMode(t){if("max"===t)throw sn();E.channelCountMode=t,D.channelCountMode=t},get channelInterpretation(){return D.channelInterpretation},set channelInterpretation(t){E.channelInterpretation=t,D.channelInterpretation=t},get coneInnerAngle(){return D.coneInnerAngle},set coneInnerAngle(t){D.coneInnerAngle=t},get coneOuterAngle(){return D.coneOuterAngle},set coneOuterAngle(t){D.coneOuterAngle=t},get coneOuterGain(){return D.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw tn();D.coneOuterGain=t},get context(){return D.context},get distanceModel(){return D.distanceModel},set distanceModel(t){D.distanceModel=t},get inputs(){return[E]},get maxDistance(){return D.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;D.maxDistance=t},get numberOfInputs(){return D.numberOfInputs},get numberOfOutputs(){return D.numberOfOutputs},get orientationX(){return M.gain},get orientationY(){return q.gain},get orientationZ(){return R.gain},get panningModel(){return D.panningModel},set panningModel(t){D.panningModel=t},get positionX(){return V.gain},get positionY(){return F.gain},get positionZ(){return I.gain},get refDistance(){return D.refDistance},set refDistance(t){if(t<0)throw new RangeError;D.refDistance=t},get rolloffFactor(){return D.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;D.rolloffFactor=t},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return E.addEventListener(e[0],e[1],e[2])},dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return E.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return E.removeEventListener(e[0],e[1],e[2])}};return c!==W.coneInnerAngle&&(W.coneInnerAngle=c),l!==W.coneOuterAngle&&(W.coneOuterAngle=l),h!==W.coneOuterGain&&(W.coneOuterGain=h),f!==W.distanceModel&&(W.distanceModel=f),p!==W.maxDistance&&(W.maxDistance=p),d!==W.orientationX.value&&(W.orientationX.value=d),m!==W.orientationY.value&&(W.orientationY.value=m),_!==W.orientationZ.value&&(W.orientationZ.value=_),g!==W.panningModel&&(W.panningModel=g),x!==W.positionX.value&&(W.positionX.value=x),b!==W.positionY.value&&(W.positionY.value=b),w!==W.positionZ.value&&(W.positionZ.value=w),T!==W.refDistance&&(W.refDistance=T),S!==W.rolloffFactor&&(W.rolloffFactor=S),1===L[0]&&0===L[1]&&0===L[2]||(n=D).setOrientation.apply(n,k(L)),0===N[0]&&0===N[1]&&0===N[2]||(i=D).setPosition.apply(i,k(N)),cn($t(W,D),(function(){E.connect(D),Ke(E,j,0,0),j.connect(M).connect(C,0,0),j.connect(q).connect(C,0,1),j.connect(R).connect(C,0,2),j.connect(V).connect(C,0,3),j.connect(F).connect(C,0,4),j.connect(I).connect(C,0,5),C.connect(P).connect(t.destination)}),(function(){E.disconnect(D),an(E,j,0,0),j.disconnect(M),M.disconnect(C),j.disconnect(q),q.disconnect(C),j.disconnect(R),R.disconnect(C),j.disconnect(V),V.disconnect(C),j.disconnect(F),F.disconnect(C),j.disconnect(I),I.disconnect(C),C.disconnect(P),P.disconnect(t.destination)}))}),li=function(t){return function(e,n){var i=e.createPanner();return void 0===i.orientationX?t(e,n):(Ut(i,n),Zt(i,n,"orientationX"),Zt(i,n,"orientationY"),Zt(i,n,"orientationZ"),Zt(i,n,"positionX"),Zt(i,n,"positionY"),Zt(i,n,"positionZ"),Gt(i,n,"coneInnerAngle"),Gt(i,n,"coneOuterAngle"),Gt(i,n,"coneOuterGain"),Gt(i,n,"distanceModel"),Gt(i,n,"maxDistance"),Gt(i,n,"panningModel"),Gt(i,n,"refDistance"),Gt(i,n,"rolloffFactor"),i)}}(ci),hi=function(e,n,i,o,s,a,u,c,l,h){return function(){var f=new WeakMap,p=null;return{render:function(d,y){var m=f.get(y);return void 0!==m?Promise.resolve(m):r(t(T).mark((function d(y,m){var _,g,k,x,b,w,S,A,D,O,C,E,M,q,R,V,F,I,P,j;return t(T).wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(_=null,g=a(y),k={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},x=v({},k,{coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor}),b=tt(g,m),"bufferSize"in g?_=o(m,v({},k,{gain:1})):b||(w=v({},x,{orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value}),g=s(m,w)),f.set(m,null===_?g:_),null===_){d.next=21;break}if(null!==p){d.next=9;break}if(null!==u){d.next=7;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 7:S=new u(6,y.context.length,m.sampleRate),(A=n(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6})).connect(S.destination),p=r(t(T).mark((function e(){var n,o;return t(T).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([y.orientationX,y.orientationY,y.orientationZ,y.positionX,y.positionY,y.positionZ].map(r(t(T).mark((function e(n,r){var o;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=i(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0}),t.next=3,c(S,n,o.offset);case 3:return t.abrupt("return",(t.sent,o));case 4:case"end":return t.stop()}}),e)})))));case 2:for(n=e.sent,o=0;o<6;o+=1)n[o].connect(A,0,o),n[o].start(0);return e.abrupt("return",h(S));case 5:case"end":return e.stop()}}),e)})))();case 9:return d.next=11,p;case 11:return D=d.sent,O=o(m,v({},k,{gain:1})),d.next=15,l(y,m,O);case 15:for(C=[],E=0;E<D.numberOfChannels;E+=1)C.push(D.getChannelData(E));for(M=[C[0][0],C[1][0],C[2][0]],q=[C[3][0],C[4][0],C[5][0]],R=o(m,v({},k,{gain:1})),V=s(m,v({},x,{orientationX:M[0],orientationY:M[1],orientationZ:M[2],positionX:q[0],positionY:q[1],positionZ:q[2]})),O.connect(R).connect(V.inputs[0]),V.connect(_),F=128;F<D.length;F+=128)I=[C[0][F],C[1][F],C[2][F]],P=[C[3][F],C[4][F],C[5][F]],(I.some((function(t,e){return t!==M[e]}))||P.some((function(t,e){return t!==q[e]})))&&(M=I,q=P,j=F/m.sampleRate,R.gain.setValueAtTime(0,j),R=o(m,v({},k,{gain:0})),V=s(m,v({},x,{orientationX:M[0],orientationY:M[1],orientationZ:M[2],positionX:q[0],positionY:q[1],positionZ:q[2]})),R.gain.setValueAtTime(1,j),O.connect(R).connect(V.inputs[0]),V.connect(_));return d.abrupt("return",_);case 21:if(!b){d.next=36;break}return d.next=24,e(m,y.orientationX,g.orientationX);case 24:return d.next=26,e(m,y.orientationY,g.orientationY);case 26:return d.next=28,e(m,y.orientationZ,g.orientationZ);case 28:return d.next=30,e(m,y.positionX,g.positionX);case 30:return d.next=32,e(m,y.positionY,g.positionY);case 32:return d.next=34,e(m,y.positionZ,g.positionZ);case 34:d.next=48;break;case 36:return d.next=38,c(m,y.orientationX,g.orientationX);case 38:return d.next=40,c(m,y.orientationY,g.orientationY);case 40:return d.next=42,c(m,y.orientationZ,g.orientationZ);case 42:return d.next=44,c(m,y.positionX,g.positionX);case 44:return d.next=46,c(m,y.positionY,g.positionY);case 46:return d.next=48,c(m,y.positionZ,g.positionZ);case 48:if(!mt(g)){d.next=53;break}return d.next=51,l(y,m,g.inputs[0]);case 51:d.next=55;break;case 53:return d.next=55,l(y,m,g);case 55:return d.abrupt("return",g);case 56:case"end":return d.stop()}}),d)})))(d,y)}}}}(oi,as,ds,Kt,li,wt,Nn,ai,Pn,Cs),fi=function(t,e,i,r,s,u,c){var l=function(t){"use strict";d(h,t);var l=x(h);function h(t,a){var f;o(this,h);var p=s(t),d=v({},pn,a),y=i(p,d),_=u(p);return(f=l.call(this,t,!1,y,_?r():null))._nativePannerNode=y,f._orientationX=e(n(f),_,y.orientationX,st,ot),f._orientationY=e(n(f),_,y.orientationY,st,ot),f._orientationZ=e(n(f),_,y.orientationZ,st,ot),f._positionX=e(n(f),_,y.positionX,st,ot),f._positionY=e(n(f),_,y.positionY,st,ot),f._positionZ=e(n(f),_,y.positionZ,st,ot),c(n(f),1),m(f)}return a(h,[{key:"coneInnerAngle",get:function(){return this._nativePannerNode.coneInnerAngle},set:function(t){this._nativePannerNode.coneInnerAngle=t}},{key:"coneOuterAngle",get:function(){return this._nativePannerNode.coneOuterAngle},set:function(t){this._nativePannerNode.coneOuterAngle=t}},{key:"coneOuterGain",get:function(){return this._nativePannerNode.coneOuterGain},set:function(t){this._nativePannerNode.coneOuterGain=t}},{key:"distanceModel",get:function(){return this._nativePannerNode.distanceModel},set:function(t){this._nativePannerNode.distanceModel=t}},{key:"maxDistance",get:function(){return this._nativePannerNode.maxDistance},set:function(t){this._nativePannerNode.maxDistance=t}},{key:"orientationX",get:function(){return this._orientationX}},{key:"orientationY",get:function(){return this._orientationY}},{key:"orientationZ",get:function(){return this._orientationZ}},{key:"panningModel",get:function(){return this._nativePannerNode.panningModel},set:function(t){this._nativePannerNode.panningModel=t}},{key:"positionX",get:function(){return this._positionX}},{key:"positionY",get:function(){return this._positionY}},{key:"positionZ",get:function(){return this._positionZ}},{key:"refDistance",get:function(){return this._nativePannerNode.refDistance},set:function(t){this._nativePannerNode.refDistance=t}},{key:"rolloffFactor",get:function(){return this._nativePannerNode.rolloffFactor},set:function(t){this._nativePannerNode.rolloffFactor=t}}]),h}(t);return l}(Qn,ui,li,hi,Ln,zn,ns),pi=function(t){return function(e,n){var i=n.disableNormalization,r=n.imag,o=n.real,s=r instanceof Float32Array?r:new Float32Array(r),a=o instanceof Float32Array?o:new Float32Array(o),u=e.createPeriodicWave(a,s,{disableNormalization:i});if(Array.from(r).length<2)throw t();return u}}(nt),di=(Xe=pi,Qe=Ln,He=new WeakSet,Je=Symbol.hasInstance,$e=function(){"use strict";function t(e,n){o(this,t);var i=Qe(e),r=function(t){var e=t.imag,n=t.real;return v({},t,void 0===e?void 0===n?{imag:[0,0],real:[0,0]}:{imag:Array.from(n,(function(){return 0})),real:n}:void 0===n?{imag:e,real:Array.from(e,(function(){return 0}))}:{imag:e,real:n})}(v({},dn,n)),s=Xe(i,r);return He.add(s),s}return a(t,null,[{key:Je,value:function(e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===t.prototype||He.has(e)}}]),t}(),$e),vi=function(t,e,n,i,r,o){var s=16385,a=new Float32Array([1,1]),u=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l=v({},c,{oversample:"none"}),h=function(t,o,h,f,p){if(1===o)return function(t,e,r,o){for(var h=new Float32Array(s),f=new Float32Array(s),p=0;p<s;p+=1){var d=p/16384*u;h[p]=Math.cos(d),f[p]=Math.sin(d)}var y=n(t,v({},c,{gain:0})),m=i(t,v({},l,{curve:h})),_=i(t,v({},l,{curve:a})),g=n(t,v({},c,{gain:0})),k=i(t,v({},l,{curve:f}));return{connectGraph:function(){e.connect(y),e.connect(void 0===_.inputs?_:_.inputs[0]),e.connect(g),_.connect(r),r.connect(void 0===m.inputs?m:m.inputs[0]),r.connect(void 0===k.inputs?k:k.inputs[0]),m.connect(y.gain),k.connect(g.gain),y.connect(o,0,0),g.connect(o,0,1)},disconnectGraph:function(){e.disconnect(y),e.disconnect(void 0===_.inputs?_:_.inputs[0]),e.disconnect(g),_.disconnect(r),r.disconnect(void 0===m.inputs?m:m.inputs[0]),r.disconnect(void 0===k.inputs?k:k.inputs[0]),m.disconnect(y.gain),k.disconnect(g.gain),y.disconnect(o,0,0),g.disconnect(o,0,1)}}}(t,h,f,p);if(2===o)return function(t,r,o,h){for(var f=new Float32Array(s),p=new Float32Array(s),d=new Float32Array(s),y=new Float32Array(s),m=Math.floor(8192.5),_=0;_<s;_+=1)if(_>m){var g=(_-m)/(16384-m)*u;f[_]=Math.cos(g),p[_]=Math.sin(g),d[_]=0,y[_]=1}else{var k=_/(16384-m)*u;f[_]=1,p[_]=0,d[_]=Math.cos(k),y[_]=Math.sin(k)}var x=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),b=n(t,v({},c,{gain:0})),w=i(t,v({},l,{curve:f})),T=n(t,v({},c,{gain:0})),S=i(t,v({},l,{curve:p})),A=i(t,v({},l,{curve:a})),D=n(t,v({},c,{gain:0})),O=i(t,v({},l,{curve:d})),C=n(t,v({},c,{gain:0})),E=i(t,v({},l,{curve:y}));return{connectGraph:function(){r.connect(x),r.connect(void 0===A.inputs?A:A.inputs[0]),x.connect(b,0),x.connect(T,0),x.connect(D,1),x.connect(C,1),A.connect(o),o.connect(void 0===w.inputs?w:w.inputs[0]),o.connect(void 0===S.inputs?S:S.inputs[0]),o.connect(void 0===O.inputs?O:O.inputs[0]),o.connect(void 0===E.inputs?E:E.inputs[0]),w.connect(b.gain),S.connect(T.gain),O.connect(D.gain),E.connect(C.gain),b.connect(h,0,0),D.connect(h,0,0),T.connect(h,0,1),C.connect(h,0,1)},disconnectGraph:function(){r.disconnect(x),r.disconnect(void 0===A.inputs?A:A.inputs[0]),x.disconnect(b,0),x.disconnect(T,0),x.disconnect(D,1),x.disconnect(C,1),A.disconnect(o),o.disconnect(void 0===w.inputs?w:w.inputs[0]),o.disconnect(void 0===S.inputs?S:S.inputs[0]),o.disconnect(void 0===O.inputs?O:O.inputs[0]),o.disconnect(void 0===E.inputs?E:E.inputs[0]),w.disconnect(b.gain),S.disconnect(T.gain),O.disconnect(D.gain),E.disconnect(C.gain),b.disconnect(h,0,0),D.disconnect(h,0,0),T.disconnect(h,0,1),C.disconnect(h,0,1)}}}(t,h,f,p);throw r()};return function(e,i){var s=i.channelCount,a=i.channelCountMode,u=i.pan,c=y(i,["channelCount","channelCountMode","pan"]);if("max"===a)throw r();var l=t(e,v({},c,{channelCount:1,channelCountMode:a,numberOfInputs:2})),f=n(e,v({},c,{channelCount:s,channelCountMode:a,gain:1})),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:u}),d=h(e,s,f,p,l),m=d.connectGraph,_=d.disconnectGraph;Object.defineProperty(p.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(p.gain,"maxValue",{get:function(){return 1}}),Object.defineProperty(p.gain,"minValue",{get:function(){return-1}});var g={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(t){var n;f.channelCount!==t&&(k&&_(),n=h(e,t,f,p,l),m=n.connectGraph,_=n.disconnectGraph,k&&m()),f.channelCount=t},get channelCountMode(){return f.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw r();f.channelCountMode=t},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(t){f.channelInterpretation=t},get context(){return f.context},get inputs(){return[f]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get pan(){return p.gain},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return f.addEventListener(e[0],e[1],e[2])},dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return f.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return f.removeEventListener(e[0],e[1],e[2])}},k=!1;return o($t(g,l),(function(){m(),k=!0}),(function(){_(),k=!1}))}}(as,Jt,Kt,js,hn,os),yi=(Ye=vi,Ze=hn,function(t,e){var n=e.channelCountMode;if("clamped-max"===n)throw Ze();if(void 0===t.createStereoPanner)return Ye(t,e);var i=t.createStereoPanner();return Ut(i,e),Zt(i,e,"pan"),Object.defineProperty(i,"channelCountMode",{get:function(){return n},set:function(t){if(t!==n)throw Ze()}}),i}),mi=function(e,n,i,o,s){return function(){var a=new WeakMap;return{render:function(u,c){var l=a.get(c);return void 0!==l?Promise.resolve(l):r(t(T).mark((function r(u,c){var l,h,f;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=i(u),(h=tt(l,c))||(f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value},l=n(c,f)),a.set(c,l),!h){t.next=9;break}return t.next=7,e(c,u.pan,l.pan);case 7:t.next=11;break;case 9:return t.next=11,o(c,u.pan,l.pan);case 11:if(!mt(l)){t.next=16;break}return t.next=14,s(u,c,l.inputs[0]);case 14:t.next=18;break;case 16:return t.next=18,s(u,c,l);case 18:return t.abrupt("return",l);case 19:case"end":return t.stop()}}),r)})))(u,c)}}}}(oi,yi,wt,ai,Pn),_i=function(t,e,i,r,s,u){var c=function(t){"use strict";d(l,t);var c=x(l);function l(t,a){var h;o(this,l);var f=s(t),p=v({},vn,a),d=i(f,p),y=u(f);return(h=c.call(this,t,!1,d,y?r():null))._pan=e(n(h),y,d.pan),m(h)}return a(l,[{key:"pan",get:function(){return this._pan}}]),l}(t);return c}(Qn,ui,yi,mi,Ln,zn),gi=function(e,n,i){return function(){var o=new WeakMap;return{render:function(s,a){var u=o.get(a);return void 0!==u?Promise.resolve(u):r(t(T).mark((function r(s,a){var u,c;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=n(s),tt(u,a)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,curve:u.curve,oversample:u.oversample},u=e(a,c)),o.set(a,u),!mt(u)){t.next=8;break}return t.next=6,i(s,a,u.inputs[0]);case 6:t.next=10;break;case 8:return t.next=10,i(s,a,u);case 10:return t.abrupt("return",u);case 11:case"end":return t.stop()}}),r)})))(s,a)}}}}(js,wt,Pn),ki=function(t,e,i,r,s,u,c){var l=function(t){"use strict";d(h,t);var l=x(h);function h(t,e){var a;o(this,h);var f=s(t),p=v({},yn,e),d=i(f,p);return(a=l.call(this,t,!0,d,u(f)?r():null))._isCurveNullified=!1,a._nativeWaveShaperNode=d,c(n(a),1),m(a)}return a(h,[{key:"curve",get:function(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve},set:function(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}},{key:"oversample",get:function(){return this._nativeWaveShaperNode.oversample},set:function(t){this._nativeWaveShaperNode.oversample=t}}]),h}(t);return l}(Qn,Nt,js,gi,Ln,zn,ns),xi=function(t){return null!==t&&t.isSecureContext}(Vn),bi=function(t){return function(e,n,i){Object.defineProperties(t,{currentFrame:{configurable:!0,get:function(){return Math.round(e*n)}},currentTime:{configurable:!0,get:function(){return e}}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}}}(Vn),wi=new WeakMap,Ti=function(t,e){return function(n){var i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i}}(wi,Nn),Si=xi?function(t,e,n,i,r,s,a,u,c,l,h,f,p){var d=0;return function(v,y){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"},_=h.get(v);if(void 0!==_&&_.has(y))return Promise.resolve();var k=l.get(v);if(void 0!==k){var x=k.get(y);if(void 0!==x)return x}var b=s(v),w=void 0===b.audioWorklet?r(y).then((function(t){var e=g(t),i=e[0],r=e[1],o=g(W(i,r)),s=o[0],a=o[1];return n("".concat(s,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(a,"\n})})(window,'_AWGS')"))})).then((function(){var t=p._AWGS.pop();if(void 0===t)throw new SyntaxError;i(b.currentTime,b.sampleRate,(function(){return t((function t(){"use strict";o(this,t)}),void 0,(function(t,n){if(""===t.trim())throw e();var i=j.get(b);if(void 0!==i){if(i.has(t))throw e();G(n),B(n.parameterDescriptors),i.set(t,n)}else G(n),B(n.parameterDescriptors),j.set(b,new Map([[t,n]]))}),b.sampleRate,void 0,void 0)}))})):Promise.all([r(y),Promise.resolve(t(f,f))]).then((function(t){var e=g(t),n=g(e[0]),i=n[0],r=n[1],o=e[1],s=d+1;d=s;var l=g(W(i,r)),h=l[0],f=l[1],p=new Blob(["".concat(h,";((AudioWorkletProcessor,registerProcessor)=>{").concat(f,"\n})(").concat(o?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}",",(n,p)=>registerProcessor(n,class extends p{").concat(o?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));","process(i,o,p){").concat(o?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));","return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac").concat(s,"',class extends AudioWorkletProcessor{process(){return !1}})")],{type:"application/javascript; charset=utf-8"}),v=URL.createObjectURL(p);return b.audioWorklet.addModule(v,m).then((function(){if(u(b))return b;var t=a(b);return t.audioWorklet.addModule(v,m).then((function(){return t}))})).then((function(t){if(null===c)throw new SyntaxError;try{new c(t,"__sac".concat(s))}catch(t){throw new SyntaxError}})).finally((function(){return URL.revokeObjectURL(v)}))}));return void 0===k?l.set(v,new Map([[y,w]])):k.set(y,w),w.then((function(){var t=h.get(v);void 0===t?h.set(v,new Set([y])):t.add(y)})).finally((function(){var t=l.get(v);void 0!==t&&t.delete(y)})),w}}(Rn,hn,function(t){return function(e){return new Promise((function(n,i){if(null!==t){var r=t.document.head;if(null===r)i(new SyntaxError);else{var o=t.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(s),u=t.onerror,c=function(){t.onerror=u,URL.revokeObjectURL(a)};t.onerror=function(e,n,r,o,s){return n===a||n===t.location.href&&1===r&&1===o?(c(),i(s),!1):null!==u?u(e,n,r,o,s):void 0},o.onerror=function(){c(),i(new SyntaxError)},o.onload=function(){c(),n()},o.src=a,o.type="module",r.appendChild(o)}}else i(new SyntaxError)}))}}(Vn),bi,r(t(T).mark((function e(n){var i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(n);case 3:if(!(i=t.sent).ok){t.next=10;break}return t.next=7,i.text();case 7:return t.t0=t.sent,t.t1=i.url,t.abrupt("return",[t.t0,t.t1]);case 10:t.next=14;break;case 12:t.prev=12,t.t2=t.catch(0);case 14:throw new DOMException("","AbortError");case 15:case"end":return t.stop()}}),e,null,[[0,12]])}))),Ln,Ti,zn,Xn,new WeakMap,new WeakMap,function(e,n){return r(t(T).mark((function i(){var r,o,s,a,u,c,l;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e){t.next=2;break}return t.abrupt("return",!0);case 2:if(null!==n){t.next=4;break}return t.abrupt("return",!1);case 4:return r=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),o=new n(1,128,44100),s=URL.createObjectURL(r),a=!1,u=!1,t.prev=6,t.next=9,o.audioWorklet.addModule(s);case 9:return c=new e(o,"a",{numberOfOutputs:0}),l=o.createOscillator(),c.port.onmessage=function(){return a=!0},c.onprocessorerror=function(){return u=!0},l.connect(c),l.start(0),t.next=16,o.startRendering();case 16:t.next=20;break;case 18:t.prev=18,t.t0=t.catch(6);case 20:return t.prev=20,URL.revokeObjectURL(s),t.finish(20);case 23:return t.abrupt("return",a&&!u);case 24:case"end":return t.stop()}}),i,null,[[6,18,20,23]])})))}(Xn,Nn),Vn):void 0,Ai=function(t,e){return function(n){return t(n)||e(n)}}(Un,zn),Di=function(e,n,i,o,s,a,u,c,l,h,f){return function(i,o){var p=u(i)?i:a(i);if(s.has(o)){var d=new DOMException("","DataCloneError");return Promise.reject(d)}try{s.add(o)}catch(t){}return n(l,(function(){return l(p)}))?p.decodeAudioData(o).then((function(t){return jt(o).catch((function(){})),n(c,(function(){return c(t)}))||f(t),e.add(t),t})):new Promise((function(n,i){var s=r(t(T).mark((function e(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,jt(o);case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),e,null,[[0,5]])}))),a=function(t){i(t),s()};try{p.decodeAudioData(o,(function(t){"function"!=typeof t.copyFromChannel&&(h(t),it(t)),e.add(t),s().then((function(){return n(t)}))}),(function(t){a(null===t?new DOMException("","EncodingError"):t)}))}catch(t){a(t)}}))}}(Jn,Rn,0,0,new WeakSet,Ln,Ai,et,Bt,ti,ei),Oi=function(t,e,i,r,s,u,c,l,h,f,p,y,_,g,k,b,w,T,S,A){var D=function(k){"use strict";d(O,k);var D=x(O);function O(e,i){var r;return o(this,O),(r=D.call(this,e,i))._nativeContext=e,r._audioWorklet=void 0===t?void 0:{addModule:function(e,i){return t(n(r),e,i)}},m(r)}return a(O,[{key:"audioWorklet",get:function(){return this._audioWorklet}},{key:"createAnalyser",value:function(){return new e(this)}},{key:"createBiquadFilter",value:function(){return new s(this)}},{key:"createBuffer",value:function(t,e,n){return new i({length:e,numberOfChannels:t,sampleRate:n})}},{key:"createBufferSource",value:function(){return new r(this)}},{key:"createChannelMerger",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new u(this,{numberOfInputs:t})}},{key:"createChannelSplitter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new c(this,{numberOfOutputs:t})}},{key:"createConstantSource",value:function(){return new l(this)}},{key:"createConvolver",value:function(){return new h(this)}},{key:"createDelay",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new p(this,{maxDelayTime:t})}},{key:"createDynamicsCompressor",value:function(){return new y(this)}},{key:"createGain",value:function(){return new _(this)}},{key:"createIIRFilter",value:function(t,e){return new g(this,{feedback:e,feedforward:t})}},{key:"createOscillator",value:function(){return new b(this)}},{key:"createPanner",value:function(){return new w(this)}},{key:"createPeriodicWave",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1};return new T(this,v({},n,{imag:e,real:t}))}},{key:"createStereoPanner",value:function(){return new S(this)}},{key:"createWaveShaper",value:function(){return new A(this)}},{key:"decodeAudioData",value:function(t,e,n){return f(this._nativeContext,t).then((function(t){return"function"==typeof e&&e(t),t}),(function(t){throw"function"==typeof n&&n(t),t}))}}]),O}(k);return D}(Si,Hn,ni,ts,is,hs,us,_s,vs,Di,xs,Ts,ks,Ms,qs,Vs,fi,di,_i,ki),Ci=function(t,e,n,i){var r=function(t){"use strict";d(r,t);var e=x(r);function r(t,s){var a;o(this,r);var u=n(t),c=function(t,e){return t.createMediaElementSource(e.mediaElement)}(u,s);if(i(u))throw TypeError();return(a=e.call(this,t,!0,c,null))._nativeMediaElementAudioSourceNode=c,m(a)}return a(r,[{key:"mediaElement",get:function(){return this._nativeMediaElementAudioSourceNode.mediaElement}}]),r}(t);return r}(Qn,0,Ln,zn),Ei=function(t,e,n,i){var r=function(t){"use strict";d(r,t);var e=x(r);function r(t,s){var a;o(this,r);var u=n(t);if(i(u))throw new TypeError;var c=function(t,e){var n=t.createMediaStreamDestination();return Ut(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:function(){return 0}}),n}(u,v({},Wt,s));return(a=e.call(this,t,!1,c,null))._nativeMediaStreamAudioDestinationNode=c,m(a)}return a(r,[{key:"stream",get:function(){return this._nativeMediaStreamAudioDestinationNode.stream}}]),r}(t);return r}(Qn,0,Ln,zn),Mi=function(t,e,n,i){var r=function(t){"use strict";d(r,t);var e=x(r);function r(t,s){var a;o(this,r);var u=n(t),c=function(t,e){var n=e.mediaStream,i=n.getAudioTracks();i.sort((function(t,e){return t.id<e.id?-1:t.id>e.id?1:0}));var r=i.slice(0,1),o=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(o,"mediaStream",{value:n}),o}(u,s);if(i(u))throw new TypeError;return(a=e.call(this,t,!0,c,null))._nativeMediaStreamAudioSourceNode=c,m(a)}return a(r,[{key:"mediaStream",get:function(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}]),r}(t);return r}(Qn,0,Ln,zn),qi=function(t,e){return function(n,i){var r=i.mediaStreamTrack;if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);var o=new MediaStream([r]),s=n.createMediaStreamSource(o);if("audio"!==r.kind)throw t();if(e(n))throw new TypeError;return s}}(Nt,zn),Ri=function(t,e,n){var i=function(t){"use strict";d(r,t);var i=x(r);function r(t,s){o(this,r);var a=n(t);return i.call(this,t,!0,e(a,s),null)}return r}(t);return i}(Qn,qi,Ln),Vi=function(t,e,n,i,r,s,u,c,l){var h=function(t){"use strict";d(f,t);var h=x(f);function f(){var t,e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(o(this,f),null===l)throw new Error("Missing the native AudioContext constructor.");try{e=new l(r)}catch(t){if(12===t.code&&"sampleRate is not in range"===t.message)throw n();throw t}if(null===e)throw i();if(!function(t){return void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t)}(r.latencyHint))throw new TypeError("The provided value '".concat(r.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==r.sampleRate&&e.sampleRate!==r.sampleRate)throw n();t=h.call(this,e,2);var s=r.latencyHint,a=e.sampleRate;if(t._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===s?512/a:"interactive"===s||void 0===s?256/a:"playback"===s?1024/a:128*Math.max(2,Math.min(128,Math.round(s*a/128)))/a,t._nativeAudioContext=e,"webkitAudioContext"===l.name?(t._nativeGainNode=e.createGain(),t._nativeOscillatorNode=e.createOscillator(),t._nativeGainNode.gain.value=1e-37,t._nativeOscillatorNode.connect(t._nativeGainNode).connect(e.destination),t._nativeOscillatorNode.start()):(t._nativeGainNode=null,t._nativeOscillatorNode=null),t._state=null,"running"===e.state){t._state="suspended";var u=function(){"suspended"===t._state&&(t._state=null),e.removeEventListener("statechange",u)};e.addEventListener("statechange",u)}return t}return a(f,[{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}},{key:"close",value:function(){var t=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==t._nativeGainNode&&null!==t._nativeOscillatorNode&&(t._nativeOscillatorNode.stop(),t._nativeGainNode.disconnect(),t._nativeOscillatorNode.disconnect()),ht(t)})))}},{key:"createMediaElementSource",value:function(t){return new r(this,{mediaElement:t})}},{key:"createMediaStreamDestination",value:function(){return new s(this)}},{key:"createMediaStreamSource",value:function(t){return new u(this,{mediaStream:t})}},{key:"createMediaStreamTrackSource",value:function(t){return new c(this,{mediaStreamTrack:t})}},{key:"resume",value:function(){var t=this;return"suspended"===this._state?new Promise((function(e,n){var i=t,r=function(){i._nativeAudioContext.removeEventListener("statechange",r),"running"===i._nativeAudioContext.state?e():i.resume().then(e,n)};t._nativeAudioContext.addEventListener("statechange",r)})):this._nativeAudioContext.resume().catch((function(t){if(void 0===t||15===t.code)throw e();throw t}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(t){if(void 0===t)throw e();throw t}))}}]),f}(t);return h}(Oi,Nt,hn,(function(){return new DOMException("","UnknownError")}),Ci,Ei,Mi,Ri,Gn),Fi=function(t){return function(e){var n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n}}(Rs),Ii=function(t){return function(e,n){t(e).add(n)}}(Fi),Pi=function(t){return function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e[i];if(void 0===o)throw t();return Ct(n)?o.connect(n,0,r):o.connect(n,0)}}(nt),ji=function(t){return function(e,n){t(e).delete(n)}}(Fi),Li=(Ue=nt,function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===e?t.forEach((function(t){return t.disconnect()})):"number"==typeof e?Lt(Ue,t,e).disconnect():Ct(e)?void 0===n?t.forEach((function(t){return t.disconnect(e)})):void 0===i?Lt(Ue,t,n).disconnect(e,0):Lt(Ue,t,n).disconnect(e,0,i):void 0===n?t.forEach((function(t){return t.disconnect(e)})):Lt(Ue,t,n).disconnect(e,0)}),Ni=new WeakMap,zi=function(t,e){return function(n){return e(t,n)}}(Ni,U),Wi=function(e,n,i,o,s,a,c,l,h,f,p,d,y){return function(m,_,g,k){if(0===k.numberOfInputs&&0===k.numberOfOutputs)throw h();var x=Array.isArray(k.outputChannelCount)?k.outputChannelCount:Array.from(k.outputChannelCount);if(x.some((function(t){return t<1})))throw h();if(x.length!==k.numberOfOutputs)throw n();if("explicit"!==k.channelCountMode)throw h();var b=k.channelCount*k.numberOfInputs,w=x.reduce((function(t,e){return t+e}),0),S=void 0===g.parameterDescriptors?0:g.parameterDescriptors.length;if(b+S>6||w>6)throw h();for(var A=new MessageChannel,D=[],O=[],C=0;C<k.numberOfInputs;C+=1)D.push(c(m,{channelCount:k.channelCount,channelCountMode:k.channelCountMode,channelInterpretation:k.channelInterpretation,gain:1})),O.push(s(m,{channelCount:k.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:k.channelCount}));var E=[],M=!0,q=!1,R=void 0;if(void 0!==g.parameterDescriptors)try{for(var V,F=function(t,e){var n=e.value,i=n.defaultValue,r=n.maxValue,o=n.minValue,s=n.name,u=a(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==k.parameterData[s]?k.parameterData[s]:void 0===i?0:i});Object.defineProperties(u.offset,{defaultValue:{get:function(){return void 0===i?0:i}},maxValue:{get:function(){return void 0===r?st:r}},minValue:{get:function(){return void 0===o?ot:o}}}),E.push(u)},I=g.parameterDescriptors[Symbol.iterator]();!(M=(V=I.next()).done);M=!0)F(0,V)}catch(t){q=!0,R=t}finally{try{M||null==I.return||I.return()}finally{if(q)throw R}}for(var P=o(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+S)}),j=Ht(_,m.sampleRate),N=l(m,j,b+S,Math.max(1,w)),z=s(m,{channelCount:Math.max(1,w),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,w)}),W=[],B=0;B<k.numberOfOutputs;B+=1)W.push(o(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:x[B]}));for(var G=0;G<k.numberOfInputs;G+=1){D[G].connect(O[G]);for(var U=0;U<k.channelCount;U+=1)O[G].connect(P,U,G*k.channelCount+U)}var Y=new qt(void 0===g.parameterDescriptors?[]:g.parameterDescriptors.map((function(t,e){var n=t.name,i=E[e];return i.connect(P,0,b+e),i.start(0),[n,i.offset]})));P.connect(N);var Z,X,Q=k.channelInterpretation,H=null,J=0===k.numberOfOutputs?[N]:W,$={get bufferSize(){return j},get channelCount(){return k.channelCount},set channelCount(t){throw i()},get channelCountMode(){return k.channelCountMode},set channelCountMode(t){throw i()},get channelInterpretation(){return Q},set channelInterpretation(t){var e=!0,n=!1,i=void 0;try{for(var r,o=D[Symbol.iterator]();!(e=(r=o.next()).done);e=!0)r.value.channelInterpretation=t}catch(t){n=!0,i=t}finally{try{e||null==o.return||o.return()}finally{if(n)throw i}}Q=t},get context(){return N.context},get inputs(){return D},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get onprocessorerror(){return H},set onprocessorerror(t){"function"==typeof H&&$.removeEventListener("processorerror",H),"function"==typeof(H="function"==typeof t?t:null)&&$.addEventListener("processorerror",H)},get parameters(){return Y},get port(){return A.port2},addEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return N.addEventListener(e[0],e[1],e[2])},connect:e.bind(null,J),disconnect:f.bind(null,J),dispatchEvent:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return N.dispatchEvent(e[0])},removeEventListener:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return N.removeEventListener(e[0],e[1],e[2])}},K=new Map;A.port1.addEventListener=(Z=A.port1.addEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){var i="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==i){var r=K.get(e[1]);void 0!==r?e[1]=r:(e[1]=function(t){p(m.currentTime,m.sampleRate,(function(){return i(t)}))},K.set(i,e[1]))}}return Z.call(A.port1,e[0],e[1],e[2])}),A.port1.removeEventListener=(X=A.port1.removeEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("message"===e[0]){var i=K.get(e[1]);void 0!==i&&(K.delete(e[1]),e[1]=i)}return X.call(A.port1,e[0],e[1],e[2])});var tt=null;Object.defineProperty(A.port1,"onmessage",{get:function(){return tt},set:function(t){"function"==typeof tt&&A.port1.removeEventListener("message",tt),"function"==typeof(tt="function"==typeof t?t:null)&&(A.port1.addEventListener("message",tt),A.port1.start())}}),g.prototype.port=A.port1;var et=null,nt=function(e,n,i,o){var s=L.get(e);void 0===s&&(s=new WeakMap,L.set(e,s));var a=r(t(T).mark((function e(n,i){var r;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,function(t){return new Promise((function(e,n){var i=new MessageChannel,r=i.port1,o=i.port2;r.onmessage=function(t){var n=t.data;r.close(),o.close(),e(n)},r.onmessageerror=function(t){var e=t.data;r.close(),o.close(),n(e)},o.postMessage(t)}))}(i);case 2:return r=t.sent,t.abrupt("return",new n(r));case 4:case"end":return t.stop()}}),e)})))(i,o);return s.set(n,a),a}(m,$,g,k);nt.then((function(t){return et=t}));var it=It(k.numberOfInputs,k.channelCount),rt=It(k.numberOfOutputs,x),at=void 0===g.parameterDescriptors?[]:g.parameterDescriptors.reduce((function(t,e){return v({},t,u({},e.name,new Float32Array(128)))}),{}),ut=!0,ct=function(){k.numberOfOutputs>0&&N.disconnect(z);for(var t=0,e=0;t<k.numberOfOutputs;t+=1){for(var n=W[t],i=0;i<x[t];i+=1)z.disconnect(n,e+i,i);e+=x[t]}},lt=new Map;N.onaudioprocess=function(t){var e=t.inputBuffer,n=t.outputBuffer;if(null!==et)for(var i=d($),r=0;r<j;r+=128){for(var o=0;o<k.numberOfInputs;o+=1)for(var s=0;s<k.channelCount;s+=1)Vt(e,it[o],s,s,r);void 0!==g.parameterDescriptors&&g.parameterDescriptors.forEach((function(t,n){var i=t.name;Vt(e,at,i,b+n,r)}));for(var a=0;a<k.numberOfInputs;a+=1)for(var u=0;u<x[a];u+=1)0===rt[a][u].byteLength&&(rt[a][u]=new Float32Array(128));try{var c=it.map((function(t,e){if(i[e].size>0)return lt.set(e,j/128),t;var n=lt.get(e);return void 0===n?[]:(t.every((function(t){return t.every((function(t){return 0===t}))}))&&(1===n?lt.delete(e):lt.set(e,n-1)),t)})),l=p(m.currentTime+r/m.sampleRate,m.sampleRate,(function(){return et.process(c,rt,at)}));ut=l;for(var h=0,f=0;h<k.numberOfOutputs;h+=1){for(var v=0;v<x[h];v+=1)Ft(n,rt[h],v,f+v,r);f+=x[h]}}catch(t){ut=!1,$.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!ut){for(var y=0;y<k.numberOfInputs;y+=1){D[y].disconnect(O[y]);for(var _=0;_<k.channelCount;_+=1)O[r].disconnect(P,_,y*k.channelCount+_)}if(void 0!==g.parameterDescriptors)for(var w=g.parameterDescriptors.length,T=0;T<w;T+=1){var S=E[T];S.disconnect(P,0,b+T),S.stop()}P.disconnect(N),N.onaudioprocess=null,ht?ct():dt();break}}};var ht=!1,ft=c(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),pt=function(){return N.connect(ft).connect(m.destination)},dt=function(){N.disconnect(ft),ft.disconnect()};return pt(),y($,(function(){if(ut){dt(),k.numberOfOutputs>0&&N.connect(z);for(var t=0,e=0;t<k.numberOfOutputs;t+=1){for(var n=W[t],i=0;i<x[t];i+=1)z.connect(n,e+i,i);e+=x[t]}}ht=!0}),(function(){ut&&(pt(),ct()),ht=!1}))}}(Pi,nt,Nt,as,Jt,ds,Kt,ln,hn,Li,bi,zi,os),Bi=(Ne=Nt,ze=Wi,We=Kt,Be=hn,Ge=os,function(t,e,n,i,r,o){if(null!==n)try{var s=new n(t,i,o),a=new Map,u=null;if(Object.defineProperties(s,{channelCount:{get:function(){return o.channelCount},set:function(){throw Ne()}},channelCountMode:{get:function(){return"explicit"},set:function(){throw Ne()}},onprocessorerror:{get:function(){return u},set:function(t){"function"==typeof u&&s.removeEventListener("processorerror",u),"function"==typeof(u="function"==typeof t?t:null)&&s.addEventListener("processorerror",u)}}}),s.addEventListener=(h=s.addEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;if("processorerror"===e[0]){var r="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==r){var o=a.get(e[1]);void 0!==o?e[1]=o:(e[1]=function(t){"error"===t.type?(Object.defineProperties(t,{type:{value:"processorerror"}}),r(t)):r(new ErrorEvent(e[0],v({},t)))},a.set(r,e[1]))}}return h.call(s,"error",e[1],e[2]),(i=h).call.apply(i,[s].concat(k(e)))}),s.removeEventListener=(l=s.removeEventListener,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if("processorerror"===e[0]){var i=a.get(e[1]);void 0!==i&&(a.delete(e[1]),e[1]=i)}return l.call(s,"error",e[1],e[2]),l.call(s,e[0],e[1],e[2])}),0!==o.numberOfOutputs){var c=We(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return s.connect(c).connect(t.destination),Ge(s,(function(){return c.disconnect()}),(function(){return c.connect(t.destination)}))}return s}catch(t){if(11===t.code)throw Be();throw t}var l,h;if(void 0===r)throw Be();return function(t){var e=(new MessageChannel).port1;try{e.postMessage(t)}finally{e.close()}}(o),ze(t,e,r,o)}),Gi=function(e,n,i,o,s,a,u,c,l,h,f,p,d,v,y,m){return function(_,k,x){var b=new WeakMap,w=null;return{render:function(S,A){c(A,S);var D=b.get(A);return void 0!==D?Promise.resolve(D):r(t(T).mark((function c(S,A){var D,O,C,E,M,q,R,V,F,I,P,j,L,N,z,W,B,G,U,Y,Z,X,Q,H,J,$,K,et,nt,it,rt,ot,st,at,ut,ct,lt,ht,ft;return t(T).wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(D=f(S),O=null,C=tt(D,A),E=Array.isArray(k.outputChannelCount)?k.outputChannelCount:Array.from(k.outputChannelCount),null===p){for(M=E.reduce((function(t,e){return t+e}),0),q=s(A,{channelCount:Math.max(1,M),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,M)}),R=[],V=0;V<S.numberOfOutputs;V+=1)R.push(o(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:E[V]}));(F=u(A,{channelCount:k.channelCount,channelCountMode:k.channelCountMode,channelInterpretation:k.channelInterpretation,gain:1})).connect=n.bind(null,R),F.disconnect=l.bind(null,R),O=[q,R,F]}else C||(D=new p(A,_));if(b.set(A,null===O?D:O[2]),null===O){c.next=37;break}if(null!==w){c.next=26;break}if(void 0!==x){c.next=7;break}throw new Error("Missing the processor constructor.");case 7:if(null!==d){c.next=9;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 9:if(I=S.channelCount*S.numberOfInputs,P=void 0===x.parameterDescriptors?0:x.parameterDescriptors.length,j=I+P,L=r(t(T).mark((function e(){var n,i,c,l,h,f,p,_,x,b,w,D,O,C,E,M;return t(T).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=new d(j,128*Math.ceil(S.context.length/128),A.sampleRate),i=[],c=[],l=0;l<k.numberOfInputs;l+=1)i.push(u(n,{channelCount:k.channelCount,channelCountMode:k.channelCountMode,channelInterpretation:k.channelInterpretation,gain:1})),c.push(s(n,{channelCount:k.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:k.channelCount}));return e.next=4,Promise.all(Array.from(S.parameters.values()).map(r(t(T).mark((function e(i){var r;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i.value}),t.next=3,v(n,i,r.offset);case 3:return t.abrupt("return",(t.sent,r));case 4:case"end":return t.stop()}}),e)})))));case 4:for(h=e.sent,f=o(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,I+P)}),p=0;p<k.numberOfInputs;p+=1)for(i[p].connect(c[p]),_=0;_<k.channelCount;_+=1)c[p].connect(f,_,p*k.channelCount+_);for(x=!0,b=!1,w=void 0,e.prev=8,D=h.entries()[Symbol.iterator]();!(x=(O=D.next()).done);x=!0)C=g(O.value),E=C[0],(M=C[1]).connect(f,0,I+E),M.start(0);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),b=!0,w=e.t0;case 16:e.prev=16,e.prev=17,x||null==D.return||D.return();case 19:if(e.prev=19,!b){e.next=22;break}throw w;case 22:return e.finish(19);case 23:return e.finish(16);case 24:return f.connect(n.destination),e.next=27,Promise.all(i.map((function(t){return y(S,n,t)})));case 27:return e.abrupt("return",(e.sent,m(n)));case 28:case"end":return e.stop()}}),e,null,[[8,12,16,24],[17,,19,23]])}))),c.t0=Pt,c.t1=S,0!==j){c.next=16;break}c.t2=null,c.next=19;break;case 16:return c.next=18,L();case 18:c.t2=c.sent;case 19:c.t3=c.t2,c.t4=A,c.t5=k,c.t6=E,c.t7=x,c.t8=h,w=(0,c.t0)(c.t1,c.t3,c.t4,c.t5,c.t6,c.t7,c.t8);case 26:return c.next=28,w;case 28:for(N=c.sent,z=i(A,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),W=g(O),B=W[0],G=W[1],U=W[2],null!==N&&(z.buffer=N,z.start(0)),z.connect(B),Y=0,Z=0;Y<S.numberOfOutputs;Y+=1){for(X=G[Y],Q=0;Q<E[Y];Q+=1)B.connect(X,Z+Q,Q);Z+=E[Y]}return c.abrupt("return",U);case 37:if(H=!0,J=!1,$=void 0,K=!0,et=!1,nt=void 0,!C){c.next=64;break}c.prev=39,it=S.parameters.entries()[Symbol.iterator]();case 41:if(H=(rt=it.next()).done){c.next=48;break}return ot=g(rt.value),st=ot[0],at=ot[1],c.next=45,e(A,at,D.parameters.get(st));case 45:H=!0,c.next=41;break;case 48:c.next=54;break;case 50:c.prev=50,c.t9=c.catch(39),J=!0,$=c.t9;case 54:c.prev=54,c.prev=55,H||null==it.return||it.return();case 57:if(c.prev=57,!J){c.next=60;break}throw $;case 60:return c.finish(57);case 61:return c.finish(54);case 62:c.next=87;break;case 64:c.prev=64,ut=S.parameters.entries()[Symbol.iterator]();case 66:if(K=(ct=ut.next()).done){c.next=73;break}return lt=g(ct.value),ht=lt[0],ft=lt[1],c.next=70,v(A,ft,D.parameters.get(ht));case 70:K=!0,c.next=66;break;case 73:c.next=79;break;case 75:c.prev=75,c.t10=c.catch(64),et=!0,nt=c.t10;case 79:c.prev=79,c.prev=80,K||null==ut.return||ut.return();case 82:if(c.prev=82,!et){c.next=85;break}throw nt;case 85:return c.finish(82);case 86:return c.finish(79);case 87:return c.next=89,y(S,A,D);case 89:return c.abrupt("return",(c.sent,D));case 90:case"end":return c.stop()}}),c,null,[[39,50,54,62],[55,,57,61],[64,75,79,87],[80,,82,86]])})))(S,A)}}}}(oi,Pi,si,as,Jt,ds,Kt,ji,Li,bi,wt,Xn,Nn,ai,Pn,Cs),Ui=function(t){return function(e){return t.get(e)}}(wi),Yi=function(t){return function(e,n){t.set(e,n)}}(Ni),Zi=xi?function(t,e,i,r,s,u,c,l,h,f,p,y,m,_){var g=function(e){"use strict";d(m,e);var p=x(m);function m(e,a,d){var _,g;o(this,m);var k=l(e),x=h(k),b=function(t){return v({},t,{outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(function(){return 1}))})}(v({},Rt,d));!function(t){var e=new MessageChannel,n=e.port1,i=e.port2;try{n.postMessage(t)}finally{n.close(),i.close()}}(b);var w=j.get(k),T=null==w?void 0:w.get(a),S=x||"closed"!==k.state?k:null!==(g=c(k))&&void 0!==g?g:k,A=s(S,x?null:e.baseLatency,f,a,T,b);_=p.call(this,e,!0,A,x?r(a,b,T):null);var D=[];A.parameters.forEach((function(t,e){var r=i(n(_),x,t);D.push([e,r])})),_._nativeAudioWorkletNode=A,_._onprocessorerror=null,_._parameters=new qt(D),x&&t(k,n(_));var O=u(n(_)).activeInputs;return y(A,O),_}return a(m,[{key:"onprocessorerror",get:function(){return this._onprocessorerror},set:function(t){var e="function"==typeof t?_(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;var n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}},{key:"parameters",get:function(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}},{key:"port",get:function(){return this._nativeAudioWorkletNode.port}}]),m}(e);return g}(Ii,Qn,ui,Gi,Bi,ut,Ui,Ln,zn,Xn,0,Yi,0,Dn):void 0,Xi=function(t,e){return function(n,i,r){if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(e){if("SyntaxError"===e.name)throw t();throw e}}}(hn,Nn),Qi=function(t,e,n,i,r,o,s,a){return function(u,c){return n(u).render(u,c).then((function(){return Promise.all(Array.from(i(c)).map((function(t){return n(t).render(t,c)})))})).then((function(){return r(c)})).then((function(n){return"function"!=typeof n.copyFromChannel?(s(n),it(n)):e(o,(function(){return o(n)}))||a(n),t.add(n),n}))}}(Jn,Rn,In,Fi,Cs,et,ti,ei),Hi=function(t,e,n,i,r){var s=function(t){"use strict";d(u,t);var s=x(u);function u(t,n,r){var a,c;if(o(this,u),"number"==typeof t&&void 0!==n&&void 0!==r)c={length:n,numberOfChannels:t,sampleRate:r};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");c=t}var l=v({},fn,c),h=l.length,f=l.numberOfChannels,p=l.sampleRate,d=i(f,h,p);return e(Bt,(function(){return Bt(d)}))||d.addEventListener("statechange",function(){var t=0,e=function(n){"running"===a._state&&(t>0?(d.removeEventListener("statechange",e),n.stopImmediatePropagation(),a._waitForThePromiseToSettle(n)):t+=1)};return e}()),(a=s.call(this,d,f))._length=h,a._nativeOfflineAudioContext=d,a._state=null,m(a)}return a(u,[{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}},{key:"startRendering",value:function(){var t=this;return"running"===this._state?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally((function(){t._state=null,ht(t)})))}},{key:"_waitForThePromiseToSettle",value:function(t){var e=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((function(){return e._waitForThePromiseToSettle(t)}))}}]),u}(t);return s}(Oi,Rn,Nt,Xi,Qi),Ji=function(t,e){return function(n){var i=t.get(n);return e(i)||e(n)}}(F,Un),$i=function(t,e){return function(n){return t.has(n)||e(n)}}(q,Yn),Ki=function(t,e){return function(n){return t.has(n)||e(n)}}(V,Zn),tr=function(t,e){return function(n){var i=t.get(n);return e(i)||e(n)}}(F,zn),er=function(){return r(t(T).mark((function e(n,i,r,o,s,a,u,c,l,h,f,p,d,v,y,m){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=!!(n(i,i)&&n(r,r)&&n(s,s)&&n(a,a)&&n(c,c)&&n(l,l)&&n(h,h)&&n(f,f)&&n(p,p)&&n(d,d)&&n(v,v)),!t.t0){t.next=5;break}return t.next=4,Promise.all([n(o,o),n(u,u),n(y,y),n(m,m)]);case 4:t.t0=t.sent.every((function(t){return t}));case 5:return t.abrupt("return",t.t0);case 6:case"end":return t.stop()}}),e)})))(Rn,function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;var n=new Float32Array(2);try{e.copyFromChannel(n,0,0)}catch(t){return!1}return!0}}(Nn),function(t){return function(){if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;var e=new t,n=void 0!==e.close;try{e.close()}catch(t){}return n}}(Gn),(o=Nn,function(){if(null===o)return Promise.resolve(!1);var t=new o(1,1,44100);return new Promise((function(e){var n,i=!0,r=function(n){i&&(i=!1,t.startRendering(),e(n instanceof TypeError))};try{n=t.decodeAudioData(null,(function(){}),r)}catch(t){r(t)}void 0!==n&&n.catch(r)}))}),function(t){return function(){if(null===t)return!1;var e;try{e=new t({latencyHint:"balanced"})}catch(t){return!1}return e.close(),!0}}(Gn),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createGain(),n=e.connect(e)===e;return e.disconnect(e),n}}(Nn),(n=Xn,i=Nn,r(t(T).mark((function e(){var r,o,s,a,u,c,l;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n){t.next=2;break}return t.abrupt("return",!0);case 2:if(null!==i){t.next=4;break}return t.abrupt("return",!1);case 4:return r=new Blob(['let c,p;class A extends AudioWorkletProcessor{constructor(){super();this.port.onmessage=(e)=>{p=e.data;p.onmessage=()=>{p.postMessage(c);p.close()};this.port.postMessage(0)}}process(){c=1}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),o=new MessageChannel,s=new i(1,128,44100),a=URL.createObjectURL(r),u=!1,t.prev=6,t.next=9,s.audioWorklet.addModule(a);case 9:return c=new n(s,"a",{numberOfOutputs:0}),l=s.createOscillator(),t.next=12,new Promise((function(t){c.port.onmessage=function(){return t()},c.port.postMessage(o.port2,[o.port2])}));case 12:return c.port.onmessage=function(){return u=!0},l.connect(c),l.start(0),t.next=17,s.startRendering();case 17:return t.next=19,new Promise((function(t){o.port1.onmessage=function(e){var n=e.data;return t(1===n)},o.port1.postMessage(0)}));case 19:u=t.sent,t.next=24;break;case 22:t.prev=22,t.t0=t.catch(6);case 24:return t.prev=24,o.port1.close(),URL.revokeObjectURL(a),t.finish(24);case 27:return t.abrupt("return",u);case 28:case"end":return t.stop()}}),e,null,[[6,22,24,27]])})))),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch(t){return!0}return!1}}(Nn),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100);return void 0===e.createConstantSource||e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY}}(Nn),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100),n=e.createConvolver();n.buffer=e.createBuffer(1,1,e.sampleRate);try{n.buffer=e.createBuffer(1,1,e.sampleRate)}catch(t){return!1}return!0}}(Nn),function(t){return function(){if(null===t)return!1;var e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch(t){return!1}return!0}}(Nn),Tn,function(t){return function(){return null!==t&&t.hasOwnProperty("isSecureContext")}}(Vn),function(t){return function(){if(null===t)return!1;var e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}finally{e.close()}}}(Gn),(e=Nn,function(){if(null===e)return Promise.resolve(!1);var t=new e(1,1,44100);if(void 0===t.createStereoPanner)return Promise.resolve(!0);if(void 0===t.createConstantSource)return Promise.resolve(!0);var n=t.createConstantSource(),i=t.createStereoPanner();return n.channelCount=1,n.offset.value=1,i.channelCount=1,n.start(),n.connect(i).connect(t.destination),t.startRendering().then((function(t){return 1!==t.getChannelData(0)[0]}))}),Sn);var e,n,i,o};function nr(t){return void 0===t}function ir(t){return!nr(t)}function rr(t){return"function"==typeof t}function or(t){return"number"==typeof t}function sr(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function ar(t){return"boolean"==typeof t}function ur(t){return Array.isArray(t)}function cr(t){return"string"==typeof t}function lr(t){return cr(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function hr(t,e){if(!t)throw new Error(e)}function fr(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(e<=t&&t<=n))throw new RangeError("Value must be within [".concat(e,", ").concat(n,"], got: ").concat(t))}function pr(t){t.isOffline||"running"===t.state||xr('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var dr=!1,vr=!1;function yr(t){dr=t}function mr(t){nr(t)&&dr&&!vr&&(vr=!0,xr("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}var _r=console;function gr(t){_r=t}function kr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;(i=_r).log.apply(i,k(e))}function xr(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;(i=_r).warn.apply(i,k(e))}var br="object"==typeof self?self:null,wr=br&&(br.hasOwnProperty("AudioContext")||br.hasOwnProperty("webkitAudioContext"));function Tr(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function Sr(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{u(i.next(t))}catch(t){o(t)}}function a(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((i=i.apply(t,e||[])).next())}))}Object.create,Object.create;var Ar=function(){"use strict";function t(e,n,i){o(this,t),this._callback=e,this._type=n,this._updateInterval=i,this._createClock()}return a(t,[{key:"_createWorker",value:function(){var t=new Blob(["\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ".concat((1e3*this._updateInterval).toFixed(1),";\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t")],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}},{key:"_createTimeout",value:function(){var t=this;this._timeout=setTimeout((function(){t._createTimeout(),t._callback()}),1e3*this._updateInterval)}},{key:"_createClock",value:function(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}},{key:"_disposeClock",value:function(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}},{key:"updateInterval",get:function(){return this._updateInterval},set:function(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}},{key:"type",get:function(){return this._type},set:function(t){this._disposeClock(),this._type=t,this._createClock()}},{key:"dispose",value:function(){this._disposeClock()}}]),t}();function Dr(t){return Ki(t)}function Or(t){return $i(t)}function Cr(t){return tr(t)}function Er(t){return Ji(t)}function Mr(t){return t instanceof ni}function qr(t,e){return"value"===t||Dr(e)||Or(e)||Mr(e)}function Rr(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(!n.length)return t;var r=n.shift();if(sr(t)&&sr(r))for(var o in r)qr(o,r[o])?t[o]=r[o]:sr(r[o])?(t[o]||Object.assign(t,u({},o,{})),Rr(t[o],r[o])):Object.assign(t,u({},o,r[o]));return Rr.apply(void 0,[t].concat(k(n)))}function Vr(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,r={},o=Array.from(e);if(sr(o[0])&&i&&!Reflect.has(o[0],i)&&(Object.keys(o[0]).some((function(e){return Reflect.has(t,e)}))||(Rr(r,u({},i,o[0])),n.splice(n.indexOf(i),1),o.shift())),1===o.length&&sr(o[0]))Rr(r,o[0]);else for(var s=0;s<n.length;s++)ir(o[s])&&(r[n[s]]=o[s]);return Rr(t,r)}function Fr(t,e){return nr(t)?e:t}function Ir(t,e){return e.forEach((function(e){Reflect.has(t,e)&&delete t[e]})),t}var Pr=function(){"use strict";function t(){o(this,t),this.debug=!1,this._wasDisposed=!1}return a(t,[{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];(this.debug||br&&this.toString()===br.TONE_DEBUG_CLASS)&&kr.apply(void 0,[this].concat(k(e)))}},{key:"dispose",value:function(){return this._wasDisposed=!0,this}},{key:"disposed",get:function(){return this._wasDisposed}},{key:"toString",value:function(){return this.name}}],[{key:"getDefaults",value:function(){return{}}}]),t}();Pr.version=O;var jr=1e-6;function Lr(t,e){return t>e+jr}function Nr(t,e){return Lr(t,e)||Wr(t,e)}function zr(t,e){return t+jr<e}function Wr(t,e){return Math.abs(t-e)<jr}function Br(t,e,n){return Math.max(Math.min(t,n),e)}var Gr=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this)).name="Timeline",t._timeline=[];var i=Vr(n.getDefaults(),arguments,["memory"]);return t.memory=i.memory,t.increasing=i.increasing,m(t)}return a(n,[{key:"length",get:function(){return this._timeline.length}},{key:"add",value:function(t){if(hr(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){var e=this._timeline[this.length-1];hr(Nr(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{var n=this._search(t.time);this._timeline.splice(n+1,0,t)}if(this.length>this.memory){var i=this.length-this.memory;this._timeline.splice(0,i)}return this}},{key:"remove",value:function(t){var e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(t,e);return-1!==n?this._timeline[n]:null}},{key:"peek",value:function(){return this._timeline[0]}},{key:"shift",value:function(){return this._timeline.shift()}},{key:"getAfter",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}},{key:"getBefore",value:function(t){var e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];var n=this._search(t);return n-1>=0?this._timeline[n-1]:null}},{key:"cancel",value:function(t){if(this._timeline.length>1){var e=this._search(t);if(e>=0)if(Wr(this._timeline[e].time,t)){for(var n=e;n>=0&&Wr(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&Nr(this._timeline[0].time,t)&&(this._timeline=[]);return this}},{key:"cancelBefore",value:function(t){var e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}},{key:"previousEvent",value:function(t){var e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}},{key:"_search",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";if(0===this._timeline.length)return-1;var n=0,i=this._timeline.length,r=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<r;){var o=Math.floor(n+(r-n)/2),s=this._timeline[o],a=this._timeline[o+1];if(Wr(s[e],t)){for(var u=o;u<this._timeline.length&&Wr(this._timeline[u][e],t);u++)o=u;return o}if(zr(s[e],t)&&Lr(a[e],t))return o;Lr(s[e],t)?r=o:n=o+1}return-1}},{key:"_iterate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._timeline.length-1;this._timeline.slice(e,n+1).forEach(t)}},{key:"forEach",value:function(t){return this._iterate(t),this}},{key:"forEachBefore",value:function(t,e){var n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}},{key:"forEachAfter",value:function(t,e){var n=this._search(t);return this._iterate(e,n+1),this}},{key:"forEachBetween",value:function(t,e,n){var i=this._search(t),r=this._search(e);return-1!==i&&-1!==r?(this._timeline[i].time!==t&&(i+=1),this._timeline[r].time===e&&(r-=1),this._iterate(n,i,r)):-1===i&&this._iterate(n,0,r),this}},{key:"forEachFrom",value:function(t,e){for(var n=this._search(t);n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}},{key:"forEachAtTime",value:function(t,e){var n=this._search(t);if(-1!==n&&Wr(this._timeline[n].time,t)){for(var i=n,r=n;r>=0&&Wr(this._timeline[r].time,t);r--)i=r;this._iterate((function(t){e(t)}),i,n)}return this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._timeline=[],this}}],[{key:"getDefaults",value:function(){return{memory:1/0,increasing:!1}}}]),n}(Pr),Ur=[];function Yr(t){Ur.push(t)}var Zr=[];function Xr(t){Zr.push(t)}var Qr=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Emitter",m(t)}return a(n,[{key:"on",value:function(t,e){var n=this;return t.split(/\W+/).forEach((function(t){nr(n._events)&&(n._events={}),n._events.hasOwnProperty(t)||(n._events[t]=[]),n._events[t].push(e)})),this}},{key:"once",value:function(t,e){var n=this,i=function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];e.apply(void 0,k(o)),n.off(t,i)};return this.on(t,i),this}},{key:"off",value:function(t,e){var n=this;return t.split(/\W+/).forEach((function(t){if(nr(n._events)&&(n._events={}),n._events.hasOwnProperty(t))if(nr(e))n._events[t]=[];else for(var i=n._events[t],r=i.length-1;r>=0;r--)i[r]===e&&i.splice(r,1)})),this}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];if(this._events&&this._events.hasOwnProperty(t))for(var r=this._events[t].slice(0),o=0,s=r.length;o<s;o++)r[o].apply(this,n);return this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._events=void 0,this}}],[{key:"mixin",value:function(t){["on","once","off","emit"].forEach((function(e){var i=Object.getOwnPropertyDescriptor(n.prototype,e);Object.defineProperty(t.prototype,e,i)}))}}]),n}(Pr),Hr=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).isOffline=!1,m(t)}return a(n,[{key:"toJSON",value:function(){return{}}}]),n}(Qr),Jr=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this)).name="Context",t._constants=new Map,t._timeouts=new Gr,t._timeoutIds=0,t._initialized=!1,t.isOffline=!1,t._workletModules=new Map;var e=Vr(r.getDefaults(),arguments,["context"]);return e.context?t._context=e.context:t._context=function(t){return new Vi(t)}({latencyHint:e.latencyHint}),t._ticker=new Ar(t.emit.bind(n(t),"tick"),e.clockSource,e.updateInterval),t.on("tick",t._timeoutLoop.bind(n(t))),t._context.onstatechange=function(){t.emit("statechange",t.state)},t._setLatencyHint(e.latencyHint),t.lookAhead=e.lookAhead,m(t)}return a(r,[{key:"initialize",value:function(){var t;return this._initialized||(t=this,Ur.forEach((function(e){return e(t)})),this._initialized=!0),this}},{key:"createAnalyser",value:function(){return this._context.createAnalyser()}},{key:"createOscillator",value:function(){return this._context.createOscillator()}},{key:"createBufferSource",value:function(){return this._context.createBufferSource()}},{key:"createBiquadFilter",value:function(){return this._context.createBiquadFilter()}},{key:"createBuffer",value:function(t,e,n){return this._context.createBuffer(t,e,n)}},{key:"createChannelMerger",value:function(t){return this._context.createChannelMerger(t)}},{key:"createChannelSplitter",value:function(t){return this._context.createChannelSplitter(t)}},{key:"createConstantSource",value:function(){return this._context.createConstantSource()}},{key:"createConvolver",value:function(){return this._context.createConvolver()}},{key:"createDelay",value:function(t){return this._context.createDelay(t)}},{key:"createDynamicsCompressor",value:function(){return this._context.createDynamicsCompressor()}},{key:"createGain",value:function(){return this._context.createGain()}},{key:"createIIRFilter",value:function(t,e){return this._context.createIIRFilter(t,e)}},{key:"createPanner",value:function(){return this._context.createPanner()}},{key:"createPeriodicWave",value:function(t,e,n){return this._context.createPeriodicWave(t,e,n)}},{key:"createStereoPanner",value:function(){return this._context.createStereoPanner()}},{key:"createWaveShaper",value:function(){return this._context.createWaveShaper()}},{key:"createMediaStreamSource",value:function(t){return hr(Er(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}},{key:"createMediaElementSource",value:function(t){return hr(Er(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}},{key:"createMediaStreamDestination",value:function(){return hr(Er(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}},{key:"decodeAudioData",value:function(t){return this._context.decodeAudioData(t)}},{key:"currentTime",get:function(){return this._context.currentTime}},{key:"state",get:function(){return this._context.state}},{key:"sampleRate",get:function(){return this._context.sampleRate}},{key:"listener",get:function(){return this.initialize(),this._listener},set:function(t){hr(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}},{key:"transport",get:function(){return this.initialize(),this._transport},set:function(t){hr(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}},{key:"draw",get:function(){return this.initialize(),this._draw},set:function(t){hr(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}},{key:"destination",get:function(){return this.initialize(),this._destination},set:function(t){hr(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}},{key:"createAudioWorkletNode",value:function(t,e){return function(t,e,n){return hr(ir(Zi),"This node only works in a secure context (https or localhost)"),new Zi(t,e,n)}(this.rawContext,t,e)}},{key:"addAudioWorkletModule",value:function(e,n){return Sr(this,void 0,void 0,t(T).mark((function i(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return hr(ir(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(n)||this._workletModules.set(n,this.rawContext.audioWorklet.addModule(e)),t.next=4,this._workletModules.get(n);case 4:case"end":return t.stop()}}),i,this)})))}},{key:"workletsAreReady",value:function(){return Sr(this,void 0,void 0,t(T).mark((function e(){var n;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],this._workletModules.forEach((function(t){return n.push(t)})),t.next=4,Promise.all(n);case 4:case"end":return t.stop()}}),e,this)})))}},{key:"updateInterval",get:function(){return this._ticker.updateInterval},set:function(t){this._ticker.updateInterval=t}},{key:"clockSource",get:function(){return this._ticker.type},set:function(t){this._ticker.type=t}},{key:"latencyHint",get:function(){return this._latencyHint}},{key:"_setLatencyHint",value:function(t){var e=0;if(this._latencyHint=t,cr(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}},{key:"rawContext",get:function(){return this._context}},{key:"now",value:function(){return this._context.currentTime+this.lookAhead}},{key:"immediate",value:function(){return this._context.currentTime}},{key:"resume",value:function(){return Er(this._context)?this._context.resume():Promise.resolve()}},{key:"close",value:function(){return Sr(this,void 0,void 0,t(T).mark((function e(){var n;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=Er(this._context),!t.t0){t.next=5;break}return t.next=5,this._context.close();case 5:this._initialized&&(n=this,Zr.forEach((function(t){return t(n)})));case 6:case"end":return t.stop()}}),e,this)})))}},{key:"getConstant",value:function(t){if(this._constants.has(t))return this._constants.get(t);for(var e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0),i=0;i<n.length;i++)n[i]=t;var r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=e,r.loop=!0,r.start(0),this._constants.set(t,r),r}},{key:"dispose",value:function(){var t=this;return f(l(r.prototype),"dispose",this).call(this),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((function(e){return t._constants[e].disconnect()})),this}},{key:"_timeoutLoop",value:function(){for(var t=this.now(),e=this._timeouts.peek();this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}},{key:"setTimeout",value:function(t,e){this._timeoutIds++;var n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}},{key:"clearTimeout",value:function(t){var e=this;return this._timeouts.forEach((function(n){n.id===t&&e._timeouts.remove(n)})),this}},{key:"clearInterval",value:function(t){return this.clearTimeout(t)}},{key:"setInterval",value:function(t,e){var n=this,i=++this._timeoutIds,r=function(){var o=n.now();n._timeouts.add({callback:function(){t(),r()},id:i,time:o+e})};return r(),i}}],[{key:"getDefaults",value:function(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}}]),r}(Hr);function $r(t,e){ur(e)?e.forEach((function(e){return $r(t,e)})):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function Kr(t,e){ur(e)?e.forEach((function(e){return Kr(t,e)})):Object.defineProperty(t,e,{writable:!0})}var to=function(){},eo=function(e){"use strict";d(i,e);var n=x(i);function i(){var t;o(this,i),(t=n.call(this)).name="ToneAudioBuffer",t.onload=to;var e=Vr(i.getDefaults(),arguments,["url","onload","onerror"]);return t.reverse=e.reverse,t.onload=e.onload,e.url&&Mr(e.url)||e.url instanceof i?t.set(e.url):cr(e.url)&&t.load(e.url).catch(e.onerror),m(t)}return a(i,[{key:"sampleRate",get:function(){return this._buffer?this._buffer.sampleRate:oo().sampleRate}},{key:"set",value:function(t){var e=this;return t instanceof i?t.loaded?this._buffer=t.get():t.onload=function(){e.set(t),e.onload(e)}:this._buffer=t,this._reversed&&this._reverse(),this}},{key:"get",value:function(){return this._buffer}},{key:"load",value:function(e){return Sr(this,void 0,void 0,t(T).mark((function n(){var r,o,s;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this,o=i.load(e).then((function(t){r.set(t),r.onload(r)})),i.downloads.push(o),t.prev=3,t.next=6,o;case 6:return t.prev=6,s=i.downloads.indexOf(o),i.downloads.splice(s,1),t.finish(6);case 10:return t.abrupt("return",this);case 11:case"end":return t.stop()}}),n,this,[[3,,6,10]])})))}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._buffer=void 0,this}},{key:"fromArray",value:function(t){for(var e=ur(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,r=oo(),o=r.createBuffer(n,i,r.sampleRate),s=e||1!==n?t:[t],a=0;a<n;a++)o.copyToChannel(s[a],a);return this._buffer=o,this}},{key:"toMono",value:function(t){if(or(t))this.fromArray(this.toArray(t));else{for(var e=new Float32Array(this.length),n=this.numberOfChannels,i=0;i<n;i++)for(var r=this.toArray(i),o=0;o<r.length;o++)e[o]+=r[o];e=e.map((function(t){return t/n})),this.fromArray(e)}return this}},{key:"toArray",value:function(t){if(or(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);for(var e=[],n=0;n<this.numberOfChannels;n++)e[n]=this.getChannelData(n);return e}},{key:"getChannelData",value:function(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}},{key:"slice",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration;hr(this.loaded,"Buffer is not loaded");var n=Math.floor(t*this.sampleRate),r=Math.floor(e*this.sampleRate);hr(n<r,"The start time must be less than the end time");for(var o=r-n,s=oo().createBuffer(this.numberOfChannels,o,this.sampleRate),a=0;a<this.numberOfChannels;a++)s.copyToChannel(this.getChannelData(a).subarray(n,r),a);return new i(s)}},{key:"_reverse",value:function(){if(this.loaded)for(var t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}},{key:"loaded",get:function(){return this.length>0}},{key:"duration",get:function(){return this._buffer?this._buffer.duration:0}},{key:"length",get:function(){return this._buffer?this._buffer.length:0}},{key:"numberOfChannels",get:function(){return this._buffer?this._buffer.numberOfChannels:0}},{key:"reverse",get:function(){return this._reversed},set:function(t){this._reversed!==t&&(this._reversed=t,this._reverse())}}],[{key:"getDefaults",value:function(){return{onerror:to,onload:to,reverse:!1}}},{key:"fromArray",value:function(t){return(new i).fromArray(t)}},{key:"fromUrl",value:function(e){return Sr(this,void 0,void 0,t(T).mark((function n(){var r;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new i,t.next=3,r.load(e);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),n)})))}},{key:"load",value:function(e){return Sr(this,void 0,void 0,t(T).mark((function n(){var r,o,s,a,u,c,l,h,f,p,d,v,y;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r=e.match(/\[([^\]\[]+\|.+)\]$/))){t.next=30;break}o=r[1].split("|"),s=o[0],a=!0,u=!1,c=void 0,t.prev=5,l=o[Symbol.iterator]();case 7:if(a=(h=l.next()).done){t.next=15;break}if(f=h.value,!i.supportsType(f)){t.next=12;break}return s=f,t.abrupt("break",15);case 12:a=!0,t.next=7;break;case 15:t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),u=!0,c=t.t0;case 21:t.prev=21,t.prev=22,a||null==l.return||l.return();case 24:if(t.prev=24,!u){t.next=27;break}throw c;case 27:return t.finish(24);case 28:return t.finish(21);case 29:e=e.replace(r[0],s);case 30:return p=""===i.baseUrl||i.baseUrl.endsWith("/")?i.baseUrl:i.baseUrl+"/",(d=document.createElement("a")).href=p+e,d.pathname=(d.pathname+d.hash).split("/").map(encodeURIComponent).join("/"),t.next=34,fetch(d.href);case 34:if((v=t.sent).ok){t.next=37;break}throw new Error("could not load url: ".concat(e));case 37:return t.next=39,v.arrayBuffer();case 39:return y=t.sent,t.next=42,oo().decodeAudioData(y);case 42:return t.abrupt("return",t.sent);case 43:case"end":return t.stop()}}),n,null,[[5,17,21,29],[22,,24,28]])})))}},{key:"supportsType",value:function(t){var e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}},{key:"loaded",value:function(){return Sr(this,void 0,void 0,t(T).mark((function e(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve();case 2:if(!i.downloads.length){t.next=7;break}return t.next=5,i.downloads[0];case 5:t.next=2;break;case 7:case"end":return t.stop()}}),e)})))}}]),i}(Pr);eo.baseUrl="",eo.downloads=[];var no=function(e){"use strict";d(i,e);var n=x(i);function i(){var t,e,r,s;return o(this,i),(t=n.call(this,{clockSource:"offline",context:Cr(arguments[0])?arguments[0]:(e=arguments[0],r=arguments[1]*arguments[2],s=arguments[2],new Hi(e,r,s)),lookAhead:0,updateInterval:Cr(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]})).name="OfflineContext",t._currentTime=0,t.isOffline=!0,t._duration=Cr(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1],m(t)}return a(i,[{key:"now",value:function(){return this._currentTime}},{key:"currentTime",get:function(){return this._currentTime}},{key:"_renderClock",value:function(e){return Sr(this,void 0,void 0,t(T).mark((function n(){var i,r;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0;case 1:if(!(this._duration-this._currentTime>=0)){t.next=10;break}if(this.emit("tick"),this._currentTime+=128/this.sampleRate,i++,r=Math.floor(this.sampleRate/128),t.t0=e&&i%r==0,!t.t0){t.next=8;break}return t.next=8,new Promise((function(t){return setTimeout(t,1)}));case 8:t.next=1;break;case 10:case"end":return t.stop()}}),n,this)})))}},{key:"render",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Sr(this,void 0,void 0,t(T).mark((function n(){var i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.workletsAreReady();case 2:return t.next=4,this._renderClock(e);case 4:return t.next=6,this._context.startRendering();case 6:return i=t.sent,t.abrupt("return",new eo(i));case 8:case"end":return t.stop()}}),n,this)})))}},{key:"close",value:function(){return Promise.resolve()}}]),i}(Jr),io=new(function(e){"use strict";d(i,e);var n=x(i);function i(){var t;return o(this,i),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).lookAhead=0,t.latencyHint=0,t.isOffline=!1,m(t)}return a(i,[{key:"createAnalyser",value:function(){return{}}},{key:"createOscillator",value:function(){return{}}},{key:"createBufferSource",value:function(){return{}}},{key:"createBiquadFilter",value:function(){return{}}},{key:"createBuffer",value:function(t,e,n){return{}}},{key:"createChannelMerger",value:function(t){return{}}},{key:"createChannelSplitter",value:function(t){return{}}},{key:"createConstantSource",value:function(){return{}}},{key:"createConvolver",value:function(){return{}}},{key:"createDelay",value:function(t){return{}}},{key:"createDynamicsCompressor",value:function(){return{}}},{key:"createGain",value:function(){return{}}},{key:"createIIRFilter",value:function(t,e){return{}}},{key:"createPanner",value:function(){return{}}},{key:"createPeriodicWave",value:function(t,e,n){return{}}},{key:"createStereoPanner",value:function(){return{}}},{key:"createWaveShaper",value:function(){return{}}},{key:"createMediaStreamSource",value:function(t){return{}}},{key:"createMediaElementSource",value:function(t){return{}}},{key:"createMediaStreamDestination",value:function(){return{}}},{key:"decodeAudioData",value:function(t){return Promise.resolve({})}},{key:"createAudioWorkletNode",value:function(t,e){return{}}},{key:"rawContext",get:function(){return{}}},{key:"addAudioWorkletModule",value:function(e,n){return Sr(this,void 0,void 0,t(T).mark((function e(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.resolve());case 1:case"end":return t.stop()}}),e)})))}},{key:"resume",value:function(){return Promise.resolve()}},{key:"setTimeout",value:function(t,e){return 0}},{key:"clearTimeout",value:function(t){return this}},{key:"setInterval",value:function(t,e){return 0}},{key:"clearInterval",value:function(t){return this}},{key:"getConstant",value:function(t){return{}}},{key:"currentTime",get:function(){return 0}},{key:"state",get:function(){return{}}},{key:"sampleRate",get:function(){return 0}},{key:"listener",get:function(){return{}}},{key:"transport",get:function(){return{}}},{key:"draw",get:function(){return{}},set:function(t){}},{key:"destination",get:function(){return{}},set:function(t){}},{key:"now",value:function(){return 0}},{key:"immediate",value:function(){return 0}}]),i}(Hr)),ro=io;function oo(){return ro===io&&wr&&so(new Jr),ro}function so(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&ro.dispose(),ro=Er(t)?new Jr(t):Cr(t)?new no(t):t}function ao(){return ro.resume()}if(br&&!br.TONE_SILENCE_LOGGING){var uo="v";"dev"===O&&(uo="");var co=" * Tone.js ".concat(uo).concat(O," * ");console.log("%c".concat(co),"background: #000; color: #fff")}function lo(t){return Math.pow(10,t/20)}function ho(t){return Math.log(t)/Math.LN10*20}function fo(t){return Math.pow(2,t/12)}var po=440;function vo(t){return Math.round(yo(t))}function yo(t){return 69+12*Math.log2(t/po)}function mo(t){return po*Math.pow(2,(t-69)/12)}var _o=function(t){"use strict";d(n,t);var e=x(n);function n(t,i,r){var s;return o(this,n),(s=e.call(this)).defaultUnits="s",s._val=i,s._units=r,s.context=t,s._expressions=s._getExpressions(),m(s)}return a(n,[{key:"_getExpressions",value:function(){var t=this;return{hz:{method:function(e){return t._frequencyToUnits(parseFloat(e))},regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:function(e){return t._ticksToUnits(parseInt(e,10))},regexp:/^(\d+)i$/i},m:{method:function(e){return t._beatsToUnits(parseInt(e,10)*t._getTimeSignature())},regexp:/^(\d+)m$/i},n:{method:function(e,n){var i=parseInt(e,10),r="."===n?1.5:1;return 1===i?t._beatsToUnits(t._getTimeSignature())*r:t._beatsToUnits(4/i)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:function(e){return t._expressions[t.defaultUnits].method.call(t,e)},regexp:/^(\d+(?:\.\d+)?)$/},s:{method:function(e){return t._secondsToUnits(parseFloat(e))},regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:function(e){return parseInt(e,10)/t.context.sampleRate},regexp:/^(\d+)samples$/},t:{method:function(e){var n=parseInt(e,10);return t._beatsToUnits(8/(3*Math.floor(n)))},regexp:/^(\d+)t$/i},tr:{method:function(e,n,i){var r=0;return e&&"0"!==e&&(r+=t._beatsToUnits(t._getTimeSignature()*parseFloat(e))),n&&"0"!==n&&(r+=t._beatsToUnits(parseFloat(n))),i&&"0"!==i&&(r+=t._beatsToUnits(parseFloat(i)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}},{key:"valueOf",value:function(){if(this._val instanceof n&&this.fromType(this._val),nr(this._val))return this._noArg();if(cr(this._val)&&nr(this._units)){for(var t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(sr(this._val)){var e=0;for(var i in this._val)if(ir(this._val[i])){var r=this._val[i];e+=new this.constructor(this.context,i).valueOf()*r}return e}if(ir(this._units)){var o=this._expressions[this._units],s=this._val.toString().trim().match(o.regexp);return s?o.method.apply(this,s.slice(1)):o.method.call(this,this._val)}return cr(this._val)?parseFloat(this._val):this._val}},{key:"_frequencyToUnits",value:function(t){return 1/t}},{key:"_beatsToUnits",value:function(t){return 60/this._getBpm()*t}},{key:"_secondsToUnits",value:function(t){return t}},{key:"_ticksToUnits",value:function(t){return t*this._beatsToUnits(1)/this._getPPQ()}},{key:"_noArg",value:function(){return this._now()}},{key:"_getBpm",value:function(){return this.context.transport.bpm.value}},{key:"_getTimeSignature",value:function(){return this.context.transport.timeSignature}},{key:"_getPPQ",value:function(){return this.context.transport.PPQ}},{key:"fromType",value:function(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}},{key:"toFrequency",value:function(){return 1/this.toSeconds()}},{key:"toSamples",value:function(){return this.toSeconds()*this.context.sampleRate}},{key:"toMilliseconds",value:function(){return 1e3*this.toSeconds()}}]),n}(Pr),go=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="TimeClass",m(t)}return a(n,[{key:"_getExpressions",value:function(){var t=this;return Object.assign(f(l(n.prototype),"_getExpressions",this).call(this),{now:{method:function(e){return t._now()+new t.constructor(t.context,e).valueOf()},regexp:/^\+(.+)/},quantize:{method:function(e){var i=new n(t.context,e).valueOf();return t._secondsToUnits(t.context.transport.nextSubdivision(i))},regexp:/^@(.+)/}})}},{key:"quantize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}},{key:"toNotation",value:function(){for(var t=this,e=this.toSeconds(),i=["1m"],r=1;r<9;r++){var o=Math.pow(2,r);i.push(o+"n."),i.push(o+"n"),i.push(o+"t")}i.push("0");var s=i[0],a=new n(this.context,i[0]).toSeconds();return i.forEach((function(i){var r=new n(t.context,i).toSeconds();Math.abs(r-e)<Math.abs(a-e)&&(s=i,a=r)})),s}},{key:"toBarsBeatsSixteenths",value:function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;e=parseFloat(e.toFixed(4));var n=Math.floor(e/this._getTimeSignature()),i=e%1*4;e=Math.floor(e)%this._getTimeSignature();var r=i.toString();return r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3))),[n,e,i].join(":")}},{key:"toTicks",value:function(){var t=this._beatsToUnits(1);return this.valueOf()/t*this._getPPQ()}},{key:"toSeconds",value:function(){return this.valueOf()}},{key:"toMidi",value:function(){return vo(this.toFrequency())}},{key:"_now",value:function(){return this.context.now()}}]),n}(_o);function ko(t,e){return new go(oo(),t,e)}var xo=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Frequency",t.defaultUnits="hz",m(t)}return a(n,[{key:"_getExpressions",value:function(){return Object.assign({},f(l(n.prototype),"_getExpressions",this).call(this),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return"midi"===this.defaultUnits?t:n.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method:function(t,e){var i=bo[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?i:n.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,n){var i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}},{key:"transpose",value:function(t){return new n(this.context,this.valueOf()*fo(t))}},{key:"harmonize",value:function(t){var e=this;return t.map((function(t){return e.transpose(t)}))}},{key:"toMidi",value:function(){return vo(this.valueOf())}},{key:"toNote",value:function(){var t=this.toFrequency(),e=Math.log2(t/n.A4),i=Math.round(12*e)+57,r=Math.floor(i/12);return r<0&&(i+=-12*r),wo[i%12]+r.toString()}},{key:"toSeconds",value:function(){return 1/f(l(n.prototype),"toSeconds",this).call(this)}},{key:"toTicks",value:function(){var t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}},{key:"_noArg",value:function(){return 0}},{key:"_frequencyToUnits",value:function(t){return t}},{key:"_ticksToUnits",value:function(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}},{key:"_beatsToUnits",value:function(t){return 1/f(l(n.prototype),"_beatsToUnits",this).call(this,t)}},{key:"_secondsToUnits",value:function(t){return 1/t}}],[{key:"A4",get:function(){return po},set:function(t){!function(t){po=t}(t)}},{key:"mtof",value:function(t){return mo(t)}},{key:"ftom",value:function(t){return vo(t)}}]),n}(go),bo={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},wo=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function To(t,e){return new xo(oo(),t,e)}var So=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="TransportTime",m(t)}return a(n,[{key:"_now",value:function(){return this.context.transport.seconds}}]),n}(go);function Ao(t,e){return new So(oo(),t,e)}var Do=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),t=e.call(this);var i=Vr(n.getDefaults(),arguments,["context"]);return t.defaultContext?t.context=t.defaultContext:t.context=i.context,t}return a(n,[{key:"now",value:function(){return this.context.currentTime+this.context.lookAhead}},{key:"immediate",value:function(){return this.context.currentTime}},{key:"sampleTime",get:function(){return 1/this.context.sampleRate}},{key:"blockTime",get:function(){return 128/this.context.sampleRate}},{key:"toSeconds",value:function(t){return mr(t),new go(this.context,t).toSeconds()}},{key:"toFrequency",value:function(t){return new xo(this.context,t).toFrequency()}},{key:"toTicks",value:function(t){return new So(this.context,t).toTicks()}},{key:"_getPartialProperties",value:function(t){var e=this.get();return Object.keys(e).forEach((function(n){nr(t[n])&&delete e[n]})),e}},{key:"get",value:function(){var t=this,e=this.constructor.getDefaults();return Object.keys(e).forEach((function(i){if(Reflect.has(t,i)){var r=t[i];ir(r)&&ir(r.value)&&ir(r.setValueAtTime)?e[i]=r.value:r instanceof n?e[i]=r._getPartialProperties(e[i]):ur(r)||or(r)||cr(r)||ar(r)?e[i]=r:delete e[i]}})),e}},{key:"set",value:function(t){var e=this;return Object.keys(t).forEach((function(i){Reflect.has(e,i)&&ir(e[i])&&(e[i]&&ir(e[i].value)&&ir(e[i].setValueAtTime)?e[i].value!==t[i]&&(e[i].value=t[i]):e[i]instanceof n?e[i].set(t[i]):e[i]=t[i])})),this}}],[{key:"getDefaults",value:function(){return{context:oo()}}}]),n}(Pr),Oo=function(t){"use strict";d(n,t);var e=x(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stopped";return o(this,n),(t=e.call(this)).name="StateTimeline",t._initial=i,t.setStateAtTime(t._initial,0),m(t)}return a(n,[{key:"getValueAtTime",value:function(t){var e=this.get(t);return null!==e?e.state:this._initial}},{key:"setStateAtTime",value:function(t,e,n){return fr(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}},{key:"getLastState",value:function(t,e){for(var n=this._search(e);n>=0;n--){var i=this._timeline[n];if(i.state===t)return i}}},{key:"getNextState",value:function(t,e){var n=this._search(e);if(-1!==n)for(var i=n;i<this._timeline.length;i++){var r=this._timeline[i];if(r.state===t)return r}}}]),n}(Gr),Co=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["param","units","convert"]))).name="Param",t.overridden=!1,t._minOutput=1e-7;var i=Vr(n.getDefaults(),arguments,["param","units","convert"]);for(hr(ir(i.param)&&(Dr(i.param)||i.param instanceof n),"param must be an AudioParam");!Dr(i.param);)i.param=i.param._param;return t._swappable=!!ir(i.swappable)&&i.swappable,t._swappable?(t.input=t.context.createGain(),t._param=i.param,t.input.connect(t._param)):t._param=t.input=i.param,t._events=new Gr(1e3),t._initialValue=t._param.defaultValue,t.units=i.units,t.convert=i.convert,t._minValue=i.minValue,t._maxValue=i.maxValue,ir(i.value)&&i.value!==t._toType(t._initialValue)&&t.setValueAtTime(i.value,0),m(t)}return a(n,[{key:"value",get:function(){var t=this.now();return this.getValueAtTime(t)},set:function(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}},{key:"minValue",get:function(){return ir(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}},{key:"maxValue",get:function(){return ir(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}},{key:"_is",value:function(t,e){return this.units===e}},{key:"_assertRange",value:function(t){return ir(this.maxValue)&&ir(this.minValue)&&fr(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}},{key:"_fromType",value:function(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?lo(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}},{key:"_toType",value:function(t){return this.convert&&"decibels"===this.units?ho(t):t}},{key:"setValueAtTime",value:function(t,e){var n=this.toSeconds(e),i=this._fromType(t);return hr(isFinite(i)&&isFinite(n),"Invalid argument(s) to setValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}},{key:"getValueAtTime",value:function(t){var e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e),r=this._initialValue;if(null===i)r=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)r=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){var o=i.value;if("setTargetAtTime"===i.type){var s=this._events.getBefore(i.time);o=null===s?this._initialValue:s.value}r="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,o,n.time,n.value,e):this._exponentialInterpolate(i.time,o,n.time,n.value,e)}else r=i.value;else{var a,u=this._events.getBefore(i.time);a=null===u?this._initialValue:u.value,"setTargetAtTime"===i.type&&(r=this._exponentialApproach(i.time,a,i.value,i.constant,e))}return this._toType(r)}},{key:"setRampPoint",value:function(t){t=this.toSeconds(t);var e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}},{key:"linearRampToValueAtTime",value:function(t,e){var n=this._fromType(t),i=this.toSeconds(e);return hr(isFinite(n)&&isFinite(i),"Invalid argument(s) to linearRampToValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}},{key:"exponentialRampToValueAtTime",value:function(t,e){var n=this._fromType(t);n=Wr(n,0)?this._minOutput:n,this._assertRange(n);var i=this.toSeconds(e);return hr(isFinite(n)&&isFinite(i),"Invalid argument(s) to exponentialRampToValueAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}},{key:"exponentialRampTo",value:function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}},{key:"linearRampTo",value:function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}},{key:"targetRampTo",value:function(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}},{key:"exponentialApproachValueAtTime",value:function(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);var i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}},{key:"setTargetAtTime",value:function(t,e,n){var i=this._fromType(t);hr(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");var r=this.toSeconds(e);return this._assertRange(i),hr(isFinite(i)&&isFinite(r),"Invalid argument(s) to setTargetAtTime: ".concat(JSON.stringify(t),", ").concat(JSON.stringify(e))),this._events.add({constant:n,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,r,n),this._param.setTargetAtTime(i,r,n),this}},{key:"setValueCurveAtTime",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n=this.toSeconds(n),e=this.toSeconds(e);var r=this._fromType(t[0])*i;this.setValueAtTime(this._toType(r),e);for(var o=n/(t.length-1),s=1;s<t.length;s++){var a=this._fromType(t[s])*i;this.linearRampToValueAtTime(this._toType(a),e+s*o)}return this}},{key:"cancelScheduledValues",value:function(t){var e=this.toSeconds(t);return hr(isFinite(e),"Invalid argument to cancelScheduledValues: ".concat(JSON.stringify(t))),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}},{key:"cancelAndHoldAtTime",value:function(t){var e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));hr(isFinite(e),"Invalid argument to cancelAndHoldAtTime: ".concat(JSON.stringify(t))),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);var i=this._events.get(e),r=this._events.getAfter(e);return i&&Wr(i.time,e)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),"linearRampToValueAtTime"===r.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===r.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}},{key:"rampTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2?arguments[2]:void 0;return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}},{key:"apply",value:function(t){var e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);var n=this._events.get(e);if(n&&"setTargetAtTime"===n.type)for(var i=this._events.getAfter(n.time),r=i?i.time:e+2,o=(r-e)/10,s=e;s<r;s+=o)t.linearRampToValueAtTime(this.getValueAtTime(s),s);return this._events.forEachAfter(this.context.currentTime,(function(e){"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}},{key:"setParam",value:function(t){hr(this._swappable,"The Param must be assigned as 'swappable' in the constructor");var e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._events.dispose(),this}},{key:"defaultValue",get:function(){return this._toType(this._param.defaultValue)}},{key:"_exponentialApproach",value:function(t,e,n,i,r){return n+(e-n)*Math.exp(-(r-t)/i)}},{key:"_linearInterpolate",value:function(t,e,n,i,r){return e+(r-t)/(n-t)*(i-e)}},{key:"_exponentialInterpolate",value:function(t,e,n,i,r){return e*Math.pow(i/e,(r-t)/(n-t))}}],[{key:"getDefaults",value:function(){return Object.assign(Do.getDefaults(),{convert:!0,units:"number"})}}]),n}(Do),Eo=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments))))._internalChannels=[],m(t)}return a(n,[{key:"numberOfInputs",get:function(){return ir(this.input)?Dr(this.input)||this.input instanceof Co?1:this.input.numberOfInputs:0}},{key:"numberOfOutputs",get:function(){return ir(this.output)?this.output.numberOfOutputs:0}},{key:"_isAudioNode",value:function(t){return ir(t)&&(t instanceof n||Or(t))}},{key:"_getInternalNodes",value:function(){var t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}},{key:"_setChannelProperties",value:function(t){this._getInternalNodes().forEach((function(e){e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}},{key:"_getChannelProperties",value:function(){var t=this._getInternalNodes();hr(t.length>0,"ToneAudioNode does not have any internal nodes");var e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}},{key:"channelCount",get:function(){return this._getChannelProperties().channelCount},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}},{key:"channelCountMode",get:function(){return this._getChannelProperties().channelCountMode},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}},{key:"channelInterpretation",get:function(){return this._getChannelProperties().channelInterpretation},set:function(t){var e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}},{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return qo(this,t,e,n),this}},{key:"toDestination",value:function(){return this.connect(this.context.destination),this}},{key:"toMaster",value:function(){return xr("toMaster() has been renamed toDestination()"),this.toDestination()}},{key:"disconnect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ro(this,t,e,n),this}},{key:"chain",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Mo.apply(void 0,[this].concat(k(e))),this}},{key:"fan",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=this;return e.forEach((function(t){return i.connect(t)})),this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),ir(this.input)&&(this.input instanceof n?this.input.dispose():Or(this.input)&&this.input.disconnect()),ir(this.output)&&(this.output instanceof n?this.output.dispose():Or(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}]),n}(Do);function Mo(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e.shift();e.reduce((function(t,e){return t instanceof Eo?t.connect(e):Or(t)&&qo(t,e),e}),i)}function qo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(hr(ir(t),"Cannot connect from undefined node"),hr(ir(e),"Cannot connect to undefined node"),(e instanceof Eo||Or(e))&&hr(e.numberOfInputs>0,"Cannot connect to node with no inputs"),hr(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Eo||e instanceof Co;)ir(e.input)&&(e=e.input);for(;t instanceof Eo;)ir(t.output)&&(t=t.output);Dr(e)?t.connect(e,n):t.connect(e,n,i)}function Ro(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(ir(e))for(;e instanceof Eo;)e=e.input;for(;!Or(t);)ir(t.output)&&(t=t.output);Dr(e)?t.disconnect(e,n):Or(e)?t.disconnect(e,n,i):t.disconnect()}function Vo(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=e.pop();ir(i)&&e.forEach((function(t){return qo(t,i)}))}var Fo=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["gain","units"]))).name="Gain",t._gainNode=t.context.createGain(),t.input=t._gainNode,t.output=t._gainNode;var r=Vr(i.getDefaults(),arguments,["gain","units"]);return t.gain=new Co({context:t.context,convert:r.convert,param:t._gainNode.gain,units:r.units,value:r.gain,minValue:r.minValue,maxValue:r.maxValue}),$r(n(t),"gain"),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._gainNode.disconnect(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{convert:!0,gain:1,units:"gain"})}}]),i}(Eo),Io=function(t){"use strict";d(n,t);var e=x(n);function n(t){var i;return o(this,n),(i=e.call(this,t)).onended=to,i._startTime=-1,i._stopTime=-1,i._timeout=-1,i.output=new Fo({context:i.context,gain:0}),i._gainNode=i.output,i.getStateAtTime=function(t){var e=i.toSeconds(t);return-1!==i._startTime&&e>=i._startTime&&(-1===i._stopTime||e<=i._stopTime)?"started":"stopped"},i._fadeIn=t.fadeIn,i._fadeOut=t.fadeOut,i._curve=t.curve,i.onended=t.onended,m(i)}return a(n,[{key:"_startGain",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;hr(-1===this._startTime,"Source cannot be started more than once");var n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}},{key:"stop",value:function(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}},{key:"_stopGain",value:function(t){var e=this;hr(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();var n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+n,this._stopTime=Math.max(this._stopTime,this.context.currentTime),n>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,n,t):this._gainNode.gain.targetRampTo(0,n,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((function(){var t="exponential"===e._curve?2*n:0;e._stopSource(e.now()+t),e._onended()}),this._stopTime-this.context.currentTime),this}},{key:"_onended",value:function(){if(this.onended!==to&&(this.onended(this),this.onended=to,!this.context.isOffline)){var t=this,e=function(){return t.dispose()};void 0!==window.requestIdleCallback?window.requestIdleCallback(e):setTimeout(e,1e3)}}},{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"cancelStop",value:function(){return this.log("cancelStop"),hr(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._gainNode.dispose(),this.onended=to,this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:to})}}]),n}(Eo),Po=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["offset"]))).name="ToneConstantSource",t._source=t.context.createConstantSource();var i=Vr(n.getDefaults(),arguments,["offset"]);return qo(t._source,t._gainNode),t.offset=new Co({context:t.context,convert:i.convert,param:t._source.offset,units:i.units,value:i.offset,minValue:i.minValue,maxValue:i.maxValue}),m(t)}return a(n,[{key:"start",value:function(t){var e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}},{key:"_stopSource",value:function(t){this._source.stop(t)}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Io.getDefaults(),{convert:!0,offset:1,units:"number"})}}]),n}(Io),jo=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["value","units"]))).name="Signal",t.override=!0;var i=Vr(n.getDefaults(),arguments,["value","units"]);return t.output=t._constantSource=new Po({context:t.context,convert:i.convert,offset:i.value,units:i.units,minValue:i.minValue,maxValue:i.maxValue}),t._constantSource.start(0),t.input=t._param=t._constantSource.offset,m(t)}return a(n,[{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lo(this,t,e,n),this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._param.dispose(),this._constantSource.dispose(),this}},{key:"setValueAtTime",value:function(t,e){return this._param.setValueAtTime(t,e),this}},{key:"getValueAtTime",value:function(t){return this._param.getValueAtTime(t)}},{key:"setRampPoint",value:function(t){return this._param.setRampPoint(t),this}},{key:"linearRampToValueAtTime",value:function(t,e){return this._param.linearRampToValueAtTime(t,e),this}},{key:"exponentialRampToValueAtTime",value:function(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}},{key:"exponentialRampTo",value:function(t,e,n){return this._param.exponentialRampTo(t,e,n),this}},{key:"linearRampTo",value:function(t,e,n){return this._param.linearRampTo(t,e,n),this}},{key:"targetRampTo",value:function(t,e,n){return this._param.targetRampTo(t,e,n),this}},{key:"exponentialApproachValueAtTime",value:function(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}},{key:"setTargetAtTime",value:function(t,e,n){return this._param.setTargetAtTime(t,e,n),this}},{key:"setValueCurveAtTime",value:function(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}},{key:"cancelScheduledValues",value:function(t){return this._param.cancelScheduledValues(t),this}},{key:"cancelAndHoldAtTime",value:function(t){return this._param.cancelAndHoldAtTime(t),this}},{key:"rampTo",value:function(t,e,n){return this._param.rampTo(t,e,n),this}},{key:"value",get:function(){return this._param.value},set:function(t){this._param.value=t}},{key:"convert",get:function(){return this._param.convert},set:function(t){this._param.convert=t}},{key:"units",get:function(){return this._param.units}},{key:"overridden",get:function(){return this._param.overridden},set:function(t){this._param.overridden=t}},{key:"maxValue",get:function(){return this._param.maxValue}},{key:"minValue",get:function(){return this._param.minValue}},{key:"apply",value:function(t){return this._param.apply(t),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{convert:!0,units:"number",value:0})}}]),n}(Eo);function Lo(t,e,n,i){(e instanceof Co||Dr(e)||e instanceof jo&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof jo&&(e.overridden=!0)),qo(t,e,n,i)}var No=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["value"]))).name="TickParam",t._events=new Gr(1/0),t._multiplier=1;var i=Vr(n.getDefaults(),arguments,["value"]);return t._multiplier=i.multiplier,t._events.cancel(0),t._events.add({ticks:0,time:0,type:"setValueAtTime",value:t._fromType(i.value)}),t.setValueAtTime(i.value,0),m(t)}return a(n,[{key:"setTargetAtTime",value:function(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);for(var i=this._fromType(t),r=this._events.get(e),o=Math.round(Math.max(1/n,1)),s=0;s<=o;s++){var a=n*s+e,u=this._exponentialApproach(r.time,r.value,i,n,a);this.linearRampToValueAtTime(this._toType(u),a)}return this}},{key:"setValueAtTime",value:function(t,e){var i=this.toSeconds(e);f(l(n.prototype),"setValueAtTime",this).call(this,t,e);var r=this._events.get(i),o=this._events.previousEvent(r),s=this._getTicksUntilEvent(o,i);return r.ticks=Math.max(s,0),this}},{key:"linearRampToValueAtTime",value:function(t,e){var i=this.toSeconds(e);f(l(n.prototype),"linearRampToValueAtTime",this).call(this,t,e);var r=this._events.get(i),o=this._events.previousEvent(r),s=this._getTicksUntilEvent(o,i);return r.ticks=Math.max(s,0),this}},{key:"exponentialRampToValueAtTime",value:function(t,e){e=this.toSeconds(e);for(var n=this._fromType(t),i=this._events.get(e),r=Math.round(Math.max(10*(e-i.time),1)),o=(e-i.time)/r,s=0;s<=r;s++){var a=o*s+i.time,u=this._exponentialInterpolate(i.time,i.value,e,n,a);this.linearRampToValueAtTime(this._toType(u),a)}return this}},{key:"_getTicksUntilEvent",value:function(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(nr(t.ticks)){var n=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(n,t.time)}var i=this._fromType(this.getValueAtTime(t.time)),r=this._fromType(this.getValueAtTime(e)),o=this._events.get(e);return o&&o.time===e&&"setValueAtTime"===o.type&&(r=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(i+r)+t.ticks}},{key:"getTicksAtTime",value:function(t){var e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}},{key:"getDurationOfTicks",value:function(t,e){var n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}},{key:"getTimeOfTick",value:function(t){var e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){var i=this._fromType(this.getValueAtTime(e.time)),r=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),o=Math.sqrt(Math.pow(i,2)-2*r*(e.ticks-t)),s=(-i+o)/r;return(s>0?s:(-i-o)/r)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}},{key:"ticksToTime",value:function(t,e){return this.getDurationOfTicks(t,e)}},{key:"timeToTicks",value:function(t,e){var n=this.toSeconds(e),i=this.toSeconds(t),r=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-r}},{key:"_fromType",value:function(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):f(l(n.prototype),"_fromType",this).call(this,t)}},{key:"_toType",value:function(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:f(l(n.prototype),"_toType",this).call(this,t)}},{key:"multiplier",get:function(){return this._multiplier},set:function(t){var e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}],[{key:"getDefaults",value:function(){return Object.assign(Co.getDefaults(),{multiplier:1,units:"hertz",value:1})}}]),n}(Co),zo=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["value"]))).name="TickSignal";var i=Vr(n.getDefaults(),arguments,["value"]);return t.input=t._param=new No({context:t.context,convert:i.convert,multiplier:i.multiplier,param:t._constantSource.offset,units:i.units,value:i.value}),m(t)}return a(n,[{key:"ticksToTime",value:function(t,e){return this._param.ticksToTime(t,e)}},{key:"timeToTicks",value:function(t,e){return this._param.timeToTicks(t,e)}},{key:"getTimeOfTick",value:function(t){return this._param.getTimeOfTick(t)}},{key:"getDurationOfTicks",value:function(t,e){return this._param.getDurationOfTicks(t,e)}},{key:"getTicksAtTime",value:function(t){return this._param.getTicksAtTime(t)}},{key:"multiplier",get:function(){return this._param.multiplier},set:function(t){this._param.multiplier=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._param.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(jo.getDefaults(),{multiplier:1,units:"hertz",value:1})}}]),n}(jo),Wo=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency"]))).name="TickSource",t._state=new Oo,t._tickOffset=new Gr,t._ticksAtTime=new Gr,t._secondsAtTime=new Gr;var r=Vr(i.getDefaults(),arguments,["frequency"]);return t.frequency=new zo({context:t.context,units:r.units,value:r.frequency}),$r(n(t),"frequency"),t._state.setStateAtTime("stopped",0),t.setTicksAtTime(0,0),m(t)}return a(i,[{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"start",value:function(t,e){var n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),ir(e)&&this.setTicksAtTime(e,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}},{key:"stop",value:function(t){var e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){var n=this._state.get(e);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}},{key:"pause",value:function(t){var e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e)),this}},{key:"cancel",value:function(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}},{key:"getTicksAtTime",value:function(t){var e=this,n=this.toSeconds(t),i=this._state.getLastState("stopped",n),r=this._ticksAtTime.get(n),o={state:"paused",time:n};this._state.add(o);var s=r||i,a=r?r.ticks:0,u=null;return this._state.forEachBetween(s.time,n+this.sampleTime,(function(t){var n=s.time,i=e._tickOffset.get(t.time);i&&i.time>=s.time&&(a=i.ticks,n=i.time),"started"===s.state&&"started"!==t.state&&(a+=e.frequency.getTicksAtTime(t.time)-e.frequency.getTicksAtTime(n),t.time!=o.time&&(u={state:t.state,time:t.time,ticks:a})),s=t})),this._state.remove(o),u&&this._ticksAtTime.add(u),a}},{key:"ticks",get:function(){return this.getTicksAtTime(this.now())},set:function(t){this.setTicksAtTime(t,this.now())}},{key:"seconds",get:function(){return this.getSecondsAtTime(this.now())},set:function(t){var e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}},{key:"getSecondsAtTime",value:function(t){var e=this;t=this.toSeconds(t);var n=this._state.getLastState("stopped",t),i={state:"paused",time:t};this._state.add(i);var r=this._secondsAtTime.get(t),o=r||n,s=r?r.seconds:0,a=null;return this._state.forEachBetween(o.time,t+this.sampleTime,(function(t){var n=o.time,r=e._tickOffset.get(t.time);r&&r.time>=o.time&&(s=r.seconds,n=r.time),"started"===o.state&&"started"!==t.state&&(s+=t.time-n,t.time!=i.time&&(a={state:t.state,time:t.time,seconds:s})),o=t})),this._state.remove(i),a&&this._secondsAtTime.add(a),s}},{key:"setTicksAtTime",value:function(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}},{key:"getStateAtTime",value:function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}},{key:"getTimeOfTick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now(),n=this._tickOffset.get(e),i=this._state.get(e),r=Math.max(n.time,i.time),o=this.frequency.getTicksAtTime(r)+t-n.ticks;return this.frequency.getTimeOfTick(o)}},{key:"forEachTickBetween",value:function(t,e,n){var i=this,r=this._state.get(t);this._state.forEachBetween(t,e,(function(e){r&&"started"===r.state&&"started"!==e.state&&i.forEachTickBetween(Math.max(r.time,t),e.time-i.sampleTime,n),r=e}));var o=null;if(r&&"started"===r.state){var s=Math.max(r.time,t),a=this.frequency.getTicksAtTime(s),u=a-this.frequency.getTicksAtTime(r.time),c=Math.ceil(u)-u;c=Wr(c,1)?0:c;for(var l=this.frequency.getTimeOfTick(a+c);l<e;){try{n(l,Math.round(this.getTicksAtTime(l)))}catch(t){o=t;break}l+=this.frequency.getDurationOfTicks(1,l)}}if(o)throw o;return this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign({frequency:1,units:"hertz"},Do.getDefaults())}}]),i}(Do),Bo=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["callback","frequency"]))).name="Clock",t.callback=to,t._lastUpdate=0,t._state=new Oo("stopped"),t._boundLoop=t._loop.bind(n(t));var r=Vr(i.getDefaults(),arguments,["callback","frequency"]);return t.callback=r.callback,t._tickSource=new Wo({context:t.context,frequency:r.frequency,units:r.units}),t._lastUpdate=0,t.frequency=t._tickSource.frequency,$r(n(t),"frequency"),t._state.setStateAtTime("stopped",0),t.context.on("tick",t._boundLoop),m(t)}return a(i,[{key:"state",get:function(){return this._state.getValueAtTime(this.now())}},{key:"start",value:function(t,e){pr(this.context);var n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}},{key:"stop",value:function(t){var e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}},{key:"pause",value:function(t){var e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}},{key:"ticks",get:function(){return Math.ceil(this.getTicksAtTime(this.now()))},set:function(t){this._tickSource.ticks=t}},{key:"seconds",get:function(){return this._tickSource.seconds},set:function(t){this._tickSource.seconds=t}},{key:"getSecondsAtTime",value:function(t){return this._tickSource.getSecondsAtTime(t)}},{key:"setTicksAtTime",value:function(t,e){return this._tickSource.setTicksAtTime(t,e),this}},{key:"getTimeOfTick",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();return this._tickSource.getTimeOfTick(t,e)}},{key:"getTicksAtTime",value:function(t){return this._tickSource.getTicksAtTime(t)}},{key:"nextTickTime",value:function(t,e){var n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}},{key:"_loop",value:function(){var t=this,e=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",e,n),e!==n&&(this._state.forEachBetween(e,n,(function(e){switch(e.state){case"started":var n=t._tickSource.getTicksAtTime(e.time);t.emit("start",e.time,n);break;case"stopped":0!==e.time&&t.emit("stop",e.time);break;case"paused":t.emit("pause",e.time)}})),this._tickSource.forEachTickBetween(e,n,(function(e,n){t.callback(e,n)})))}},{key:"getStateAtTime",value:function(t){var e=this.toSeconds(t);return this._state.getValueAtTime(e)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Do.getDefaults(),{callback:to,frequency:1,units:"hertz"})}}]),i}(Do);Qr.mixin(Bo);var Go=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["delayTime","maxDelay"]))).name="Delay";var r=Vr(i.getDefaults(),arguments,["delayTime","maxDelay"]),s=t.toSeconds(r.maxDelay);return t._maxDelay=Math.max(s,t.toSeconds(r.delayTime)),t._delayNode=t.input=t.output=t.context.createDelay(s),t.delayTime=new Co({context:t.context,param:t._delayNode.delayTime,units:"time",value:r.delayTime,minValue:0,maxValue:t.maxDelay}),$r(n(t),"delayTime"),m(t)}return a(i,[{key:"maxDelay",get:function(){return this._maxDelay}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._delayNode.disconnect(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{delayTime:0,maxDelay:1})}}]),i}(Eo);function Uo(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:oo().sampleRate;return Sr(this,void 0,void 0,t(T).mark((function o(){var s,a,u,c;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=oo(),so(a=new no(i,n,r)),t.next=4,e(a);case 4:return u=a.render(),so(s),t.next=8,u;case 8:return c=t.sent,t.abrupt("return",new eo(c));case 10:case"end":return t.stop()}}),o)})))}var Yo=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this)).name="ToneAudioBuffers",t._buffers=new Map,t._loadingCount=0;var r=Vr(i.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");return t.baseUrl=r.baseUrl,Object.keys(r.urls).forEach((function(e){t._loadingCount++;var i=r.urls[e];t.add(e,i,t._bufferLoaded.bind(n(t),r.onload),r.onerror)})),m(t)}return a(i,[{key:"has",value:function(t){return this._buffers.has(t.toString())}},{key:"get",value:function(t){return hr(this.has(t),"ToneAudioBuffers has no buffer named: ".concat(t)),this._buffers.get(t.toString())}},{key:"_bufferLoaded",value:function(t){this._loadingCount--,0===this._loadingCount&&t&&t()}},{key:"loaded",get:function(){return Array.from(this._buffers).every((function(t){var e=g(t);return e[0],e[1].loaded}))}},{key:"add",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:to,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:to;return cr(e)?(this.baseUrl&&"data:audio/"===e.trim().substring(0,11).toLowerCase()&&(this.baseUrl=""),this._buffers.set(t.toString(),new eo(this.baseUrl+e,n,i))):this._buffers.set(t.toString(),new eo(e,n,i)),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._buffers.forEach((function(t){return t.dispose()})),this._buffers.clear(),this}}],[{key:"getDefaults",value:function(){return{baseUrl:"",onerror:to,onload:to,urls:{}}}}]),i}(Pr),Zo=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="MidiClass",t.defaultUnits="midi",m(t)}return a(n,[{key:"_frequencyToUnits",value:function(t){return vo(f(l(n.prototype),"_frequencyToUnits",this).call(this,t))}},{key:"_ticksToUnits",value:function(t){return vo(f(l(n.prototype),"_ticksToUnits",this).call(this,t))}},{key:"_beatsToUnits",value:function(t){return vo(f(l(n.prototype),"_beatsToUnits",this).call(this,t))}},{key:"_secondsToUnits",value:function(t){return vo(f(l(n.prototype),"_secondsToUnits",this).call(this,t))}},{key:"toMidi",value:function(){return this.valueOf()}},{key:"toFrequency",value:function(){return mo(this.toMidi())}},{key:"transpose",value:function(t){return new n(this.context,this.toMidi()+t)}}]),n}(xo);function Xo(t,e){return new Zo(oo(),t,e)}var Qo=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Ticks",t.defaultUnits="i",m(t)}return a(n,[{key:"_now",value:function(){return this.context.transport.ticks}},{key:"_beatsToUnits",value:function(t){return this._getPPQ()*t}},{key:"_secondsToUnits",value:function(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}},{key:"_ticksToUnits",value:function(t){return t}},{key:"toTicks",value:function(){return this.valueOf()}},{key:"toSeconds",value:function(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}]),n}(So);function Ho(t,e){return new Qo(oo(),t,e)}var Jo=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;return o(this,i),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Draw",t.expiration=.25,t.anticipation=.008,t._events=new Gr,t._boundDrawLoop=t._drawLoop.bind(n(t)),t._animationFrame=-1,m(t)}return a(i,[{key:"schedule",value:function(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}},{key:"cancel",value:function(t){return this._events.cancel(this.toSeconds(t)),this}},{key:"_drawLoop",value:function(){for(var t=this.context.currentTime;this._events.length&&this._events.peek().time-this.anticipation<=t;){var e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}]),i}(Do);Yr((function(t){t.draw=new Jo({context:t})})),Xr((function(t){t.draw.dispose()}));var $o=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="IntervalTimeline",t._root=null,t._length=0,m(t)}return a(n,[{key:"add",value:function(t){hr(ir(t.time),"Events must have a time property"),hr(ir(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();var e=new Ko(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}},{key:"remove",value:function(t){if(null!==this._root){var e=[];this._root.search(t.time,e);var n=!0,i=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var a=o.value;if(a.event===t){this._removeNode(a),this._length--;break}}}catch(t){i=!0,r=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}}return this}},{key:"length",get:function(){return this._length}},{key:"cancel",value:function(t){var e=this;return this.forEachFrom(t,(function(t){return e.remove(t)})),this}},{key:"_setRoot",value:function(t){this._root=t,null!==this._root&&(this._root.parent=null)}},{key:"_replaceNodeInParent",value:function(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}},{key:"_removeNode",value:function(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{var e,n=null;if(t.getBalance()>0)if(null===t.left.right)(e=t.left).right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)(e=t.right).left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}},{key:"_rotateLeft",value:function(t){var e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}},{key:"_rotateRight",value:function(t){var e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}},{key:"_rebalance",value:function(t){var e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}},{key:"get",value:function(t){if(null!==this._root){var e=[];if(this._root.search(t,e),e.length>0){for(var n=e[0],i=1;i<e.length;i++)e[i].low>n.low&&(n=e[i]);return n.event}}return null}},{key:"forEach",value:function(t){if(null!==this._root){var e=[];this._root.traverse((function(t){return e.push(t)})),e.forEach((function(e){e.event&&t(e.event)}))}return this}},{key:"forEachAtTime",value:function(t,e){if(null!==this._root){var n=[];this._root.search(t,n),n.forEach((function(t){t.event&&e(t.event)}))}return this}},{key:"forEachFrom",value:function(t,e){if(null!==this._root){var n=[];this._root.searchAfter(t,n),n.forEach((function(t){t.event&&e(t.event)}))}return this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),null!==this._root&&this._root.traverse((function(t){return t.dispose()})),this._root=null,this}}]),n}(Pr),Ko=function(){"use strict";function t(e,n,i){o(this,t),this._left=null,this._right=null,this.parent=null,this.height=0,this.event=i,this.low=e,this.high=n,this.max=this.high}return a(t,[{key:"insert",value:function(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}},{key:"search",value:function(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}},{key:"searchAfter",value:function(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}},{key:"traverse",value:function(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}},{key:"updateHeight",value:function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}},{key:"updateMax",value:function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}},{key:"getBalance",value:function(){var t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}},{key:"isLeftChild",value:function(){return null!==this.parent&&this.parent.left===this}},{key:"left",get:function(){return this._left},set:function(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}},{key:"right",get:function(){return this._right},set:function(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}},{key:"dispose",value:function(){this.parent=null,this._left=null,this._right=null,this.event=null}}]),t}(),es=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["volume"]))).name="Volume";var r=Vr(i.getDefaults(),arguments,["volume"]);return t.input=t.output=new Fo({context:t.context,gain:r.volume,units:"decibels"}),t.volume=t.output.gain,$r(n(t),"volume"),t._unmutedVolume=r.volume,t.mute=r.mute,m(t)}return a(i,[{key:"mute",get:function(){return this.volume.value===-1/0},set:function(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.input.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{mute:!1,volume:0})}}]),i}(Eo),rs=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="Destination",t.input=new es({context:t.context}),t.output=new Fo({context:t.context}),t.volume=t.input.volume;var i=Vr(n.getDefaults(),arguments);return Mo(t.input,t.output,t.context.rawContext.destination),t.mute=i.mute,t._internalChannels=[t.input,t.context.rawContext.destination,t.output],m(t)}return a(n,[{key:"mute",get:function(){return this.input.mute},set:function(t){this.input.mute=t}},{key:"chain",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.input.disconnect(),e.unshift(this.input),e.push(this.output),Mo.apply(void 0,k(e)),this}},{key:"maxChannelCount",get:function(){return this.context.rawContext.destination.maxChannelCount}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{mute:!1,volume:0})}}]),n}(Eo);Yr((function(t){t.destination=new rs({context:t})})),Xr((function(t){t.destination.dispose()}));var ss=function(t){"use strict";d(n,t);var e=x(n);function n(t){var i;return o(this,n),(i=e.call(this)).name="TimelineValue",i._timeline=new Gr({memory:10}),i._initialValue=t,m(i)}return a(n,[{key:"set",value:function(t,e){return this._timeline.add({value:t,time:e}),this}},{key:"get",value:function(t){var e=this._timeline.get(t);return e?e.value:this._initialValue}}]),n}(Pr),cs=function(){"use strict";function t(e,n){o(this,t),this.id=t._eventId++,this._remainderTime=0;var i=Object.assign(t.getDefaults(),n);this.transport=e,this.callback=i.callback,this._once=i.once,this.time=Math.floor(i.time),this._remainderTime=i.time-this.time}return a(t,[{key:"floatTime",get:function(){return this.time+this._remainderTime}},{key:"invoke",value:function(t){if(this.callback){var e=this.transport.bpm.getDurationOfTicks(1,t);this.callback(t+this._remainderTime*e),this._once&&this.transport.clear(this.id)}}},{key:"dispose",value:function(){return this.callback=void 0,this}}],[{key:"getDefaults",value:function(){return{callback:to,once:!1,time:0}}}]),t}();cs._eventId=0;var ls=function(t){"use strict";d(i,t);var e=x(i);function i(t,r){var s;o(this,i),(s=e.call(this,t,r))._currentId=-1,s._nextId=-1,s._nextTick=s.time,s._boundRestart=s._restart.bind(n(s));var a=Object.assign(i.getDefaults(),r);return s.duration=a.duration,s._interval=a.interval,s._nextTick=a.time,s.transport.on("start",s._boundRestart),s.transport.on("loopStart",s._boundRestart),s.transport.on("ticks",s._boundRestart),s.context=s.transport.context,s._restart(),m(s)}return a(i,[{key:"invoke",value:function(t){this._createEvents(t),f(l(i.prototype),"invoke",this).call(this,t)}},{key:"_createEvent",value:function(){return zr(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Qo(this.context,this._nextTick).toSeconds()):-1}},{key:"_createEvents",value:function(t){zr(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Qo(this.context,this._nextTick).toSeconds()))}},{key:"_restart",value:function(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;var e=this.transport.getTicksAtTime(t);Lr(e,this.time)&&(this._nextTick=this.floatTime+Math.ceil((e-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}],[{key:"getDefaults",value:function(){return Object.assign({},cs.getDefaults(),{duration:1/0,interval:1,once:!1})}}]),i}(cs),fs=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments))).name="Transport",t._loop=new ss(!1),t._loopStart=0,t._loopEnd=0,t._scheduledEvents={},t._timeline=new Gr,t._repeatedEvents=new $o,t._syncedSignals=[],t._swingAmount=0;var r=Vr(i.getDefaults(),arguments);return t._ppq=r.ppq,t._clock=new Bo({callback:t._processTick.bind(n(t)),context:t.context,frequency:0,units:"bpm"}),t._bindClockEvents(),t.bpm=t._clock.frequency,t._clock.frequency.multiplier=r.ppq,t.bpm.setValueAtTime(r.bpm,0),$r(n(t),"bpm"),t._timeSignature=r.timeSignature,t._swingTicks=r.ppq/2,m(t)}return a(i,[{key:"_processTick",value:function(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){var n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new Qo(this.context,2*this._swingTicks/3).toSeconds()*i}yr(!0),this._timeline.forEachAtTime(e,(function(e){return e.invoke(t)})),yr(!1)}},{key:"schedule",value:function(t,e){var n=new cs(this,{callback:t,time:new So(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}},{key:"scheduleRepeat",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,r=new ls(this,{callback:t,duration:new go(this.context,i).toTicks(),interval:new go(this.context,e).toTicks(),time:new So(this.context,n).toTicks()});return this._addEvent(r,this._repeatedEvents)}},{key:"scheduleOnce",value:function(t,e){var n=new cs(this,{callback:t,once:!0,time:new So(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}},{key:"clear",value:function(t){if(this._scheduledEvents.hasOwnProperty(t)){var e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}},{key:"_addEvent",value:function(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}},{key:"cancel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this,n=this.toTicks(t);return this._timeline.forEachFrom(n,(function(t){return e.clear(t.id)})),this._repeatedEvents.forEachFrom(n,(function(t){return e.clear(t.id)})),this}},{key:"_bindClockEvents",value:function(){var t=this;this._clock.on("start",(function(e,n){n=new Qo(t.context,n).toSeconds(),t.emit("start",e,n)})),this._clock.on("stop",(function(e){t.emit("stop",e)})),this._clock.on("pause",(function(e){t.emit("pause",e)}))}},{key:"state",get:function(){return this._clock.getStateAtTime(this.now())}},{key:"start",value:function(t,e){var n;return this.context.resume(),ir(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}},{key:"stop",value:function(t){return this._clock.stop(t),this}},{key:"pause",value:function(t){return this._clock.pause(t),this}},{key:"toggle",value:function(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}},{key:"timeSignature",get:function(){return this._timeSignature},set:function(t){ur(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}},{key:"loopStart",get:function(){return new go(this.context,this._loopStart,"i").toSeconds()},set:function(t){this._loopStart=this.toTicks(t)}},{key:"loopEnd",get:function(){return new go(this.context,this._loopEnd,"i").toSeconds()},set:function(t){this._loopEnd=this.toTicks(t)}},{key:"loop",get:function(){return this._loop.get(this.now())},set:function(t){this._loop.set(t,this.now())}},{key:"setLoopPoints",value:function(t,e){return this.loopStart=t,this.loopEnd=e,this}},{key:"swing",get:function(){return this._swingAmount},set:function(t){this._swingAmount=t}},{key:"swingSubdivision",get:function(){return new Qo(this.context,this._swingTicks).toNotation()},set:function(t){this._swingTicks=this.toTicks(t)}},{key:"position",get:function(){var t=this.now(),e=this._clock.getTicksAtTime(t);return new Qo(this.context,e).toBarsBeatsSixteenths()},set:function(t){var e=this.toTicks(t);this.ticks=e}},{key:"seconds",get:function(){return this._clock.seconds},set:function(t){var e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}},{key:"progress",get:function(){if(this.loop){var t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}},{key:"ticks",get:function(){return this._clock.ticks},set:function(t){if(this._clock.ticks!==t){var e=this.now();if("started"===this.state){var n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this.emit("ticks",e),this._clock.setTicksAtTime(t,e)}}},{key:"getTicksAtTime",value:function(t){return this._clock.getTicksAtTime(t)}},{key:"getSecondsAtTime",value:function(t){return this._clock.getSecondsAtTime(t)}},{key:"PPQ",get:function(){return this._clock.frequency.multiplier},set:function(t){this._clock.frequency.multiplier=t}},{key:"nextSubdivision",value:function(t){if(t=this.toTicks(t),"started"!==this.state)return 0;var e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}},{key:"syncSignal",value:function(t,e){if(!e){var n=this.now();if(0!==t.getValueAtTime(n)){var i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}var r=new Fo(e);return this.bpm.connect(r),r.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:r,signal:t}),t.value=0,this}},{key:"unsyncSignal",value:function(t){for(var e=this._syncedSignals.length-1;e>=0;e--){var n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._clock.dispose(),Kr(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Do.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}}]),i}(Do);Qr.mixin(fs),Yr((function(t){t.transport=new fs({context:t})})),Xr((function(t){t.transport.dispose()}));var ps=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;return o(this,i),(r=e.call(this,t)).input=void 0,r._state=new Oo("stopped"),r._synced=!1,r._scheduled=[],r._syncedStart=to,r._syncedStop=to,r._state.memory=100,r._state.increasing=!0,r._volume=r.output=new es({context:r.context,mute:t.mute,volume:t.volume}),r.volume=r._volume.volume,$r(n(r),"volume"),r.onstop=t.onstop,m(r)}return a(i,[{key:"state",get:function(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}},{key:"mute",get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}},{key:"_clampToCurrentTime",value:function(t){return this._synced?t:Math.max(t,this.context.currentTime)}},{key:"start",value:function(t,e,n){var i=nr(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){var r=this,o=this._state.get(i);o&&(o.offset=this.toSeconds(Fr(e,0)),o.duration=n?this.toSeconds(n):void 0);var s=this.context.transport.schedule((function(t){r._start(t,e,n)}),i);this._scheduled.push(s),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else pr(this.context),this._start(i,e,n);else hr(Lr(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}},{key:"stop",value:function(t){var e=nr(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||ir(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){var n=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(n)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}},{key:"restart",value:function(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}},{key:"sync",value:function(){var t=this;return this._synced||(this._synced=!0,this._syncedStart=function(e,n){if(Lr(n,0)){var i=t._state.get(n);if(i&&"started"===i.state&&i.time!==n){var r,o=n-t.toSeconds(i.time);i.duration&&(r=t.toSeconds(i.duration)-o),t._start(e,t.toSeconds(i.offset)+o,r)}}},this._syncedStop=function(e){var n=t.context.transport.getSecondsAtTime(Math.max(e-t.sampleTime,0));"started"===t._state.getValueAtTime(n)&&t._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}},{key:"unsync",value:function(){var t=this;return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((function(e){return t.context.transport.clear(e)})),this._scheduled=[],this._state.cancel(0),this._stop(0),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.onstop=to,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{mute:!1,onstop:to,volume:0})}}]),i}(Eo),ys=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["url","onload"]))).name="ToneBufferSource",t._source=t.context.createBufferSource(),t._internalChannels=[t._source],t._sourceStarted=!1,t._sourceStopped=!1;var i=Vr(n.getDefaults(),arguments,["url","onload"]);return qo(t._source,t._gainNode),t._source.onended=function(){return t._stopSource()},t.playbackRate=new Co({context:t.context,param:t._source.playbackRate,units:"positive",value:i.playbackRate}),t.loop=i.loop,t.loopStart=i.loopStart,t.loopEnd=i.loopEnd,t._buffer=new eo(i.url,i.onload,i.onerror),t._internalChannels.push(t._source),m(t)}return a(n,[{key:"fadeIn",get:function(){return this._fadeIn},set:function(t){this._fadeIn=t}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(t){this._fadeOut=t}},{key:"curve",get:function(){return this._curve},set:function(t){this._curve=t}},{key:"start",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;hr(this.buffer.loaded,"buffer is either not set or not loaded");var r=this.toSeconds(t);this._startGain(r,i),e=this.loop?Fr(e,this.loopStart):Fr(e,0);var o=Math.max(this.toSeconds(e),0);if(this.loop){var s=this.toSeconds(this.loopEnd)||this.buffer.duration,a=this.toSeconds(this.loopStart),u=s-a;Nr(o,s)&&(o=(o-a)%u+a),Wr(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,zr(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,o)),ir(n)){var c=this.toSeconds(n);c=Math.max(c,0),this.stop(r+c)}return this}},{key:"_stopSource",value:function(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}},{key:"loopStart",get:function(){return this._source.loopStart},set:function(t){this._source.loopStart=this.toSeconds(t)}},{key:"loopEnd",get:function(){return this._source.loopEnd},set:function(t){this._source.loopEnd=this.toSeconds(t)}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer.set(t)}},{key:"loop",get:function(){return this._source.loop},set:function(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Io.getDefaults(),{url:new eo,loop:!1,loopEnd:0,loopStart:0,onload:to,onerror:to,playbackRate:1})}}]),n}(Io),ms=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["type"]))).name="Noise",t._source=null;var i=Vr(n.getDefaults(),arguments,["type"]);return t._playbackRate=i.playbackRate,t.type=i.type,t._fadeIn=i.fadeIn,t._fadeOut=i.fadeOut,m(t)}return a(n,[{key:"type",get:function(){return this._type},set:function(t){if(hr(t in ws,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){var e=this.now();this._stop(e),this._start(e)}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}},{key:"_start",value:function(t){var e=this,n=ws[this._type];this._source=new ys({url:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:function(){return e.onstop(e)},playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(n.duration-.001))}},{key:"_stop",value:function(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}},{key:"fadeIn",get:function(){return this._fadeIn},set:function(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}},{key:"_restart",value:function(t){this._stop(t),this._start(t)}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._source&&this._source.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ps.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}}]),n}(ps),gs=220500,bs={brown:null,pink:null,white:null},ws={get brown(){if(!bs.brown){for(var t=[],e=0;e<2;e++){var n=new Float32Array(gs);t[e]=n;for(var i=0,r=0;r<gs;r++){var o=2*Math.random()-1;n[r]=(i+.02*o)/1.02,i=n[r],n[r]*=3.5}}bs.brown=(new eo).fromArray(t)}return bs.brown},get pink(){if(!bs.pink){for(var t=[],e=0;e<2;e++){var n=new Float32Array(gs),i=void 0,r=void 0,o=void 0,s=void 0,a=void 0,u=void 0,c=void 0;t[e]=n,i=r=o=s=a=u=c=0;for(var l=0;l<gs;l++){var h=2*Math.random()-1;i=.99886*i+.0555179*h,r=.99332*r+.0750759*h,o=.969*o+.153852*h,s=.8665*s+.3104856*h,a=.55*a+.5329522*h,u=-.7616*u-.016898*h,n[l]=i+r+o+s+a+u+c+.5362*h,n[l]*=.11,c=.115926*h}}bs.pink=(new eo).fromArray(t)}return bs.pink},get white(){if(!bs.white){for(var t=[],e=0;e<2;e++){var n=new Float32Array(gs);t[e]=n;for(var i=0;i<gs;i++)n[i]=2*Math.random()-1}bs.white=(new eo).fromArray(t)}return bs.white}},Ss=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["volume"]))).name="UserMedia";var e=Vr(r.getDefaults(),arguments,["volume"]);return t._volume=t.output=new es({context:t.context,volume:e.volume}),t.volume=t._volume.volume,$r(n(t),"volume"),t.mute=e.mute,m(t)}return a(r,[{key:"open",value:function(e){return Sr(this,void 0,void 0,t(T).mark((function n(){var i,o,s,a;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return hr(r.supported,"UserMedia is not supported"),"started"===this.state&&this.close(),t.next=3,r.enumerateDevices();case 3:return i=t.sent,or(e)?this._device=i[e]:(this._device=i.find((function(t){return t.label===e||t.deviceId===e})),!this._device&&i.length>0&&(this._device=i[0]),hr(ir(this._device),"No matching device ".concat(e))),o={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}},this._device&&(o.audio.deviceId=this._device.deviceId),t.next=9,navigator.mediaDevices.getUserMedia(o);case 9:return s=t.sent,this._stream||(this._stream=s,qo(a=this.context.createMediaStreamSource(s),this.output),this._mediaStream=a),t.abrupt("return",this);case 12:case"end":return t.stop()}}),n,this)})))}},{key:"close",value:function(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((function(t){t.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}},{key:"state",get:function(){return this._stream&&this._stream.active?"started":"stopped"}},{key:"deviceId",get:function(){return this._device?this._device.deviceId:void 0}},{key:"groupId",get:function(){return this._device?this._device.groupId:void 0}},{key:"label",get:function(){return this._device?this._device.label:void 0}},{key:"mute",get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this.close(),this._volume.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{mute:!1,volume:0})}},{key:"enumerateDevices",value:function(){return Sr(this,void 0,void 0,t(T).mark((function e(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.enumerateDevices();case 2:return t.abrupt("return",t.sent.filter((function(t){return"audioinput"===t.kind})));case 3:case"end":return t.stop()}}),e)})))}},{key:"supported",get:function(){return ir(navigator.mediaDevices)&&ir(navigator.mediaDevices.getUserMedia)}}]),r}(Eo);function As(e,n){return Sr(this,void 0,void 0,t(T).mark((function i(){var r,o;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n/e.context.sampleRate,o=new no(1,r,e.context.sampleRate),new e.constructor(Object.assign(e.get(),{frequency:2/r,detune:0,context:o})).toDestination().start(0),t.next=4,o.render();case 4:return t.abrupt("return",t.sent.getChannelData(0));case 5:case"end":return t.stop()}}),i)})))}var Ds=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency","type"]))).name="ToneOscillatorNode",t._oscillator=t.context.createOscillator(),t._internalChannels=[t._oscillator];var r=Vr(i.getDefaults(),arguments,["frequency","type"]);return qo(t._oscillator,t._gainNode),t.type=r.type,t.frequency=new Co({context:t.context,param:t._oscillator.frequency,units:"frequency",value:r.frequency}),t.detune=new Co({context:t.context,param:t._oscillator.detune,units:"cents",value:r.detune}),$r(n(t),["frequency","detune"]),m(t)}return a(i,[{key:"start",value:function(t){var e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}},{key:"_stopSource",value:function(t){this._oscillator.stop(t)}},{key:"setPeriodicWave",value:function(t){return this._oscillator.setPeriodicWave(t),this}},{key:"type",get:function(){return this._oscillator.type},set:function(t){this._oscillator.type=t}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Io.getDefaults(),{detune:0,frequency:440,type:"sine"})}}]),i}(Io),Os=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["frequency","type"]))).name="Oscillator",t._oscillator=null;var e=Vr(r.getDefaults(),arguments,["frequency","type"]);return t.frequency=new jo({context:t.context,units:"frequency",value:e.frequency}),$r(n(t),"frequency"),t.detune=new jo({context:t.context,units:"cents",value:e.detune}),$r(n(t),"detune"),t._partials=e.partials,t._partialCount=e.partialCount,t._type=e.type,e.partialCount&&"custom"!==e.type&&(t._type=t.baseType+e.partialCount.toString()),t.phase=e.phase,m(t)}return a(r,[{key:"_start",value:function(t){var e=this,n=this.toSeconds(t),i=new Ds({context:this.context,onended:function(){return e.onstop(e)}});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}},{key:"_stop",value:function(t){var e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}},{key:"_restart",value:function(t){var e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}},{key:"syncFrequency",value:function(){return this.context.transport.syncSignal(this.frequency),this}},{key:"unsyncFrequency",value:function(){return this.context.transport.unsyncSignal(this.frequency),this}},{key:"_getCachedPeriodicWave",value:function(){var t=this;if("custom"===this._type)return r._periodicWaveCache.find((function(e){var n,i;return e.phase===t._phase&&(n=e.partials,i=t._partials,n.length===i.length&&n.every((function(t,e){return i[e]===t})))}));var e=this,n=r._periodicWaveCache.find((function(t){return t.type===e._type&&t.phase===e._phase}));return this._partialCount=n?n.partialCount:this._partialCount,n}},{key:"type",get:function(){return this._type},set:function(t){this._type=t;var e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{var n=this._getCachedPeriodicWave();if(ir(n)){var i=n.partials,o=n.wave;this._wave=o,this._partials=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{var s=g(this._getRealImaginary(t,this._phase)),a=s[0],u=s[1],c=this.context.createPeriodicWave(a,u);this._wave=c,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),r._periodicWaveCache.push({imag:u,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:a,type:this._type,wave:this._wave}),r._periodicWaveCache.length>100&&r._periodicWaveCache.shift()}}}},{key:"baseType",get:function(){return this._type.replace(this.partialCount.toString(),"")},set:function(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}},{key:"partialCount",get:function(){return this._partialCount},set:function(t){fr(t,0);var e=this._type,n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{var i=new Float32Array(t);this._partials.forEach((function(t,e){return i[e]=t})),this._partials=Array.from(i),this.type=this._type}}},{key:"_getRealImaginary",value:function(t,e){var n=2048,i=new Float32Array(n),r=new Float32Array(n),o=1;if("custom"===t){if(o=this._partials.length+1,this._partialCount=this._partials.length,n=o,0===this._partials.length)return[i,r]}else{var s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);s?(o=parseInt(s[2],10)+1,this._partialCount=parseInt(s[2],10),t=s[1],n=o=Math.max(o,2)):this._partialCount=0,this._partials=[]}for(var a=1;a<n;++a){var u=2/(a*Math.PI),c=void 0;switch(t){case"sine":c=a<=o?1:0,this._partials[a-1]=c;break;case"square":c=1&a?2*u:0,this._partials[a-1]=c;break;case"sawtooth":c=u*(1&a?1:-1),this._partials[a-1]=c;break;case"triangle":c=1&a?u*u*2*(a-1>>1&1?-1:1):0,this._partials[a-1]=c;break;case"custom":c=this._partials[a-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==c?(i[a]=-c*Math.sin(e*a),r[a]=c*Math.cos(e*a)):(i[a]=0,r[a]=0)}return[i,r]}},{key:"_inverseFFT",value:function(t,e,n){for(var i=0,r=t.length,o=0;o<r;o++)i+=t[o]*Math.cos(o*n)+e[o]*Math.sin(o*n);return i}},{key:"getInitialValue",value:function(){for(var t=g(this._getRealImaginary(this._type,0)),e=t[0],n=t[1],i=0,r=2*Math.PI,o=0;o<32;o++)i=Math.max(this._inverseFFT(e,n,o/32*r),i);return Br(-this._inverseFFT(e,n,this._phase)/i,-1,1)}},{key:"partials",get:function(){return this._partials.slice(0,this.partialCount)},set:function(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}},{key:"phase",get:function(){return this._phase*(180/Math.PI)},set:function(t){this._phase=t*Math.PI/180,this.type=this._type}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",As(this,e));case 1:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ps.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}}]),r}(ps);Os._periodicWaveCache=[];var Es=function(t){"use strict";d(n,t);var e=x(n);function n(){return o(this,n),e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["context"])))}return a(n,[{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lo(this,t,e,n),this}}]),n}(Eo),Fs=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["mapping","length"])))).name="WaveShaper",t._shaper=t.context.createWaveShaper(),t.input=t._shaper,t.output=t._shaper;var i=Vr(n.getDefaults(),arguments,["mapping","length"]);return ur(i.mapping)||i.mapping instanceof Float32Array?t.curve=Float32Array.from(i.mapping):rr(i.mapping)&&t.setMap(i.mapping,i.length),m(t)}return a(n,[{key:"setMap",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=new Float32Array(e),i=0,r=e;i<r;i++){var o=i/(r-1)*2-1;n[i]=t(o,i)}return this.curve=n,this}},{key:"curve",get:function(){return this._shaper.curve},set:function(t){this._shaper.curve=t}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(t){hr(["none","2x","4x"].some((function(e){return e.includes(t)})),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._shaper.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(jo.getDefaults(),{length:1024})}}]),n}(Es),Is=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="AudioToGain",t._norm=new Fs({context:t.context,mapping:function(t){return(t+1)/2}}),t.input=t._norm,t.output=t._norm,m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._norm.dispose(),this}}]),n}(Es),Ps=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["value"])))).name="Multiply",t.override=!1;var i=Vr(n.getDefaults(),arguments,["value"]);return t._mult=t.input=t.output=new Fo({context:t.context,minValue:i.minValue,maxValue:i.maxValue}),t.factor=t._param=t._mult.gain,t.factor.setValueAtTime(i.value,0),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(jo.getDefaults(),{value:0})}}]),n}(jo),Ls=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["frequency","type","modulationType"]))).name="AMOscillator",t._modulationScale=new Is({context:t.context}),t._modulationNode=new Fo({context:t.context});var e=Vr(r.getDefaults(),arguments,["frequency","type","modulationType"]);return t._carrier=new Os({context:t.context,detune:e.detune,frequency:e.frequency,onstop:function(){return t.onstop(n(t))},phase:e.phase,type:e.type}),t.frequency=t._carrier.frequency,t.detune=t._carrier.detune,t._modulator=new Os({context:t.context,phase:e.phase,type:e.modulationType}),t.harmonicity=new Ps({context:t.context,units:"positive",value:e.harmonicity}),t.frequency.chain(t.harmonicity,t._modulator.frequency),t._modulator.chain(t._modulationScale,t._modulationNode.gain),t._carrier.chain(t._modulationNode,t.output),$r(n(t),["frequency","detune","harmonicity"]),m(t)}return a(r,[{key:"_start",value:function(t){this._modulator.start(t),this._carrier.start(t)}},{key:"_stop",value:function(t){this._modulator.stop(t),this._carrier.stop(t)}},{key:"_restart",value:function(t){this._modulator.restart(t),this._carrier.restart(t)}},{key:"type",get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t}},{key:"modulationType",get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}},{key:"phase",get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}},{key:"partials",get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",As(this,e));case 1:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Os.getDefaults(),{harmonicity:1,modulationType:"square"})}}]),r}(ps),zs=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["frequency","type","modulationType"]))).name="FMOscillator",t._modulationNode=new Fo({context:t.context,gain:0});var e=Vr(r.getDefaults(),arguments,["frequency","type","modulationType"]);return t._carrier=new Os({context:t.context,detune:e.detune,frequency:0,onstop:function(){return t.onstop(n(t))},phase:e.phase,type:e.type}),t.detune=t._carrier.detune,t.frequency=new jo({context:t.context,units:"frequency",value:e.frequency}),t._modulator=new Os({context:t.context,phase:e.phase,type:e.modulationType}),t.harmonicity=new Ps({context:t.context,units:"positive",value:e.harmonicity}),t.modulationIndex=new Ps({context:t.context,units:"positive",value:e.modulationIndex}),t.frequency.connect(t._carrier.frequency),t.frequency.chain(t.harmonicity,t._modulator.frequency),t.frequency.chain(t.modulationIndex,t._modulationNode),t._modulator.connect(t._modulationNode.gain),t._modulationNode.connect(t._carrier.frequency),t._carrier.connect(t.output),t.detune.connect(t._modulator.detune),$r(n(t),["modulationIndex","frequency","detune","harmonicity"]),m(t)}return a(r,[{key:"_start",value:function(t){this._modulator.start(t),this._carrier.start(t)}},{key:"_stop",value:function(t){this._modulator.stop(t),this._carrier.stop(t)}},{key:"_restart",value:function(t){return this._modulator.restart(t),this._carrier.restart(t),this}},{key:"type",get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(t){this._carrier.baseType=t}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(t){this._carrier.partialCount=t}},{key:"modulationType",get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}},{key:"phase",get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}},{key:"partials",get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",As(this,e));case 1:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Os.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}}]),r}(ps),Ws=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["frequency","width"]))).name="PulseOscillator",t._widthGate=new Fo({context:t.context,gain:0}),t._thresh=new Fs({context:t.context,mapping:function(t){return t<=0?-1:1}});var e=Vr(r.getDefaults(),arguments,["frequency","width"]);return t.width=new jo({context:t.context,units:"audioRange",value:e.width}),t._triangle=new Os({context:t.context,detune:e.detune,frequency:e.frequency,onstop:function(){return t.onstop(n(t))},phase:e.phase,type:"triangle"}),t.frequency=t._triangle.frequency,t.detune=t._triangle.detune,t._triangle.chain(t._thresh,t.output),t.width.chain(t._widthGate,t._thresh),$r(n(t),["width","frequency","detune"]),m(t)}return a(r,[{key:"_start",value:function(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}},{key:"_stop",value:function(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}},{key:"_restart",value:function(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}},{key:"phase",get:function(){return this._triangle.phase},set:function(t){this._triangle.phase=t}},{key:"type",get:function(){return"pulse"}},{key:"baseType",get:function(){return"pulse"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"carrierType",set:function(t){this._triangle.type=t}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",As(this,e));case 1:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ps.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}}]),r}(ps),Bs=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["frequency","type","spread"]))).name="FatOscillator",t._oscillators=[];var e=Vr(r.getDefaults(),arguments,["frequency","type","spread"]);return t.frequency=new jo({context:t.context,units:"frequency",value:e.frequency}),t.detune=new jo({context:t.context,units:"cents",value:e.detune}),t._spread=e.spread,t._type=e.type,t._phase=e.phase,t._partials=e.partials,t._partialCount=e.partialCount,t.count=e.count,$r(n(t),["frequency","detune"]),m(t)}return a(r,[{key:"_start",value:function(t){t=this.toSeconds(t),this._forEach((function(e){return e.start(t)}))}},{key:"_stop",value:function(t){t=this.toSeconds(t),this._forEach((function(e){return e.stop(t)}))}},{key:"_restart",value:function(t){this._forEach((function(e){return e.restart(t)}))}},{key:"_forEach",value:function(t){for(var e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}},{key:"type",get:function(){return this._type},set:function(t){this._type=t,this._forEach((function(e){return e.type=t}))}},{key:"spread",get:function(){return this._spread},set:function(t){if(this._spread=t,this._oscillators.length>1){var e=-t/2,n=t/(this._oscillators.length-1);this._forEach((function(t,i){return t.detune.value=e+n*i}))}}},{key:"count",get:function(){return this._oscillators.length},set:function(t){if(fr(t,1),this._oscillators.length!==t){this._forEach((function(t){return t.dispose()})),this._oscillators=[];for(var e=0;e<t;e++){var n=this,i=new Os({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?function(){return n.onstop(n)}:to});"custom"===this.type&&(i.partials=this._partials),this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.detune.overridden=!1,i.connect(this.output),this._oscillators[e]=i}this.spread=this._spread,"started"===this.state&&this._forEach((function(t){return t.start()}))}}},{key:"phase",get:function(){return this._phase},set:function(t){var e=this;this._phase=t,this._forEach((function(t,n){return t.phase=e._phase+n/e.count*360}))}},{key:"baseType",get:function(){return this._oscillators[0].baseType},set:function(t){this._forEach((function(e){return e.baseType=t})),this._type=this._oscillators[0].type}},{key:"partials",get:function(){return this._oscillators[0].partials},set:function(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((function(e){return e.partials=t})))}},{key:"partialCount",get:function(){return this._oscillators[0].partialCount},set:function(t){this._partialCount=t,this._forEach((function(e){return e.partialCount=t})),this._type=this._oscillators[0].type}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",As(this,e));case 1:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this.frequency.dispose(),this.detune.dispose(),this._forEach((function(t){return t.dispose()})),this}}],[{key:"getDefaults",value:function(){return Object.assign(Os.getDefaults(),{count:3,spread:20,type:"sawtooth"})}}]),r}(ps),Gs=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["frequency","modulationFrequency"]))).name="PWMOscillator",t.sourceType="pwm",t._scale=new Ps({context:t.context,value:2});var e=Vr(r.getDefaults(),arguments,["frequency","modulationFrequency"]);return t._pulse=new Ws({context:t.context,frequency:e.modulationFrequency}),t._pulse.carrierType="sine",t.modulationFrequency=t._pulse.frequency,t._modulator=new Os({context:t.context,detune:e.detune,frequency:e.frequency,onstop:function(){return t.onstop(n(t))},phase:e.phase}),t.frequency=t._modulator.frequency,t.detune=t._modulator.detune,t._modulator.chain(t._scale,t._pulse.width),t._pulse.connect(t.output),$r(n(t),["modulationFrequency","frequency","detune"]),m(t)}return a(r,[{key:"_start",value:function(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}},{key:"_stop",value:function(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}},{key:"_restart",value:function(t){this._modulator.restart(t),this._pulse.restart(t)}},{key:"type",get:function(){return"pwm"}},{key:"baseType",get:function(){return"pwm"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"phase",get:function(){return this._modulator.phase},set:function(t){this._modulator.phase=t}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",As(this,e));case 1:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ps.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}}]),r}(ps),Us={am:Ls,fat:Bs,fm:zs,oscillator:Os,pulse:Ws,pwm:Gs},Ys=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["frequency","type"]))).name="OmniOscillator";var e=Vr(r.getDefaults(),arguments,["frequency","type"]);return t.frequency=new jo({context:t.context,units:"frequency",value:e.frequency}),t.detune=new jo({context:t.context,units:"cents",value:e.detune}),$r(n(t),["frequency","detune"]),t.set(e),m(t)}return a(r,[{key:"_start",value:function(t){this._oscillator.start(t)}},{key:"_stop",value:function(t){this._oscillator.stop(t)}},{key:"_restart",value:function(t){return this._oscillator.restart(t),this}},{key:"type",get:function(){var t=this,e="";return["am","fm","fat"].some((function(e){return t._sourceType===e}))&&(e=this._sourceType),e+this._oscillator.type},set:function(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}},{key:"partials",get:function(){return this._oscillator.partials},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}},{key:"partialCount",get:function(){return this._oscillator.partialCount},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}},{key:"set",value:function(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),f(l(r.prototype),"set",this).call(this,t),this}},{key:"_createNewOscillator",value:function(t){if(t!==this._sourceType){var e=this;this._sourceType=t;var n=Us[t],i=this.now();if(this._oscillator){var r=this._oscillator;r.stop(i),this.context.setTimeout((function(){return r.dispose()}),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=function(){return e.onstop(e)},"started"===this.state&&this._oscillator.start(i)}}},{key:"phase",get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t}},{key:"sourceType",get:function(){return this._sourceType},set:function(t){var e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}},{key:"_getOscType",value:function(t,e){return t instanceof Us[e]}},{key:"baseType",get:function(){return this._oscillator.baseType},set:function(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}},{key:"width",get:function(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}},{key:"count",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0},set:function(t){this._getOscType(this._oscillator,"fat")&&or(t)&&(this._oscillator.count=t)}},{key:"spread",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0},set:function(t){this._getOscType(this._oscillator,"fat")&&or(t)&&(this._oscillator.spread=t)}},{key:"modulationType",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0},set:function(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&cr(t)&&(this._oscillator.modulationType=t)}},{key:"modulationIndex",get:function(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}},{key:"harmonicity",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}},{key:"modulationFrequency",get:function(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",As(this,e));case 1:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Os.getDefaults(),zs.getDefaults(),Ls.getDefaults(),Bs.getDefaults(),Ws.getDefaults(),Gs.getDefaults())}}]),r}(ps),Zs=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["value"])))).override=!1,t.name="Add",t._sum=new Fo({context:t.context}),t.input=t._sum,t.output=t._sum,t.addend=t._param,Mo(t._constantSource,t._sum),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._sum.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(jo.getDefaults(),{value:0})}}]),n}(jo),Xs=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["min","max"])))).name="Scale";var i=Vr(n.getDefaults(),arguments,["min","max"]);return t._mult=t.input=new Ps({context:t.context,value:i.max-i.min}),t._add=t.output=new Zs({context:t.context,value:i.min}),t._min=i.min,t._max=i.max,t.input.connect(t.output),m(t)}return a(n,[{key:"min",get:function(){return this._min},set:function(t){this._min=t,this._setRange()}},{key:"max",get:function(){return this._max},set:function(t){this._max=t,this._setRange()}},{key:"_setRange",value:function(){this._add.value=this._min,this._mult.value=this._max-this._min}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._add.dispose(),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Es.getDefaults(),{max:1,min:0})}}]),n}(Es),Qs=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments)))).name="Zero",t._gain=new Fo({context:t.context}),t.output=t._gain,t.input=void 0,qo(t.context.getConstant(0),t._gain),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),Ro(this.context.getConstant(0),this._gain),this}}]),n}(Es),Hs=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency","min","max"]))).name="LFO",t._stoppedValue=0,t._units="number",t.convert=!0,t._fromType=Co.prototype._fromType,t._toType=Co.prototype._toType,t._is=Co.prototype._is,t._clampValue=Co.prototype._clampValue;var r=Vr(i.getDefaults(),arguments,["frequency","min","max"]);return t._oscillator=new Os(r),t.frequency=t._oscillator.frequency,t._amplitudeGain=new Fo({context:t.context,gain:r.amplitude,units:"normalRange"}),t.amplitude=t._amplitudeGain.gain,t._stoppedSignal=new jo({context:t.context,units:"audioRange",value:0}),t._zeros=new Qs({context:t.context}),t._a2g=new Is({context:t.context}),t._scaler=t.output=new Xs({context:t.context,max:r.max,min:r.min}),t.units=r.units,t.min=r.min,t.max=r.max,t._oscillator.chain(t._amplitudeGain,t._a2g,t._scaler),t._zeros.connect(t._a2g),t._stoppedSignal.connect(t._a2g),$r(n(t),["amplitude","frequency"]),t.phase=r.phase,m(t)}return a(i,[{key:"start",value:function(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}},{key:"stop",value:function(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}},{key:"sync",value:function(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}},{key:"unsync",value:function(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}},{key:"_setStoppedValue",value:function(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}},{key:"min",get:function(){return this._toType(this._scaler.min)},set:function(t){t=this._fromType(t),this._scaler.min=t}},{key:"max",get:function(){return this._toType(this._scaler.max)},set:function(t){t=this._fromType(t),this._scaler.max=t}},{key:"type",get:function(){return this._oscillator.type},set:function(t){this._oscillator.type=t,this._setStoppedValue()}},{key:"partials",get:function(){return this._oscillator.partials},set:function(t){this._oscillator.partials=t,this._setStoppedValue()}},{key:"phase",get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t,this._setStoppedValue()}},{key:"units",get:function(){return this._units},set:function(t){var e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}},{key:"state",get:function(){return this._oscillator.state}},{key:"connect",value:function(t,e,n){return(t instanceof Co||t instanceof jo)&&(this.convert=t.convert,this.units=t.units),Lo(this,t,e,n),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Os.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}}]),i}(Eo);function Js(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){fr(i,t,e),n.set(this,i)}})}}function $s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){fr(this.toSeconds(i),t,e),n.set(this,i)}})}}var Ks=function(e){"use strict";d(r,e);var i=x(r);function r(){var t;o(this,r),(t=i.call(this,Vr(r.getDefaults(),arguments,["url","onload"]))).name="Player",t._activeSources=new Set;var e=Vr(r.getDefaults(),arguments,["url","onload"]);return t._buffer=new eo({onload:t._onload.bind(n(t),e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),t.autostart=e.autostart,t._loop=e.loop,t._loopStart=e.loopStart,t._loopEnd=e.loopEnd,t._playbackRate=e.playbackRate,t.fadeIn=e.fadeIn,t.fadeOut=e.fadeOut,m(t)}return a(r,[{key:"load",value:function(e){return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._buffer.load(e);case 2:return this._onload(),t.abrupt("return",(t.sent,this));case 4:case"end":return t.stop()}}),n,this)})))}},{key:"_onload",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:to;t(),this.autostart&&this.start()}},{key:"_onSourceEnd",value:function(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}},{key:"start",value:function(t,e,n){return f(l(r.prototype),"start",this).call(this,t,e,n),this}},{key:"_start",value:function(t,e,n){e=this._loop?Fr(e,this._loopStart):Fr(e,0);var i=this.toSeconds(e),r=n;n=Fr(n,Math.max(this._buffer.duration-i,0));var o=this.toSeconds(n);o/=this._playbackRate,t=this.toSeconds(t);var s=new ys({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+o),this._state.setStateAtTime("stopped",t+o,{implicitEnd:!0})),this._activeSources.add(s),this._loop&&nr(r)?s.start(t,i):s.start(t,i,o-this.toSeconds(this.fadeOut))}},{key:"_stop",value:function(t){var e=this.toSeconds(t);this._activeSources.forEach((function(t){return t.stop(e)}))}},{key:"restart",value:function(t,e,n){return f(l(r.prototype),"restart",this).call(this,t,e,n),this}},{key:"_restart",value:function(t,e,n){this._stop(t),this._start(t,e,n)}},{key:"seek",value:function(t,e){var n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){var i=this.toSeconds(t);this._stop(n),this._start(n,i)}return this}},{key:"setLoopPoints",value:function(t,e){return this.loopStart=t,this.loopEnd=e,this}},{key:"loopStart",get:function(){return this._loopStart},set:function(t){this._loopStart=t,this.buffer.loaded&&fr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((function(e){e.loopStart=t}))}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this.buffer.loaded&&fr(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((function(e){e.loopEnd=t}))}},{key:"buffer",get:function(){return this._buffer},set:function(t){this._buffer.set(t)}},{key:"loop",get:function(){return this._loop},set:function(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((function(e){e.loop=t})),t)){var e=this._state.getNextState("stopped",this.now());e&&this._state.cancel(e.time)}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){this._playbackRate=t;var e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((function(t){return t.cancelStop()}))),this._activeSources.forEach((function(n){n.playbackRate.setValueAtTime(t,e)}))}},{key:"reverse",get:function(){return this._buffer.reverse},set:function(t){this._buffer.reverse=t}},{key:"loaded",get:function(){return this._buffer.loaded}},{key:"dispose",value:function(){return f(l(r.prototype),"dispose",this).call(this),this._activeSources.forEach((function(t){return t.dispose()})),this._activeSources.clear(),this._buffer.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ps.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:to,onerror:to,playbackRate:1,reverse:!1})}}]),r}(ps);Tr([$s(0)],Ks.prototype,"fadeIn",void 0),Tr([$s(0)],Ks.prototype,"fadeOut",void 0);var ta=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["urls","onload"],"urls"))).name="Players",t.input=void 0,t._players=new Map;var r=Vr(i.getDefaults(),arguments,["urls","onload"],"urls");return t._volume=t.output=new es({context:t.context,volume:r.volume}),t.volume=t._volume.volume,$r(n(t),"volume"),t._buffers=new Yo({urls:r.urls,onload:r.onload,baseUrl:r.baseUrl,onerror:r.onerror}),t.mute=r.mute,t._fadeIn=r.fadeIn,t._fadeOut=r.fadeOut,m(t)}return a(i,[{key:"mute",get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}},{key:"fadeIn",get:function(){return this._fadeIn},set:function(t){this._fadeIn=t,this._players.forEach((function(e){e.fadeIn=t}))}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(t){this._fadeOut=t,this._players.forEach((function(e){e.fadeOut=t}))}},{key:"state",get:function(){return Array.from(this._players).some((function(t){var e=g(t);return e[0],"started"===e[1].state}))?"started":"stopped"}},{key:"has",value:function(t){return this._buffers.has(t)}},{key:"player",value:function(t){if(hr(this.has(t),"No Player with the name ".concat(t," exists on this object")),!this._players.has(t)){var e=new Ks({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}},{key:"loaded",get:function(){return this._buffers.loaded}},{key:"add",value:function(t,e,n){return hr(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,n),this}},{key:"stopAll",value:function(t){return this._players.forEach((function(e){return e.stop(t)})),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._volume.dispose(),this.volume.dispose(),this._players.forEach((function(t){return t.dispose()})),this._buffers.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ps.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:to,onerror:to,urls:{},volume:0})}}]),i}(Eo),ea=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["url","onload"]))).name="GrainPlayer",t._loopStart=0,t._loopEnd=0,t._activeSources=[];var r=Vr(i.getDefaults(),arguments,["url","onload"]);return t.buffer=new eo({onload:r.onload,onerror:r.onerror,reverse:r.reverse,url:r.url}),t._clock=new Bo({context:t.context,callback:t._tick.bind(n(t)),frequency:1/r.grainSize}),t._playbackRate=r.playbackRate,t._grainSize=r.grainSize,t._overlap=r.overlap,t.detune=r.detune,t.overlap=r.overlap,t.loop=r.loop,t.playbackRate=r.playbackRate,t.grainSize=r.grainSize,t.loopStart=r.loopStart,t.loopEnd=r.loopEnd,t.reverse=r.reverse,t._clock.on("stop",t._onstop.bind(n(t))),m(t)}return a(i,[{key:"_start",value:function(t,e,n){e=Fr(e,0),e=this.toSeconds(e),t=this.toSeconds(t);var i=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/i),n&&this.stop(t+this.toSeconds(n))}},{key:"restart",value:function(t,e,n){return f(l(i.prototype),"restart",this).call(this,t,e,n),this}},{key:"_restart",value:function(t,e,n){this._stop(t),this._start(t,e,n)}},{key:"_stop",value:function(t){this._clock.stop(t)}},{key:"_onstop",value:function(t){this._activeSources.forEach((function(e){e.fadeOut=0,e.stop(t)})),this.onstop(this)}},{key:"_tick",value:function(t){var e=this,n=this._clock.getTicksAtTime(t),i=n*this._grainSize;if(this.log("offset",i),!this.loop&&i>this.buffer.duration)this.stop(t);else{var r=i<this._overlap?0:this._overlap,o=new ys({context:this.context,url:this.buffer,fadeIn:r,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:fo(this.detune/100)}).connect(this.output);o.start(t,this._grainSize*n),o.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(o),o.onended=function(){var t=e._activeSources.indexOf(o);-1!==t&&e._activeSources.splice(t,1)}}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){fr(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}},{key:"loopStart",get:function(){return this._loopStart},set:function(t){this.buffer.loaded&&fr(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(t){this.buffer.loaded&&fr(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}},{key:"reverse",get:function(){return this.buffer.reverse},set:function(t){this.buffer.reverse=t}},{key:"grainSize",get:function(){return this._grainSize},set:function(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}},{key:"overlap",get:function(){return this._overlap},set:function(t){var e=this.toSeconds(t);fr(e,0),this._overlap=e}},{key:"loaded",get:function(){return this.buffer.loaded}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((function(t){return t.dispose()})),this}}],[{key:"getDefaults",value:function(){return Object.assign(ps.getDefaults(),{onload:to,onerror:to,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}}]),i}(ps),na=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Abs",t._abs=new Fs({context:t.context,mapping:function(t){return Math.abs(t)<.001?0:Math.abs(t)}}),t.input=t._abs,t.output=t._abs,m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._abs.dispose(),this}}]),n}(Es),ia=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="GainToAudio",t._norm=new Fs({context:t.context,mapping:function(t){return 2*Math.abs(t)-1}}),t.input=t._norm,t.output=t._norm,m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._norm.dispose(),this}}]),n}(Es),ra=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Negate",t._multiply=new Ps({context:t.context,value:-1}),t.input=t._multiply,t.output=t._multiply,m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._multiply.dispose(),this}}]),n}(Es),oa=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["value"])))).override=!1,t.name="Subtract",t._sum=new Fo({context:t.context}),t.input=t._sum,t.output=t._sum,t._neg=new ra({context:t.context}),t.subtrahend=t._param,Mo(t._constantSource,t._neg,t._sum),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._neg.dispose(),this._sum.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(jo.getDefaults(),{value:0})}}]),n}(jo),sa=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments)))).name="GreaterThanZero",t._thresh=t.output=new Fs({context:t.context,length:127,mapping:function(t){return t<=0?0:1}}),t._scale=t.input=new Ps({context:t.context,value:1e4}),t._scale.connect(t._thresh),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._scale.dispose(),this._thresh.dispose(),this}}]),n}(Es),aa=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Object.assign(Vr(i.getDefaults(),arguments,["value"])))).name="GreaterThan",t.override=!1;var r=Vr(i.getDefaults(),arguments,["value"]);return t._subtract=t.input=new oa({context:t.context,value:r.value}),t._gtz=t.output=new sa({context:t.context}),t.comparator=t._param=t._subtract.subtrahend,$r(n(t),"comparator"),t._subtract.connect(t._gtz),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(jo.getDefaults(),{value:0})}}]),i}(jo),ua=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["value"])))).name="Pow";var i=Vr(n.getDefaults(),arguments,["value"]);return t._exponentScaler=t.input=t.output=new Fs({context:t.context,mapping:t._expFunc(i.value),length:8192}),t._exponent=i.value,m(t)}return a(n,[{key:"_expFunc",value:function(t){return function(e){return Math.pow(Math.abs(e),t)}}},{key:"value",get:function(){return this._exponent},set:function(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._exponentScaler.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Es.getDefaults(),{value:1})}}]),n}(Es),ca=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["min","max","exponent"])))).name="ScaleExp";var i=Vr(n.getDefaults(),arguments,["min","max","exponent"]);return t.input=t._exp=new ua({context:t.context,value:i.exponent}),t._exp.connect(t._mult),m(t)}return a(n,[{key:"exponent",get:function(){return this._exp.value},set:function(t){this._exp.value=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._exp.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Xs.getDefaults(),{exponent:1})}}]),n}(Xs),la=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(jo.getDefaults(),arguments,["value","units"]))).name="SyncedSignal",t.override=!1;var r=Vr(jo.getDefaults(),arguments,["value","units"]);return t._lastVal=r.value,t._synced=t.context.transport.scheduleRepeat(t._onTick.bind(n(t)),"1i"),t._syncedCallback=t._anchorValue.bind(n(t)),t.context.transport.on("start",t._syncedCallback),t.context.transport.on("pause",t._syncedCallback),t.context.transport.on("stop",t._syncedCallback),t._constantSource.disconnect(),t._constantSource.stop(0),t._constantSource=t.output=new Po({context:t.context,offset:r.value,units:r.units}).start(0),t.setValueAtTime(r.value,0),m(t)}return a(i,[{key:"_onTick",value:function(t){var e=f(l(i.prototype),"getValueAtTime",this).call(this,this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}},{key:"_anchorValue",value:function(t){var e=f(l(i.prototype),"getValueAtTime",this).call(this,this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}},{key:"getValueAtTime",value:function(t){var e=new So(this.context,t).toSeconds();return f(l(i.prototype),"getValueAtTime",this).call(this,e)}},{key:"setValueAtTime",value:function(t,e){var n=new So(this.context,e).toSeconds();return f(l(i.prototype),"setValueAtTime",this).call(this,t,n),this}},{key:"linearRampToValueAtTime",value:function(t,e){var n=new So(this.context,e).toSeconds();return f(l(i.prototype),"linearRampToValueAtTime",this).call(this,t,n),this}},{key:"exponentialRampToValueAtTime",value:function(t,e){var n=new So(this.context,e).toSeconds();return f(l(i.prototype),"exponentialRampToValueAtTime",this).call(this,t,n),this}},{key:"setTargetAtTime",value:function(t,e,n){var r=new So(this.context,e).toSeconds();return f(l(i.prototype),"setTargetAtTime",this).call(this,t,r,n),this}},{key:"cancelScheduledValues",value:function(t){var e=new So(this.context,t).toSeconds();return f(l(i.prototype),"cancelScheduledValues",this).call(this,e),this}},{key:"setValueCurveAtTime",value:function(t,e,n,r){var o=new So(this.context,e).toSeconds();return n=this.toSeconds(n),f(l(i.prototype),"setValueCurveAtTime",this).call(this,t,o,n,r),this}},{key:"cancelAndHoldAtTime",value:function(t){var e=new So(this.context,t).toSeconds();return f(l(i.prototype),"cancelAndHoldAtTime",this).call(this,e),this}},{key:"setRampPoint",value:function(t){var e=new So(this.context,t).toSeconds();return f(l(i.prototype),"setRampPoint",this).call(this,e),this}},{key:"exponentialRampTo",value:function(t,e,n){var r=new So(this.context,n).toSeconds();return f(l(i.prototype),"exponentialRampTo",this).call(this,t,e,r),this}},{key:"linearRampTo",value:function(t,e,n){var r=new So(this.context,n).toSeconds();return f(l(i.prototype),"linearRampTo",this).call(this,t,e,r),this}},{key:"targetRampTo",value:function(t,e,n){var r=new So(this.context,n).toSeconds();return f(l(i.prototype),"targetRampTo",this).call(this,t,e,r),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}]),i}(jo),ha=function(e){"use strict";d(i,e);var n=x(i);function i(){var t;o(this,i),(t=n.call(this,Vr(i.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="Envelope",t._sig=new jo({context:t.context,value:0}),t.output=t._sig,t.input=void 0;var e=Vr(i.getDefaults(),arguments,["attack","decay","sustain","release"]);return t.attack=e.attack,t.decay=e.decay,t.sustain=e.sustain,t.release=e.release,t.attackCurve=e.attackCurve,t.releaseCurve=e.releaseCurve,t.decayCurve=e.decayCurve,m(t)}return a(i,[{key:"value",get:function(){return this.getValueAtTime(this.now())}},{key:"_getCurve",value:function(t,e){if(cr(t))return t;var n;for(n in fa)if(fa[n][e]===t)return n;return t}},{key:"_setCurve",value:function(t,e,n){if(cr(n)&&Reflect.has(fa,n)){var i=fa[n];sr(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!ur(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}},{key:"attackCurve",get:function(){return this._getCurve(this._attackCurve,"In")},set:function(t){this._setCurve("_attackCurve","In",t)}},{key:"releaseCurve",get:function(){return this._getCurve(this._releaseCurve,"Out")},set:function(t){this._setCurve("_releaseCurve","Out",t)}},{key:"decayCurve",get:function(){return this._decayCurve},set:function(t){hr(["linear","exponential"].some((function(e){return e===t})),"Invalid envelope curve: ".concat(t)),this._decayCurve=t}},{key:"triggerAttack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.log("triggerAttack",t,e),t=this.toSeconds(t);var n=this.toSeconds(this.attack),i=this.toSeconds(this.decay),r=this.getValueAtTime(t);if(r>0&&(n=(1-r)/(1/n)),n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);for(var o=this._attackCurve,s=1;s<o.length;s++)if(o[s-1]<=r&&r<=o[s]){(o=this._attackCurve.slice(s))[0]=r;break}this._sig.setValueCurveAtTime(o,t,n,e)}if(i&&this.sustain<1){var a=e*this.sustain,u=t+n;this.log("decay",u),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(a,i+u):this._sig.exponentialApproachValueAtTime(a,u,i)}return this}},{key:"triggerRelease",value:function(t){this.log("triggerRelease",t),t=this.toSeconds(t);var e=this.getValueAtTime(t);if(e>0){var n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(hr(ur(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}},{key:"getValueAtTime",value:function(t){return this._sig.getValueAtTime(t)}},{key:"triggerAttackRelease",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}},{key:"cancel",value:function(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}},{key:"connect",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Lo(this,t,e,n),this}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return Sr(this,void 0,void 0,t(T).mark((function n(){var i,r,o,s,a,u,c;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e/this.context.sampleRate,r=new no(1,i,this.context.sampleRate),o=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=o+this.toSeconds(this.release),u=s+(a=.1*s),(c=new this.constructor(Object.assign(this.get(),{attack:i*this.toSeconds(this.attack)/u,decay:i*this.toSeconds(this.decay)/u,release:i*this.toSeconds(this.release)/u,context:r})))._sig.toDestination(),c.triggerAttackRelease(i*(o+a)/u,0),t.next=5,r.render();case 5:return t.abrupt("return",t.sent.getChannelData(0));case 6:case"end":return t.stop()}}),n,this)})))}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._sig.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}}]),i}(Eo);Tr([$s(0)],ha.prototype,"attack",void 0),Tr([$s(0)],ha.prototype,"decay",void 0),Tr([Js(0,1)],ha.prototype,"sustain",void 0),Tr([$s(0)],ha.prototype,"release",void 0);var fa=function(){var t,e,n=128,i=[];for(t=0;t<n;t++)i[t]=Math.sin(t/127*(Math.PI/2));var r=[];for(t=0;t<127;t++){e=t/127;var o=Math.sin(e*(2*Math.PI)*6.4-Math.PI/2)+1;r[t]=o/10+.83*e}r[127]=1;var s=[];for(t=0;t<n;t++)s[t]=Math.ceil(t/127*5)/5;var a=[];for(t=0;t<n;t++)e=t/127,a[t]=.5*(1-Math.cos(Math.PI*e));var u,c=[];for(t=0;t<n;t++){e=t/127;var l=4*Math.pow(e,3)+.2,h=Math.cos(l*Math.PI*2*e);c[t]=Math.abs(h*(1-e))}function f(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:f(c),Out:c},cosine:{In:i,Out:(u=i,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:f(r)},sine:{In:a,Out:f(a)},step:{In:s,Out:f(s)}}}(),pa=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments)))._scheduledEvents=[],t._synced=!1,t._original_triggerAttack=t.triggerAttack,t._original_triggerRelease=t.triggerRelease,t._syncedRelease=function(e){return t._original_triggerRelease(e)};var r=Vr(i.getDefaults(),arguments);return t._volume=t.output=new es({context:t.context,volume:r.volume}),t.volume=t._volume.volume,$r(n(t),"volume"),m(t)}return a(i,[{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}},{key:"_syncState",value:function(){var t=!1;return this._synced||(this._synced=!0,t=!0),t}},{key:"_syncMethod",value:function(t,e){var n=this,i=this["_original_"+t]=this[t];this[t]=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var s=n,a=r[e],u=n.context.transport.schedule((function(t){r[e]=t,i.apply(s,r)}),a);n._scheduledEvents.push(u)}}},{key:"unsync",value:function(){var t=this;return this._scheduledEvents.forEach((function(e){return t.context.transport.clear(e)})),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}},{key:"triggerAttackRelease",value:function(t,e,n,i){var r=this.toSeconds(n),o=this.toSeconds(e);return this.triggerAttack(t,r,i),this.triggerRelease(r+o),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{volume:0})}}]),i}(Eo),da=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),t=e.call(this,Vr(n.getDefaults(),arguments));var i=Vr(n.getDefaults(),arguments);return t.portamento=i.portamento,t.onsilence=i.onsilence,t}return a(n,[{key:"triggerAttack",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.log("triggerAttack",t,e,n);var i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}},{key:"triggerRelease",value:function(t){this.log("triggerRelease",t);var e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}},{key:"setNote",value:function(t,e){var n=this.toSeconds(e),i=t instanceof xo?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){var r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,r,n)}else this.frequency.setValueAtTime(i,n);return this}}],[{key:"getDefaults",value:function(){return Object.assign(pa.getDefaults(),{detune:0,onsilence:to,portamento:0})}}]),n}(pa);Tr([$s(0)],da.prototype,"portamento",void 0);var va=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="AmplitudeEnvelope",t._gainNode=new Fo({context:t.context,gain:0}),t.output=t._gainNode,t.input=t._gainNode,t._sig.connect(t._gainNode.gain),t.output=t._gainNode,t.input=t._gainNode,m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._gainNode.dispose(),this}}]),n}(ha),ya=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments))).name="Synth";var r=Vr(i.getDefaults(),arguments);return t.oscillator=new Ys(Object.assign({context:t.context,detune:r.detune,onstop:function(){return t.onsilence(n(t))}},r.oscillator)),t.frequency=t.oscillator.frequency,t.detune=t.oscillator.detune,t.envelope=new va(Object.assign({context:t.context},r.envelope)),t.oscillator.chain(t.envelope,t.output),$r(n(t),["oscillator","frequency","detune","envelope"]),m(t)}return a(i,[{key:"_triggerEnvelopeAttack",value:function(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+i)}}},{key:"_triggerEnvelopeRelease",value:function(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}},{key:"getLevelAtTime",value:function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.oscillator.dispose(),this.envelope.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(da.getDefaults(),{envelope:Object.assign(Ir(ha.getDefaults(),Object.keys(Eo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ir(Ys.getDefaults(),k(Object.keys(ps.getDefaults())).concat(["frequency","detune"])),{type:"triangle"})})}}]),i}(da),ma=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments))).name="ModulationSynth";var r=Vr(i.getDefaults(),arguments);return t._carrier=new ya({context:t.context,oscillator:r.oscillator,envelope:r.envelope,onsilence:function(){return t.onsilence(n(t))},volume:-10}),t._modulator=new ya({context:t.context,oscillator:r.modulation,envelope:r.modulationEnvelope,volume:-10}),t.oscillator=t._carrier.oscillator,t.envelope=t._carrier.envelope,t.modulation=t._modulator.oscillator,t.modulationEnvelope=t._modulator.envelope,t.frequency=new jo({context:t.context,units:"frequency"}),t.detune=new jo({context:t.context,value:r.detune,units:"cents"}),t.harmonicity=new Ps({context:t.context,value:r.harmonicity,minValue:0}),t._modulationNode=new Fo({context:t.context,gain:0}),$r(n(t),["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"]),m(t)}return a(i,[{key:"_triggerEnvelopeAttack",value:function(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}},{key:"_triggerEnvelopeRelease",value:function(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}},{key:"getLevelAtTime",value:function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(da.getDefaults(),{harmonicity:3,oscillator:Object.assign(Ir(Ys.getDefaults(),k(Object.keys(ps.getDefaults())).concat(["frequency","detune"])),{type:"sine"}),envelope:Object.assign(Ir(ha.getDefaults(),Object.keys(Eo.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Ir(Ys.getDefaults(),k(Object.keys(ps.getDefaults())).concat(["frequency","detune"])),{type:"square"}),modulationEnvelope:Object.assign(Ir(ha.getDefaults(),Object.keys(Eo.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}}]),i}(da),_a=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="AMSynth",t._modulationScale=new Is({context:t.context}),t.frequency.connect(t._carrier.frequency),t.frequency.chain(t.harmonicity,t._modulator.frequency),t.detune.fan(t._carrier.detune,t._modulator.detune),t._modulator.chain(t._modulationScale,t._modulationNode.gain),t._carrier.chain(t._modulationNode,t.output),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._modulationScale.dispose(),this}}]),n}(ma),ga=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["frequency","type"]))).name="BiquadFilter";var i=Vr(n.getDefaults(),arguments,["frequency","type"]);return t._filter=t.context.createBiquadFilter(),t.input=t.output=t._filter,t.Q=new Co({context:t.context,units:"number",value:i.Q,param:t._filter.Q}),t.frequency=new Co({context:t.context,units:"frequency",value:i.frequency,param:t._filter.frequency}),t.detune=new Co({context:t.context,units:"cents",value:i.detune,param:t._filter.detune}),t.gain=new Co({context:t.context,units:"decibels",convert:!1,value:i.gain,param:t._filter.gain}),t.type=i.type,m(t)}return a(n,[{key:"type",get:function(){return this._filter.type},set:function(t){hr(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: ".concat(t)),this._filter.type=t}},{key:"getFrequencyResponse",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,e=new Float32Array(t),n=0;n<t;n++){var i=19980*Math.pow(n/t,2)+20;e[n]=i}var r=new Float32Array(t),o=new Float32Array(t),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(e,r,o),r}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}}]),n}(Eo),ka=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency","type","rolloff"]))).name="Filter",t.input=new Fo({context:t.context}),t.output=new Fo({context:t.context}),t._filters=[];var r=Vr(i.getDefaults(),arguments,["frequency","type","rolloff"]);return t._filters=[],t.Q=new jo({context:t.context,units:"positive",value:r.Q}),t.frequency=new jo({context:t.context,units:"frequency",value:r.frequency}),t.detune=new jo({context:t.context,units:"cents",value:r.detune}),t.gain=new jo({context:t.context,units:"decibels",convert:!1,value:r.gain}),t._type=r.type,t.rolloff=r.rolloff,$r(n(t),["detune","frequency","gain","Q"]),m(t)}return a(i,[{key:"type",get:function(){return this._type},set:function(t){hr(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),"Invalid filter type: ".concat(t)),this._type=t,this._filters.forEach((function(e){return e.type=t}))}},{key:"rolloff",get:function(){return this._rolloff},set:function(t){var e=or(t)?t:parseInt(t,10),n=[-12,-24,-48,-96],i=n.indexOf(e);hr(-1!==i,"rolloff can only be ".concat(n.join(", "))),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((function(t){return t.disconnect()})),this._filters=new Array(i);for(var r=0;r<i;r++){var o=new ga({context:this.context});o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[r]=o}this._internalChannels=this._filters,Mo.apply(void 0,[this.input].concat(k(this._internalChannels),[this.output]))}},{key:"getFrequencyResponse",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,e=new ga({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map((function(){return 1}));return this._filters.forEach((function(){e.getFrequencyResponse(t).forEach((function(t,e){return n[e]*=t}))})),e.dispose(),n}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._filters.forEach((function(t){t.dispose()})),Kr(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}}]),i}(Eo),xa=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["attack","decay","sustain","release"]))).name="FrequencyEnvelope";var i=Vr(n.getDefaults(),arguments,["attack","decay","sustain","release"]);return t._octaves=i.octaves,t._baseFrequency=t.toFrequency(i.baseFrequency),t._exponent=t.input=new ua({context:t.context,value:i.exponent}),t._scale=t.output=new Xs({context:t.context,min:t._baseFrequency,max:t._baseFrequency*Math.pow(2,t._octaves)}),t._sig.chain(t._exponent,t._scale),m(t)}return a(n,[{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(t){var e=this.toFrequency(t);fr(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}},{key:"exponent",get:function(){return this._exponent.value},set:function(t){this._exponent.value=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._exponent.dispose(),this._scale.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ha.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}}]),n}(ha),ba=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments))).name="MonoSynth";var r=Vr(i.getDefaults(),arguments);return t.oscillator=new Ys(Object.assign(r.oscillator,{context:t.context,detune:r.detune,onstop:function(){return t.onsilence(n(t))}})),t.frequency=t.oscillator.frequency,t.detune=t.oscillator.detune,t.filter=new ka(Object.assign(r.filter,{context:t.context})),t.filterEnvelope=new xa(Object.assign(r.filterEnvelope,{context:t.context})),t.envelope=new va(Object.assign(r.envelope,{context:t.context})),t.oscillator.chain(t.filter,t.envelope,t.output),t.filterEnvelope.connect(t.filter.frequency),$r(n(t),["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),m(t)}return a(i,[{key:"_triggerEnvelopeAttack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+n+i)}}},{key:"_triggerEnvelopeRelease",value:function(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}},{key:"getLevelAtTime",value:function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(da.getDefaults(),{envelope:Object.assign(Ir(ha.getDefaults(),Object.keys(Eo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Ir(ka.getDefaults(),Object.keys(Eo.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Ir(xa.getDefaults(),Object.keys(Eo.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Ir(Ys.getDefaults(),Object.keys(ps.getDefaults())),{type:"sawtooth"})})}}]),i}(da),wa=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments))).name="DuoSynth";var r=Vr(i.getDefaults(),arguments);return t.voice0=new ba(Object.assign(r.voice0,{context:t.context,onsilence:function(){return t.onsilence(n(t))}})),t.voice1=new ba(Object.assign(r.voice1,{context:t.context})),t.harmonicity=new Ps({context:t.context,units:"positive",value:r.harmonicity}),t._vibrato=new Hs({frequency:r.vibratoRate,context:t.context,min:-50,max:50}),t._vibrato.start(),t.vibratoRate=t._vibrato.frequency,t._vibratoGain=new Fo({context:t.context,units:"normalRange",gain:r.vibratoAmount}),t.vibratoAmount=t._vibratoGain.gain,t.frequency=new jo({context:t.context,units:"frequency",value:440}),t.detune=new jo({context:t.context,units:"cents",value:r.detune}),t.frequency.connect(t.voice0.frequency),t.frequency.chain(t.harmonicity,t.voice1.frequency),t._vibrato.connect(t._vibratoGain),t._vibratoGain.fan(t.voice0.detune,t.voice1.detune),t.detune.fan(t.voice0.detune,t.voice1.detune),t.voice0.connect(t.output),t.voice1.connect(t.output),$r(n(t),["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),m(t)}return a(i,[{key:"getLevelAtTime",value:function(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}},{key:"_triggerEnvelopeAttack",value:function(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}},{key:"_triggerEnvelopeRelease",value:function(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}],[{key:"getDefaults",value:function(){return Rr(da.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:Rr(Ir(ba.getDefaults(),Object.keys(da.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:Rr(Ir(ba.getDefaults(),Object.keys(da.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}}]),i}(da),Ta=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="FMSynth";var i=Vr(n.getDefaults(),arguments);return t.modulationIndex=new Ps({context:t.context,value:i.modulationIndex}),t.frequency.connect(t._carrier.frequency),t.frequency.chain(t.harmonicity,t._modulator.frequency),t.frequency.chain(t.modulationIndex,t._modulationNode),t.detune.fan(t._carrier.detune,t._modulator.detune),t._modulator.connect(t._modulationNode.gain),t._modulationNode.connect(t._carrier.frequency),t._carrier.connect(t.output),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.modulationIndex.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ma.getDefaults(),{modulationIndex:10})}}]),n}(ma),Sa=[1,1.483,1.932,2.546,2.63,3.897],Aa=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments))).name="MetalSynth",t._oscillators=[],t._freqMultipliers=[];var r=Vr(i.getDefaults(),arguments);t.detune=new jo({context:t.context,units:"cents",value:r.detune}),t.frequency=new jo({context:t.context,units:"frequency"}),t._amplitude=new Fo({context:t.context,gain:0}).connect(t.output),t._highpass=new ka({Q:0,context:t.context,type:"highpass"}).connect(t._amplitude);for(var s=0;s<Sa.length;s++){var a=new zs({context:t.context,harmonicity:r.harmonicity,modulationIndex:r.modulationIndex,modulationType:"square",onstop:0===s?function(){return t.onsilence(n(t))}:to,type:"square"});a.connect(t._highpass),t._oscillators[s]=a;var u=new Ps({context:t.context,value:Sa[s]});t._freqMultipliers[s]=u,t.frequency.chain(u,a.frequency),t.detune.connect(a.detune)}return t._filterFreqScaler=new Xs({context:t.context,max:7e3,min:t.toFrequency(r.resonance)}),t.envelope=new ha({attack:r.envelope.attack,attackCurve:"linear",context:t.context,decay:r.envelope.decay,release:r.envelope.release,sustain:0}),t.envelope.chain(t._filterFreqScaler,t._highpass.frequency),t.envelope.connect(t._amplitude.gain),t._octaves=r.octaves,t.octaves=r.octaves,m(t)}return a(i,[{key:"_triggerEnvelopeAttack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this;return this.envelope.triggerAttack(t,e),this._oscillators.forEach((function(e){return e.start(t)})),0===this.envelope.sustain&&this._oscillators.forEach((function(e){e.stop(t+n.toSeconds(n.envelope.attack)+n.toSeconds(n.envelope.decay))})),this}},{key:"_triggerEnvelopeRelease",value:function(t){var e=this;return this.envelope.triggerRelease(t),this._oscillators.forEach((function(n){return n.stop(t+e.toSeconds(e.envelope.release))})),this}},{key:"getLevelAtTime",value:function(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}},{key:"modulationIndex",get:function(){return this._oscillators[0].modulationIndex.value},set:function(t){this._oscillators.forEach((function(e){return e.modulationIndex.value=t}))}},{key:"harmonicity",get:function(){return this._oscillators[0].harmonicity.value},set:function(t){this._oscillators.forEach((function(e){return e.harmonicity.value=t}))}},{key:"resonance",get:function(){return this._filterFreqScaler.min},set:function(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._oscillators.forEach((function(t){return t.dispose()})),this._freqMultipliers.forEach((function(t){return t.dispose()})),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Rr(da.getDefaults(),{envelope:Object.assign(Ir(ha.getDefaults(),Object.keys(Eo.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}}]),i}(da),Da=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments))).name="MembraneSynth",t.portamento=0;var r=Vr(i.getDefaults(),arguments);return t.pitchDecay=r.pitchDecay,t.octaves=r.octaves,$r(n(t),["oscillator","envelope"]),m(t)}return a(i,[{key:"setNote",value:function(t,e){var n=this.toSeconds(e),i=this.toFrequency(t instanceof xo?t.toFrequency():t),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this}}],[{key:"getDefaults",value:function(){return Rr(da.getDefaults(),ya.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}}]),i}(ya);Tr([Js(0)],Da.prototype,"octaves",void 0),Tr([$s(0)],Da.prototype,"pitchDecay",void 0);var Oa=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="NoiseSynth";var i=Vr(n.getDefaults(),arguments);return t.noise=new ms(Object.assign({context:t.context},i.noise)),t.envelope=new va(Object.assign({context:t.context},i.envelope)),t.noise.chain(t.envelope,t.output),m(t)}return a(n,[{key:"triggerAttack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}},{key:"triggerRelease",value:function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}},{key:"triggerAttackRelease",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.noise.dispose(),this.envelope.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(pa.getDefaults(),{envelope:Object.assign(Ir(ha.getDefaults(),Object.keys(Eo.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Ir(ms.getDefaults(),Object.keys(ps.getDefaults())),{type:"white"})})}}]),n}(pa),Ca=new Set;function Ea(t){Ca.add(t)}function Ma(t,e){var n='registerProcessor("'.concat(t,'", ').concat(e,")");Ca.add(n)}var qa=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;o(this,i),(r=e.call(this,t)).name="ToneAudioWorklet",r.workletOptions={},r.onprocessorerror=to;var s=URL.createObjectURL(new Blob([Array.from(Ca).join("\n")],{type:"text/javascript"})),a=r._audioWorkletName();return r._dummyGain=r.context.createGain(),r._dummyParam=r._dummyGain.gain,r.context.addAudioWorkletModule(s,a).then((function(){r.disposed||(r._worklet=r.context.createAudioWorkletNode(a,r.workletOptions),r._worklet.onprocessorerror=r.onprocessorerror.bind(n(r)),r.onReady(r._worklet))})),m(r)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}]),i}(Eo);Ea('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n'),Ea("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n"),Ea("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");var Ra="feedback-comb-filter";Ma(Ra,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');var Va=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["delayTime","resonance"]))).name="FeedbackCombFilter";var r=Vr(i.getDefaults(),arguments,["delayTime","resonance"]);return t.input=new Fo({context:t.context}),t.output=new Fo({context:t.context}),t.delayTime=new Co({context:t.context,value:r.delayTime,units:"time",minValue:0,maxValue:1,param:t._dummyParam,swappable:!0}),t.resonance=new Co({context:t.context,value:r.resonance,units:"normalRange",param:t._dummyParam,swappable:!0}),$r(n(t),["resonance","delayTime"]),m(t)}return a(i,[{key:"_audioWorkletName",value:function(){return Ra}},{key:"onReady",value:function(t){Mo(this.input,t,this.output);var e=t.parameters.get("delayTime");this.delayTime.setParam(e);var n=t.parameters.get("feedback");this.resonance.setParam(n)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{delayTime:.1,resonance:.5})}}]),i}(qa),Fa=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["frequency","type"]))).name="OnePoleFilter";var i=Vr(n.getDefaults(),arguments,["frequency","type"]);return t._frequency=i.frequency,t._type=i.type,t.input=new Fo({context:t.context}),t.output=new Fo({context:t.context}),t._createFilter(),m(t)}return a(n,[{key:"_createFilter",value:function(){var t=this,e=this._filter,n=this.toFrequency(this._frequency),i=1/(2*Math.PI*n);if("lowpass"===this._type){var r=1/(i*this.context.sampleRate),o=r-1;this._filter=this.context.createIIRFilter([r,0],[1,o])}else{var s=1/(i*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,s])}this.input.chain(this._filter,this.output),e&&this.context.setTimeout((function(){t.disposed||(t.input.disconnect(e),e.disconnect())}),this.blockTime)}},{key:"frequency",get:function(){return this._frequency},set:function(t){this._frequency=t,this._createFilter()}},{key:"type",get:function(){return this._type},set:function(t){this._type=t,this._createFilter()}},{key:"getFrequencyResponse",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,e=new Float32Array(t),n=0;n<t;n++){var i=19980*Math.pow(n/t,2)+20;e[n]=i}var r=new Float32Array(t),o=new Float32Array(t);return this._filter.getFrequencyResponse(e,r,o),r}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{frequency:880,type:"lowpass"})}}]),n}(Eo),Ia=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["delayTime","resonance","dampening"]))).name="LowpassCombFilter";var i=Vr(n.getDefaults(),arguments,["delayTime","resonance","dampening"]);return t._combFilter=t.output=new Va({context:t.context,delayTime:i.delayTime,resonance:i.resonance}),t.delayTime=t._combFilter.delayTime,t.resonance=t._combFilter.resonance,t._lowpass=t.input=new Fa({context:t.context,frequency:i.dampening,type:"lowpass"}),t._lowpass.connect(t._combFilter),m(t)}return a(n,[{key:"dampening",get:function(){return this._lowpass.frequency},set:function(t){this._lowpass.frequency=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._combFilter.dispose(),this._lowpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}}]),n}(Eo),Pa=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="PluckSynth";var i=Vr(n.getDefaults(),arguments);return t._noise=new ms({context:t.context,type:"pink"}),t.attackNoise=i.attackNoise,t._lfcf=new Ia({context:t.context,dampening:i.dampening,resonance:i.resonance}),t.resonance=i.resonance,t.release=i.release,t._noise.connect(t._lfcf),t._lfcf.connect(t.output),m(t)}return a(n,[{key:"dampening",get:function(){return this._lfcf.dampening},set:function(t){this._lfcf.dampening=t}},{key:"triggerAttack",value:function(t,e){var n=this.toFrequency(t);e=this.toSeconds(e);var i=1/n;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}},{key:"triggerRelease",value:function(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._noise.dispose(),this._lfcf.dispose(),this}}],[{key:"getDefaults",value:function(){return Rr(pa.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}}]),n}(pa),ja=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["voice","options"]))).name="PolySynth",t._availableVoices=[],t._activeVoices=[],t._voices=[],t._gcTimeout=-1,t._averageActiveVoices=0,t._syncedRelease=function(e){return t.releaseAll(e)};var r=Vr(i.getDefaults(),arguments,["voice","options"]);hr(!or(r.voice),"DEPRECATED: The polyphony count is no longer the first argument.");var s=r.voice.getDefaults();t.options=Object.assign(s,r.options),t.voice=r.voice,t.maxPolyphony=r.maxPolyphony,t._dummyVoice=t._getNextAvailableVoice();var a=t._voices.indexOf(t._dummyVoice);return t._voices.splice(a,1),t._gcTimeout=t.context.setInterval(t._collectGarbage.bind(n(t)),1),m(t)}return a(i,[{key:"activeVoices",get:function(){return this._activeVoices.length}},{key:"_makeVoiceAvailable",value:function(t){this._availableVoices.push(t);var e=this._activeVoices.findIndex((function(e){return e.voice===t}));this._activeVoices.splice(e,1)}},{key:"_getNextAvailableVoice",value:function(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){var t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return hr(t instanceof da,"Voice must extend Monophonic class"),t.connect(this.output),this._voices.push(t),t}xr("Max polyphony exceeded. Note dropped.")}},{key:"_collectGarbage",value:function(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){var t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}},{key:"_triggerAttack",value:function(t,e,n){var i=this;t.forEach((function(t){var r=new Zo(i.context,t).toMidi(),o=i._getNextAvailableVoice();o&&(o.triggerAttack(t,e,n),i._activeVoices.push({midi:r,voice:o,released:!1}),i.log("triggerAttack",t,e))}))}},{key:"_triggerRelease",value:function(t,e){var n=this;t.forEach((function(t){var i=new Zo(n.context,t).toMidi(),r=n._activeVoices.find((function(t){var e=t.midi,n=t.released;return e===i&&!n}));r&&(r.voice.triggerRelease(e),r.released=!0,n.log("triggerRelease",t,e))}))}},{key:"_scheduleEvent",value:function(t,e,n,i){var r=this;hr(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout((function(){r.disposed||r._scheduleEvent(t,e,n,i)}),n-this.now())}},{key:"triggerAttack",value:function(t,e,n){Array.isArray(t)||(t=[t]);var i=this.toSeconds(e);return this._scheduleEvent("attack",t,i,n),this}},{key:"triggerRelease",value:function(t,e){Array.isArray(t)||(t=[t]);var n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}},{key:"triggerAttackRelease",value:function(t,e,n,i){var r=this.toSeconds(n);if(this.triggerAttack(t,r,i),ur(e)){hr(ur(t),"If the duration is an array, the notes must also be an array");for(var o=0;o<t.length;o++){var s=e[Math.min(o,e.length-1)],a=this.toSeconds(s);hr(a>0,"The duration must be greater than 0"),this.triggerRelease(t[o],r+a)}}else{var u=this.toSeconds(e);hr(u>0,"The duration must be greater than 0"),this.triggerRelease(t,r+u)}return this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}},{key:"set",value:function(t){var e=Ir(t,["onsilence","context"]);return this.options=Rr(this.options,e),this._voices.forEach((function(t){return t.set(e)})),this._dummyVoice.set(e),this}},{key:"get",value:function(){return this._dummyVoice.get()}},{key:"releaseAll",value:function(t){var e=this.toSeconds(t);return this._activeVoices.forEach((function(t){t.voice.triggerRelease(e)})),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._dummyVoice.dispose(),this._voices.forEach((function(t){return t.dispose()})),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}],[{key:"getDefaults",value:function(){return Object.assign(pa.getDefaults(),{maxPolyphony:32,options:{},voice:ya})}}]),i}(pa),La=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"))).name="Sampler",t._activeSources=new Map;var i=Vr(n.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),r={};return Object.keys(i.urls).forEach((function(e){var n=parseInt(e,10);if(hr(lr(e)||or(n)&&isFinite(n),"url key is neither a note or midi pitch: ".concat(e)),lr(e)){var o=new xo(t.context,e).toMidi();r[o]=i.urls[e]}else or(n)&&isFinite(n)&&(r[n]=i.urls[n])})),t._buffers=new Yo({urls:r,onload:i.onload,baseUrl:i.baseUrl,onerror:i.onerror}),t.attack=i.attack,t.release=i.release,t.curve=i.curve,t._buffers.loaded&&Promise.resolve().then(i.onload),m(t)}return a(n,[{key:"_findClosest",value:function(t){for(var e=0;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error("No available buffers for note: ".concat(t))}},{key:"triggerAttack",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=this;return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((function(t){var r=i,o=yo(new xo(i.context,t).toFrequency()),s=Math.round(o),a=o-s,u=i._findClosest(s),c=s-u,l=i._buffers.get(c),h=fo(u+a),f=new ys({url:l,context:i.context,curve:i.curve,fadeIn:i.attack,fadeOut:i.release,playbackRate:h}).connect(i.output);f.start(e,0,l.duration/h,n),ur(i._activeSources.get(s))||i._activeSources.set(s,[]),i._activeSources.get(s).push(f),f.onended=function(){if(r._activeSources&&r._activeSources.has(s)){var t=r._activeSources.get(s),e=t.indexOf(f);-1!==e&&t.splice(e,1)}}})),this}},{key:"triggerRelease",value:function(t,e){var n=this;return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((function(t){var i=new xo(n.context,t).toMidi();if(n._activeSources.has(i)&&n._activeSources.get(i).length){var r=n._activeSources.get(i);e=n.toSeconds(e),r.forEach((function(t){t.stop(e)})),n._activeSources.set(i,[])}})),this}},{key:"releaseAll",value:function(t){var e=this.toSeconds(t);return this._activeSources.forEach((function(t){for(;t.length;)t.shift().stop(e)})),this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}},{key:"triggerAttackRelease",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=this,o=this.toSeconds(n);return this.triggerAttack(t,o,i),ur(e)?(hr(ur(t),"notes must be an array when duration is array"),t.forEach((function(t,n){var i=e[Math.min(n,e.length-1)];r.triggerRelease(t,o+r.toSeconds(i))}))):this.triggerRelease(t,o+this.toSeconds(e)),this}},{key:"add",value:function(t,e,n){if(hr(lr(t)||isFinite(t),"note must be a pitch or midi: ".concat(t)),lr(t)){var i=new xo(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}},{key:"loaded",get:function(){return this._buffers.loaded}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._buffers.dispose(),this._activeSources.forEach((function(t){t.forEach((function(t){return t.dispose()}))})),this._activeSources.clear(),this}}],[{key:"getDefaults",value:function(){return Object.assign(pa.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:to,onerror:to,release:.1,urls:{}})}}]),n}(pa);Tr([$s(0)],La.prototype,"attack",void 0),Tr([$s(0)],La.prototype,"release",void 0);var Na=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["callback","value"]))).name="ToneEvent",t._state=new Oo("stopped"),t._startOffset=0;var i=Vr(n.getDefaults(),arguments,["callback","value"]);return t._loop=i.loop,t.callback=i.callback,t.value=i.value,t._loopStart=t.toTicks(i.loopStart),t._loopEnd=t.toTicks(i.loopEnd),t._playbackRate=i.playbackRate,t._probability=i.probability,t._humanize=i.humanize,t.mute=i.mute,t._playbackRate=i.playbackRate,t._state.increasing=!0,t._rescheduleEvents(),m(t)}return a(n,[{key:"_rescheduleEvents",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,e=this;this._state.forEachFrom(t,(function(t){var n;if("started"===t.state){-1!==t.id&&e.context.transport.clear(t.id);var i=t.time+Math.round(e.startOffset/e._playbackRate);if(!0===e._loop||or(e._loop)&&e._loop>1){n=1/0,or(e._loop)&&(n=e._loop*e._getLoopDuration());var r=e._state.getAfter(i);null!==r&&(n=Math.min(n,r.time-i)),n!==1/0&&(n=new Qo(e.context,n));var o=new Qo(e.context,e._getLoopDuration());t.id=e.context.transport.scheduleRepeat(e._tick.bind(e),o,new Qo(e.context,i),n)}else t.id=e.context.transport.schedule(e._tick.bind(e),new Qo(e.context,i))}}))}},{key:"state",get:function(){return this._state.getValueAtTime(this.context.transport.ticks)}},{key:"startOffset",get:function(){return this._startOffset},set:function(t){this._startOffset=t}},{key:"probability",get:function(){return this._probability},set:function(t){this._probability=t}},{key:"humanize",get:function(){return this._humanize},set:function(t){this._humanize=t}},{key:"start",value:function(t){var e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}},{key:"stop",value:function(t){this.cancel(t);var e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});var n=this._state.getBefore(e),i=e;null!==n&&(i=n.time),this._rescheduleEvents(i)}return this}},{key:"cancel",value:function(t){var e=this;t=Fr(t,-1/0);var n=this.toTicks(t);return this._state.forEachFrom(n,(function(t){e.context.transport.clear(t.id)})),this._state.cancel(n),this}},{key:"_tick",value:function(t){var e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){var n=.02;ar(this.humanize)||(n=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*n}this.callback(t,this.value)}}},{key:"_getLoopDuration",value:function(){return(this._loopEnd-this._loopStart)/this._playbackRate}},{key:"loop",get:function(){return this._loop},set:function(t){this._loop=t,this._rescheduleEvents()}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._rescheduleEvents()}},{key:"loopEnd",get:function(){return new Qo(this.context,this._loopEnd).toSeconds()},set:function(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}},{key:"loopStart",get:function(){return new Qo(this.context,this._loopStart).toSeconds()},set:function(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}},{key:"progress",get:function(){if(this._loop){var t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){var n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.cancel(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Do.getDefaults(),{callback:to,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}}]),n}(Do),za=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["callback","interval"]))).name="Loop";var r=Vr(i.getDefaults(),arguments,["callback","interval"]);return t._event=new Na({context:t.context,callback:t._tick.bind(n(t)),loop:!0,loopEnd:r.interval,playbackRate:r.playbackRate,probability:r.probability}),t.callback=r.callback,t.iterations=r.iterations,m(t)}return a(i,[{key:"start",value:function(t){return this._event.start(t),this}},{key:"stop",value:function(t){return this._event.stop(t),this}},{key:"cancel",value:function(t){return this._event.cancel(t),this}},{key:"_tick",value:function(t){this.callback(t)}},{key:"state",get:function(){return this._event.state}},{key:"progress",get:function(){return this._event.progress}},{key:"interval",get:function(){return this._event.loopEnd},set:function(t){this._event.loopEnd=t}},{key:"playbackRate",get:function(){return this._event.playbackRate},set:function(t){this._event.playbackRate=t}},{key:"humanize",get:function(){return this._event.humanize},set:function(t){this._event.humanize=t}},{key:"probability",get:function(){return this._event.probability},set:function(t){this._event.probability=t}},{key:"mute",get:function(){return this._event.mute},set:function(t){this._event.mute=t}},{key:"iterations",get:function(){return!0===this._event.loop?1/0:this._event.loop},set:function(t){this._event.loop=t===1/0||t}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._event.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Do.getDefaults(),{interval:"4n",callback:to,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}}]),i}(Do),Wa=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["callback","events"]))).name="Part",t._state=new Oo("stopped"),t._events=new Set;var i=Vr(n.getDefaults(),arguments,["callback","events"]);return t._state.increasing=!0,i.events.forEach((function(e){ur(e)?t.add(e[0],e[1]):t.add(e)})),m(t)}return a(n,[{key:"start",value:function(t,e){var n=this.toTicks(t);if("started"!==this._state.getValueAtTime(n)){var i=this;e=Fr(e,this._loop?this._loopStart:0),e=this._loop?Fr(e,this._loopStart):Fr(e,0);var r=this.toTicks(e);this._state.add({id:-1,offset:r,state:"started",time:n}),this._forEach((function(t){i._startNote(t,n,r)}))}return this}},{key:"_startNote",value:function(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new Qo(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new Qo(this.context,e))):t.startOffset>=n&&t.start(new Qo(this.context,e))}},{key:"startOffset",get:function(){return this._startOffset},set:function(t){var e=this;this._startOffset=t,this._forEach((function(t){t.startOffset+=e._startOffset}))}},{key:"stop",value:function(t){var e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach((function(e){e.stop(t)})),this}},{key:"at",value:function(t,e){for(var n=new So(this.context,t).toTicks(),i=new Qo(this.context,1).toSeconds(),r=this._events.values(),o=r.next();!o.done;){var s=o.value;if(Math.abs(n-s.startOffset)<i)return ir(e)&&(s.value=e),s;o=r.next()}return ir(e)?(this.add(t,e),this.at(t)):null}},{key:"add",value:function(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);var n,i=this.toTicks(t);return e instanceof Na?(n=e).callback=this._tick.bind(this):n=new Na({callback:this._tick.bind(this),context:this.context,value:e}),n.startOffset=i,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this}},{key:"_restartEvent",value:function(t){var e=this;this._state.forEach((function(n){"started"===n.state?e._startNote(t,n.time,n.offset):t.stop(new Qo(e.context,n.time))}))}},{key:"remove",value:function(t,e){var n=this;return sr(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach((function(i){i.startOffset===t&&(nr(e)||ir(e)&&i.value===e)&&(n._events.delete(i),i.dispose())})),this}},{key:"clear",value:function(){return this._forEach((function(t){return t.dispose()})),this._events.clear(),this}},{key:"cancel",value:function(t){return this._forEach((function(e){return e.cancel(t)})),this._state.cancel(this.toTicks(t)),this}},{key:"_forEach",value:function(t){return this._events&&this._events.forEach((function(e){e instanceof n?e._forEach(t):t(e)})),this}},{key:"_setAll",value:function(t,e){this._forEach((function(n){n[t]=e}))}},{key:"_tick",value:function(t,e){this.mute||this.callback(t,e)}},{key:"_testLoopBoundries",value:function(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}},{key:"probability",get:function(){return this._probability},set:function(t){this._probability=t,this._setAll("probability",t)}},{key:"humanize",get:function(){return this._humanize},set:function(t){this._humanize=t,this._setAll("humanize",t)}},{key:"loop",get:function(){return this._loop},set:function(t){var e=this;this._loop=t,this._forEach((function(n){n.loopStart=e.loopStart,n.loopEnd=e.loopEnd,n.loop=t,e._testLoopBoundries(n)}))}},{key:"loopEnd",get:function(){return new Qo(this.context,this._loopEnd).toSeconds()},set:function(t){var e=this;this._loopEnd=this.toTicks(t),this._loop&&this._forEach((function(n){n.loopEnd=t,e._testLoopBoundries(n)}))}},{key:"loopStart",get:function(){return new Qo(this.context,this._loopStart).toSeconds()},set:function(t){var e=this;this._loopStart=this.toTicks(t),this._loop&&this._forEach((function(t){t.loopStart=e.loopStart,e._testLoopBoundries(t)}))}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._setAll("playbackRate",t)}},{key:"length",get:function(){return this._events.size}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.clear(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Na.getDefaults(),{events:[]})}}]),n}(Na);function Ba(e){var n;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.length)){t.next=8;break}return n=Ya(n,e),t.next=5,e[n];case 5:n++;case 6:t.next=1;break;case 8:case"end":return t.stop()}}),S)}function Ga(e){var n;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.length-1;case 1:if(!(n>=0)){t.next=8;break}return n=Ya(n,e),t.next=5,e[n];case 5:n--;case 6:t.next=1;break;case 8:case"end":return t.stop()}}),w)}function Ua(e,n){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(n(e),"t0",1);case 1:t.next=0;break;case 3:case"end":return t.stop()}}),b)}function Ya(t,e){return Br(t,0,e.length-1)}function Za(e,n){var i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=n?0:e.length-1;case 1:return i=Ya(i,e),t.next=4,e[i];case 4:n?++i>=e.length-1&&(n=!1):--i<=0&&(n=!0);case 5:t.next=1;break;case 7:case"end":return t.stop()}}),_)}function Xa(e){var n,i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,i=0;case 1:if(!(n<e.length)){t.next=9;break}return n=Ya(n,e),t.next=5,e[n];case 5:i++,n+=i%2?2:-1;case 7:t.next=1;break;case 9:case"end":return t.stop()}}),p)}function Qa(e){var n,i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.length-1,i=0;case 1:if(!(n>=0)){t.next=9;break}return n=Ya(n,e),t.next=5,e[n];case 5:i++,n+=i%2?-2:1;case 7:t.next=1;break;case 9:case"end":return t.stop()}}),h)}function Ha(e){var n,r,o;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=[],r=0;r<e.length;r++)n.push(r);case 2:if(!(n.length>0)){t.next=8;break}return o=Ya(n.splice(Math.floor(n.length*Math.random()),1)[0],e),t.next=6,e[o];case 6:t.next=2;break;case 8:case"end":return t.stop()}}),i)}function Ja(n){var i,r=arguments;return t(T).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r.length>1&&void 0!==r[1]?r[1]:"up",r.length>2&&void 0!==r[2]&&r[2],e.t0=(hr(n.length>0,"The array must have more than one value in it"),i),e.next="up"===e.t0?4:"down"===e.t0?5:"upDown"===e.t0?6:"downUp"===e.t0?7:"alternateUp"===e.t0?8:"alternateDown"===e.t0?9:"random"===e.t0?10:"randomOnce"===e.t0?11:"randomWalk"===e.t0?12:13;break;case 4:return e.delegateYield(Ua(n,Ba),"t1",5);case 5:return e.delegateYield(Ua(n,Ga),"t2",6);case 6:return e.delegateYield(Za(n,!0),"t3",7);case 7:return e.delegateYield(Za(n,!1),"t4",8);case 8:return e.delegateYield(Ua(n,Xa),"t5",9);case 9:return e.delegateYield(Ua(n,Qa),"t6",10);case 10:return e.delegateYield(t(T).mark((function e(n){var i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=Math.floor(Math.random()*n.length),t.next=3,n[i];case 3:t.next=0;break;case 5:case"end":return t.stop()}}),e)}))(n),"t7",11);case 11:return e.delegateYield(Ua(n,Ha),"t8",12);case 12:return e.delegateYield(t(T).mark((function e(n){var i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=Math.floor(Math.random()*n.length);case 1:return 0===i?i++:i===n.length-1||Math.random()<.5?i--:i++,t.next=4,n[i];case 4:t.next=1;break;case 6:case"end":return t.stop()}}),e)}))(n),"t9",13);case 13:case"end":return e.stop()}}),e)}var $a=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["callback","values","pattern"]))).name="Pattern";var i=Vr(n.getDefaults(),arguments,["callback","values","pattern"]);return t.callback=i.callback,t._values=i.values,t._pattern=Ja(i.values,i.pattern),t._type=i.pattern,m(t)}return a(n,[{key:"_tick",value:function(t){var e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}},{key:"values",get:function(){return this._values},set:function(t){this._values=t,this.pattern=this._type}},{key:"value",get:function(){return this._value}},{key:"pattern",get:function(){return this._type},set:function(t){this._type=t,this._pattern=Ja(this._values,this._type)}}],[{key:"getDefaults",value:function(){return Object.assign(za.getDefaults(),{pattern:"up",values:[],callback:to})}}]),n}(za),Ka=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["callback","events","subdivision"]))).name="Sequence",t._part=new Wa({callback:t._seqCallback.bind(n(t)),context:t.context}),t._events=[],t._eventsArray=[];var r=Vr(i.getDefaults(),arguments,["callback","events","subdivision"]);return t._subdivision=t.toTicks(r.subdivision),t.events=r.events,t.loop=r.loop,t.loopStart=r.loopStart,t.loopEnd=r.loopEnd,t.playbackRate=r.playbackRate,t.probability=r.probability,t.humanize=r.humanize,t.mute=r.mute,t.playbackRate=r.playbackRate,m(t)}return a(i,[{key:"_seqCallback",value:function(t,e){null===e||this.mute||this.callback(t,e)}},{key:"events",get:function(){return this._events},set:function(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}},{key:"start",value:function(t,e){return this._part.start(t,e?this._indexTime(e):e),this}},{key:"stop",value:function(t){return this._part.stop(t),this}},{key:"subdivision",get:function(){return new Qo(this.context,this._subdivision).toSeconds()}},{key:"_createSequence",value:function(t){var e=this;return new Proxy(t,{get:function(t,e){return t[e]},set:function(t,n,i){return cr(n)&&isFinite(parseInt(n,10))&&ur(i)?t[n]=e._createSequence(i):t[n]=i,e._eventsUpdated(),!0}})}},{key:"_eventsUpdated",value:function(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}},{key:"_rescheduleSequence",value:function(t,e,n){var i=this;t.forEach((function(t,r){var o=r*e+n;if(ur(t))i._rescheduleSequence(t,e/t.length,o);else{var s=new Qo(i.context,o,"i").toSeconds();i._part.add(s,t)}}))}},{key:"_indexTime",value:function(t){return new Qo(this.context,t*this._subdivision+this.startOffset).toSeconds()}},{key:"clear",value:function(){return this._part.clear(),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._part.dispose(),this}},{key:"loop",get:function(){return this._part.loop},set:function(t){this._part.loop=t}},{key:"loopStart",get:function(){return this._loopStart},set:function(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}},{key:"startOffset",get:function(){return this._part.startOffset},set:function(t){this._part.startOffset=t}},{key:"playbackRate",get:function(){return this._part.playbackRate},set:function(t){this._part.playbackRate=t}},{key:"probability",get:function(){return this._part.probability},set:function(t){this._part.probability=t}},{key:"progress",get:function(){return this._part.progress}},{key:"humanize",get:function(){return this._part.humanize},set:function(t){this._part.humanize=t}},{key:"length",get:function(){return this._part.length}}],[{key:"getDefaults",value:function(){return Object.assign(Ir(Na.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}}]),i}(Na),tu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Object.assign(Vr(i.getDefaults(),arguments,["fade"])))).name="CrossFade",t._panner=t.context.createStereoPanner(),t._split=t.context.createChannelSplitter(2),t._g2a=new ia({context:t.context}),t.a=new Fo({context:t.context,gain:0}),t.b=new Fo({context:t.context,gain:0}),t.output=new Fo({context:t.context}),t._internalChannels=[t.a,t.b];var r=Vr(i.getDefaults(),arguments,["fade"]);return t.fade=new jo({context:t.context,units:"normalRange",value:r.fade}),$r(n(t),"fade"),t.context.getConstant(1).connect(t._panner),t._panner.connect(t._split),t._panner.channelCount=1,t._panner.channelCountMode="explicit",qo(t._split,t.a.gain,0),qo(t._split,t.b.gain,1),t.fade.chain(t._g2a,t._panner.pan),t.a.connect(t.output),t.b.connect(t.output),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{fade:.5})}}]),i}(Eo),eu=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;return o(this,i),(r=e.call(this,t)).name="Effect",r._dryWet=new tu({context:r.context}),r.wet=r._dryWet.fade,r.effectSend=new Fo({context:r.context}),r.effectReturn=new Fo({context:r.context}),r.input=new Fo({context:r.context}),r.output=r._dryWet,r.input.fan(r._dryWet.a,r.effectSend),r.effectReturn.connect(r._dryWet.b),r.wet.setValueAtTime(t.wet,0),r._internalChannels=[r.effectReturn,r.effectSend],$r(n(r),"wet"),m(r)}return a(i,[{key:"connectEffect",value:function(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{wet:1})}}]),i}(Eo),nu=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;return o(this,i),(r=e.call(this,t)).name="LFOEffect",r._lfo=new Hs({context:r.context,frequency:t.frequency,amplitude:t.depth}),r.depth=r._lfo.amplitude,r.frequency=r._lfo.frequency,r.type=t.type,$r(n(r),["frequency","depth"]),m(r)}return a(i,[{key:"start",value:function(t){return this._lfo.start(t),this}},{key:"stop",value:function(t){return this._lfo.stop(t),this}},{key:"sync",value:function(){return this._lfo.sync(),this}},{key:"unsync",value:function(){return this._lfo.unsync(),this}},{key:"type",get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{frequency:1,type:"sine",depth:1})}}]),i}(eu),iu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["frequency","baseFrequency","octaves"]))).name="AutoFilter";var i=Vr(n.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);return t.filter=new ka(Object.assign(i.filter,{context:t.context})),t.connectEffect(t.filter),t._lfo.connect(t.filter.frequency),t.octaves=i.octaves,t.baseFrequency=i.baseFrequency,m(t)}return a(n,[{key:"baseFrequency",get:function(){return this._lfo.min},set:function(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.filter.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(nu.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}}]),n}(nu),ru=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Object.assign(Vr(i.getDefaults(),arguments,["pan"])))).name="Panner",t._panner=t.context.createStereoPanner(),t.input=t._panner,t.output=t._panner;var r=Vr(i.getDefaults(),arguments,["pan"]);return t.pan=new Co({context:t.context,param:t._panner.pan,value:r.pan,minValue:-1,maxValue:1}),t._panner.channelCount=r.channelCount,t._panner.channelCountMode="explicit",$r(n(t),"pan"),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._panner.disconnect(),this.pan.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{pan:0,channelCount:1})}}]),i}(Eo),ou=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["frequency"]))).name="AutoPanner";var i=Vr(n.getDefaults(),arguments,["frequency"]);return t._panner=new ru({context:t.context,channelCount:i.channelCount}),t.connectEffect(t._panner),t._lfo.connect(t._panner.pan),t._lfo.min=-1,t._lfo.max=1,m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._panner.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(nu.getDefaults(),{channelCount:1})}}]),n}(nu),su=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["smoothing"]))).name="Follower";var i=Vr(n.getDefaults(),arguments,["smoothing"]);return t._abs=t.input=new na({context:t.context}),t._lowpass=t.output=new Fa({context:t.context,frequency:1/t.toSeconds(i.smoothing),type:"lowpass"}),t._abs.connect(t._lowpass),t._smoothing=i.smoothing,m(t)}return a(n,[{key:"smoothing",get:function(){return this._smoothing},set:function(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._abs.dispose(),this._lowpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{smoothing:.05})}}]),n}(Eo),au=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]))).name="AutoWah";var r=Vr(i.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);return t._follower=new su({context:t.context,smoothing:r.follower}),t._sweepRange=new ca({context:t.context,min:0,max:1,exponent:.5}),t._baseFrequency=t.toFrequency(r.baseFrequency),t._octaves=r.octaves,t._inputBoost=new Fo({context:t.context}),t._bandpass=new ka({context:t.context,rolloff:-48,frequency:0,Q:r.Q}),t._peaking=new ka({context:t.context,type:"peaking"}),t._peaking.gain.value=r.gain,t.gain=t._peaking.gain,t.Q=t._bandpass.Q,t.effectSend.chain(t._inputBoost,t._follower,t._sweepRange),t._sweepRange.connect(t._bandpass.frequency),t._sweepRange.connect(t._peaking.frequency),t.effectSend.chain(t._bandpass,t._peaking,t.effectReturn),t._setSweepRange(),t.sensitivity=r.sensitivity,$r(n(t),["gain","Q"]),m(t)}return a(i,[{key:"octaves",get:function(){return this._octaves},set:function(t){this._octaves=t,this._setSweepRange()}},{key:"follower",get:function(){return this._follower.smoothing},set:function(t){this._follower.smoothing=t}},{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}},{key:"sensitivity",get:function(){return ho(1/this._inputBoost.gain.value)},set:function(t){this._inputBoost.gain.value=1/lo(t)}},{key:"_setSweepRange",value:function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}}]),i}(eu),uu="bit-crusher";Ma(uu,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");var cu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["bits"]))).name="BitCrusher";var i=Vr(n.getDefaults(),arguments,["bits"]);return t._bitCrusherWorklet=new lu({context:t.context,bits:i.bits}),t.connectEffect(t._bitCrusherWorklet),t.bits=t._bitCrusherWorklet.bits,m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._bitCrusherWorklet.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{bits:4})}}]),n}(eu),lu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="BitCrusherWorklet";var i=Vr(n.getDefaults(),arguments);return t.input=new Fo({context:t.context}),t.output=new Fo({context:t.context}),t.bits=new Co({context:t.context,value:i.bits,units:"positive",minValue:1,maxValue:16,param:t._dummyParam,swappable:!0}),m(t)}return a(n,[{key:"_audioWorkletName",value:function(){return uu}},{key:"onReady",value:function(t){Mo(this.input,t,this.output);var e=t.parameters.get("bits");this.bits.setParam(e)}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(qa.getDefaults(),{bits:12})}}]),n}(qa),hu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["order"]))).name="Chebyshev";var i=Vr(n.getDefaults(),arguments,["order"]);return t._shaper=new Fs({context:t.context,length:4096}),t._order=i.order,t.connectEffect(t._shaper),t.order=i.order,t.oversample=i.oversample,m(t)}return a(n,[{key:"_getCoefficient",value:function(t,e,n){return n.has(e)||(0===e?n.set(e,0):1===e?n.set(e,t):n.set(e,2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n))),n.get(e)}},{key:"order",get:function(){return this._order},set:function(t){var e=this;hr(Number.isInteger(t),"'order' must be an integer"),this._order=t,this._shaper.setMap((function(n){return e._getCoefficient(n,t,new Map)}))}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._shaper.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{order:1,oversample:"none"})}}]),n}(eu),fu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["channels"]))).name="Split";var i=Vr(n.getDefaults(),arguments,["channels"]);return t._splitter=t.input=t.output=t.context.createChannelSplitter(i.channels),t._internalChannels=[t._splitter],m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._splitter.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{channels:2})}}]),n}(Eo),pu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["channels"]))).name="Merge";var i=Vr(n.getDefaults(),arguments,["channels"]);return t._merger=t.output=t.input=t.context.createChannelMerger(i.channels),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._merger.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{channels:2})}}]),n}(Eo),du=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;return o(this,i),(r=e.call(this,t)).name="StereoEffect",r.input=new Fo({context:r.context}),r.input.channelCount=2,r.input.channelCountMode="explicit",r._dryWet=r.output=new tu({context:r.context,fade:t.wet}),r.wet=r._dryWet.fade,r._split=new fu({context:r.context,channels:2}),r._merge=new pu({context:r.context,channels:2}),r.input.connect(r._split),r.input.connect(r._dryWet.a),r._merge.connect(r._dryWet.b),$r(n(r),["wet"]),m(r)}return a(i,[{key:"connectEffectLeft",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._split.connect(e[0],0,0),Mo.apply(void 0,k(e)),qo(e[e.length-1],this._merge,0,0)}},{key:"connectEffectRight",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this._split.connect(e[0],1,0),Mo.apply(void 0,k(e)),qo(e[e.length-1],this._merge,0,1)}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{wet:1})}}]),i}(Eo),vu=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;return o(this,i),(r=e.call(this,t)).feedback=new jo({context:r.context,value:t.feedback,units:"normalRange"}),r._feedbackL=new Fo({context:r.context}),r._feedbackR=new Fo({context:r.context}),r._feedbackSplit=new fu({context:r.context,channels:2}),r._feedbackMerge=new pu({context:r.context,channels:2}),r._merge.connect(r._feedbackSplit),r._feedbackMerge.connect(r._split),r._feedbackSplit.connect(r._feedbackL,0,0),r._feedbackL.connect(r._feedbackMerge,0,0),r._feedbackSplit.connect(r._feedbackR,1,0),r._feedbackR.connect(r._feedbackMerge,0,1),r.feedback.fan(r._feedbackL.gain,r._feedbackR.gain),$r(n(r),["feedback"]),m(r)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(du.getDefaults(),{feedback:.5})}}]),i}(du),yu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency","delayTime","depth"]))).name="Chorus";var r=Vr(i.getDefaults(),arguments,["frequency","delayTime","depth"]);return t._depth=r.depth,t._delayTime=r.delayTime/1e3,t._lfoL=new Hs({context:t.context,frequency:r.frequency,min:0,max:1}),t._lfoR=new Hs({context:t.context,frequency:r.frequency,min:0,max:1,phase:180}),t._delayNodeL=new Go({context:t.context}),t._delayNodeR=new Go({context:t.context}),t.frequency=t._lfoL.frequency,$r(n(t),["frequency"]),t._lfoL.frequency.connect(t._lfoR.frequency),t.connectEffectLeft(t._delayNodeL),t.connectEffectRight(t._delayNodeR),t._lfoL.connect(t._delayNodeL.delayTime),t._lfoR.connect(t._delayNodeR.delayTime),t.depth=t._depth,t.type=r.type,t.spread=r.spread,m(t)}return a(i,[{key:"depth",get:function(){return this._depth},set:function(t){this._depth=t;var e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}},{key:"delayTime",get:function(){return 1e3*this._delayTime},set:function(t){this._delayTime=t/1e3,this.depth=this._depth}},{key:"type",get:function(){return this._lfoL.type},set:function(t){this._lfoL.type=t,this._lfoR.type=t}},{key:"spread",get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}},{key:"start",value:function(t){return this._lfoL.start(t),this._lfoR.start(t),this}},{key:"stop",value:function(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}},{key:"sync",value:function(){return this._lfoL.sync(),this._lfoR.sync(),this}},{key:"unsync",value:function(){return this._lfoL.unsync(),this._lfoR.unsync(),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(vu.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}}]),i}(vu),mu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["distortion"]))).name="Distortion";var i=Vr(n.getDefaults(),arguments,["distortion"]);return t._shaper=new Fs({context:t.context,length:4096}),t._distortion=i.distortion,t.connectEffect(t._shaper),t.distortion=i.distortion,t.oversample=i.oversample,m(t)}return a(n,[{key:"distortion",get:function(){return this._distortion},set:function(t){this._distortion=t;var e=100*t,n=Math.PI/180;this._shaper.setMap((function(t){return Math.abs(t)<.001?0:(3+e)*t*20*n/(Math.PI+e*Math.abs(t))}))}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._shaper.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{distortion:.4,oversample:"none"})}}]),n}(eu),_u=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;return o(this,i),(r=e.call(this,t)).name="FeedbackEffect",r._feedbackGain=new Fo({context:r.context,gain:t.feedback,units:"normalRange"}),r.feedback=r._feedbackGain.gain,$r(n(r),"feedback"),r.effectReturn.chain(r._feedbackGain,r.effectSend),m(r)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._feedbackGain.dispose(),this.feedback.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{feedback:.125})}}]),i}(eu),gu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["delayTime","feedback"]))).name="FeedbackDelay";var r=Vr(i.getDefaults(),arguments,["delayTime","feedback"]);return t._delayNode=new Go({context:t.context,delayTime:r.delayTime,maxDelay:r.maxDelay}),t.delayTime=t._delayNode.delayTime,t.connectEffect(t._delayNode),$r(n(t),"delayTime"),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._delayNode.dispose(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(_u.getDefaults(),{delayTime:.25,maxDelay:1})}}]),i}(_u),ku=function(t){"use strict";d(n,t);var e=x(n);function n(t){var i;return o(this,n),(i=e.call(this,t)).name="PhaseShiftAllpass",i.input=new Fo({context:i.context}),i.output=new Fo({context:i.context}),i.offset90=new Fo({context:i.context}),i._bank0=i._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),i._bank1=i._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),i._oneSampleDelay=i.context.createIIRFilter([0,1],[1,0]),Mo.apply(void 0,[i.input].concat(k(i._bank0),[i._oneSampleDelay,i.output])),Mo.apply(void 0,[i.input].concat(k(i._bank1),[i.offset90])),m(i)}return a(n,[{key:"_createAllPassFilterBank",value:function(t){var e=this;return t.map((function(t){var n=[[t*t,0,-1],[1,0,-t*t]];return e.context.createIIRFilter(n[0],n[1])}))}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((function(t){return t.disconnect()})),this._bank1.forEach((function(t){return t.disconnect()})),this._oneSampleDelay.disconnect(),this}}]),n}(Eo),xu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["frequency"]))).name="FrequencyShifter";var i=Vr(n.getDefaults(),arguments,["frequency"]);t.frequency=new jo({context:t.context,units:"frequency",value:i.frequency,minValue:-t.context.sampleRate/2,maxValue:t.context.sampleRate/2}),t._sine=new Ds({context:t.context,type:"sine"}),t._cosine=new Os({context:t.context,phase:-90,type:"sine"}),t._sineMultiply=new Ps({context:t.context}),t._cosineMultiply=new Ps({context:t.context}),t._negate=new ra({context:t.context}),t._add=new Zs({context:t.context}),t._phaseShifter=new ku({context:t.context}),t.effectSend.connect(t._phaseShifter),t.frequency.fan(t._sine.frequency,t._cosine.frequency),t._phaseShifter.offset90.connect(t._cosineMultiply),t._cosine.connect(t._cosineMultiply.factor),t._phaseShifter.connect(t._sineMultiply),t._sine.connect(t._sineMultiply.factor),t._sineMultiply.connect(t._negate),t._cosineMultiply.connect(t._add),t._negate.connect(t._add.addend),t._add.connect(t.effectReturn);var r=t.immediate();return t._sine.start(r),t._cosine.start(r),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{frequency:0})}}]),n}(eu),bu=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],wu=[225,556,441,341],Tu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["roomSize","dampening"]))).name="Freeverb",t._combFilters=[],t._allpassFiltersL=[],t._allpassFiltersR=[];var r=Vr(i.getDefaults(),arguments,["roomSize","dampening"]);return t.roomSize=new jo({context:t.context,value:r.roomSize,units:"normalRange"}),t._allpassFiltersL=wu.map((function(e){var n=t.context.createBiquadFilter();return n.type="allpass",n.frequency.value=e,n})),t._allpassFiltersR=wu.map((function(e){var n=t.context.createBiquadFilter();return n.type="allpass",n.frequency.value=e,n})),t._combFilters=bu.map((function(e,n){var i=new Ia({context:t.context,dampening:r.dampening,delayTime:e});return n<bu.length/2?t.connectEffectLeft.apply(t,[i].concat(k(t._allpassFiltersL))):t.connectEffectRight.apply(t,[i].concat(k(t._allpassFiltersR))),t.roomSize.connect(i.resonance),i})),$r(n(t),["roomSize"]),m(t)}return a(i,[{key:"dampening",get:function(){return this._combFilters[0].dampening},set:function(t){this._combFilters.forEach((function(e){return e.dampening=t}))}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._allpassFiltersL.forEach((function(t){return t.disconnect()})),this._allpassFiltersR.forEach((function(t){return t.disconnect()})),this._combFilters.forEach((function(t){return t.dispose()})),this.roomSize.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(du.getDefaults(),{roomSize:.7,dampening:3e3})}}]),i}(du),Su=[.06748,.06404,.08212,.09004],Au=[.773,.802,.753,.733],Du=[347,113,37],Ou=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["roomSize"]))).name="JCReverb",t._allpassFilters=[],t._feedbackCombFilters=[];var r=Vr(i.getDefaults(),arguments,["roomSize"]);return t.roomSize=new jo({context:t.context,value:r.roomSize,units:"normalRange"}),t._scaleRoomSize=new Xs({context:t.context,min:-.733,max:.197}),t._allpassFilters=Du.map((function(e){var n=t.context.createBiquadFilter();return n.type="allpass",n.frequency.value=e,n})),t._feedbackCombFilters=Su.map((function(e,n){var i=new Va({context:t.context,delayTime:e});return t._scaleRoomSize.connect(i.resonance),i.resonance.value=Au[n],n<Su.length/2?t.connectEffectLeft.apply(t,k(t._allpassFilters).concat([i])):t.connectEffectRight.apply(t,k(t._allpassFilters).concat([i])),i})),t.roomSize.connect(t._scaleRoomSize),$r(n(t),["roomSize"]),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._allpassFilters.forEach((function(t){return t.disconnect()})),this._feedbackCombFilters.forEach((function(t){return t.dispose()})),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(du.getDefaults(),{roomSize:.5})}}]),i}(du),Cu=function(t){"use strict";d(i,t);var e=x(i);function i(t){var r;return o(this,i),(r=e.call(this,t))._feedbackL.disconnect(),r._feedbackL.connect(r._feedbackMerge,0,1),r._feedbackR.disconnect(),r._feedbackR.connect(r._feedbackMerge,0,0),$r(n(r),["feedback"]),m(r)}return i}(vu),Eu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["delayTime","feedback"]))).name="PingPongDelay";var r=Vr(i.getDefaults(),arguments,["delayTime","feedback"]);return t._leftDelay=new Go({context:t.context,maxDelay:r.maxDelay}),t._rightDelay=new Go({context:t.context,maxDelay:r.maxDelay}),t._rightPreDelay=new Go({context:t.context,maxDelay:r.maxDelay}),t.delayTime=new jo({context:t.context,units:"time",value:r.delayTime}),t.connectEffectLeft(t._leftDelay),t.connectEffectRight(t._rightPreDelay,t._rightDelay),t.delayTime.fan(t._leftDelay.delayTime,t._rightDelay.delayTime,t._rightPreDelay.delayTime),t._feedbackL.disconnect(),t._feedbackL.connect(t._rightDelay),$r(n(t),["delayTime"]),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Cu.getDefaults(),{delayTime:.25,maxDelay:1})}}]),i}(Cu),Mu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["pitch"]))).name="PitchShift";var r=Vr(i.getDefaults(),arguments,["pitch"]);t._frequency=new jo({context:t.context}),t._delayA=new Go({maxDelay:1,context:t.context}),t._lfoA=new Hs({context:t.context,min:0,max:.1,type:"sawtooth"}).connect(t._delayA.delayTime),t._delayB=new Go({maxDelay:1,context:t.context}),t._lfoB=new Hs({context:t.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(t._delayB.delayTime),t._crossFade=new tu({context:t.context}),t._crossFadeLFO=new Hs({context:t.context,min:0,max:1,type:"triangle",phase:90}).connect(t._crossFade.fade),t._feedbackDelay=new Go({delayTime:r.delayTime,context:t.context}),t.delayTime=t._feedbackDelay.delayTime,$r(n(t),"delayTime"),t._pitch=r.pitch,t._windowSize=r.windowSize,t._delayA.connect(t._crossFade.a),t._delayB.connect(t._crossFade.b),t._frequency.fan(t._lfoA.frequency,t._lfoB.frequency,t._crossFadeLFO.frequency),t.effectSend.fan(t._delayA,t._delayB),t._crossFade.chain(t._feedbackDelay,t.effectReturn);var s=t.now();return t._lfoA.start(s),t._lfoB.start(s),t._crossFadeLFO.start(s),t.windowSize=t._windowSize,m(t)}return a(i,[{key:"pitch",get:function(){return this._pitch},set:function(t){this._pitch=t;var e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=fo(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=fo(t)-1),this._frequency.value=e*(1.2/this._windowSize)}},{key:"windowSize",get:function(){return this._windowSize},set:function(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(_u.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}}]),i}(_u),qu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency","octaves","baseFrequency"]))).name="Phaser";var r=Vr(i.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);return t._lfoL=new Hs({context:t.context,frequency:r.frequency,min:0,max:1}),t._lfoR=new Hs({context:t.context,frequency:r.frequency,min:0,max:1,phase:180}),t._baseFrequency=t.toFrequency(r.baseFrequency),t._octaves=r.octaves,t.Q=new jo({context:t.context,value:r.Q,units:"positive"}),t._filtersL=t._makeFilters(r.stages,t._lfoL),t._filtersR=t._makeFilters(r.stages,t._lfoR),t.frequency=t._lfoL.frequency,t.frequency.value=r.frequency,t.connectEffectLeft.apply(t,k(t._filtersL)),t.connectEffectRight.apply(t,k(t._filtersR)),t._lfoL.frequency.connect(t._lfoR.frequency),t.baseFrequency=r.baseFrequency,t.octaves=r.octaves,t._lfoL.start(),t._lfoR.start(),$r(n(t),["frequency","Q"]),m(t)}return a(i,[{key:"_makeFilters",value:function(t,e){for(var n=[],i=0;i<t;i++){var r=this.context.createBiquadFilter();r.type="allpass",this.Q.connect(r.Q),e.connect(r.frequency),n.push(r)}return n}},{key:"octaves",get:function(){return this._octaves},set:function(t){this._octaves=t;var e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}},{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((function(t){return t.disconnect()})),this._filtersR.forEach((function(t){return t.disconnect()})),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(du.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}}]),i}(du),Ru=function(e){"use strict";d(i,e);var n=x(i);function i(){var t;o(this,i),(t=n.call(this,Vr(i.getDefaults(),arguments,["decay"]))).name="Reverb",t._convolver=t.context.createConvolver(),t.ready=Promise.resolve();var e=Vr(i.getDefaults(),arguments,["decay"]);return t._decay=e.decay,t._preDelay=e.preDelay,t.generate(),t.connectEffect(t._convolver),m(t)}return a(i,[{key:"decay",get:function(){return this._decay},set:function(t){fr(t=this.toSeconds(t),.001),this._decay=t,this.generate()}},{key:"preDelay",get:function(){return this._preDelay},set:function(t){fr(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}},{key:"generate",value:function(){return Sr(this,void 0,void 0,t(T).mark((function e(){var n,i,r,o,s,a,u;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.ready,i=new no(2,this._decay+this._preDelay,this.context.sampleRate),r=new ms({context:i}),o=new ms({context:i}),s=new pu({context:i}),r.connect(s,0,0),o.connect(s,0,1),a=new Fo({context:i}).toDestination(),s.connect(a),r.start(0),o.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay),u=i.render(),this.ready=u.then(to),t.next=8,n;case 8:return t.next=10,u;case 10:return this._convolver.buffer=t.sent.get(),t.abrupt("return",(t.sent,this));case 12:case"end":return t.stop()}}),e,this)})))}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._convolver.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{decay:1.5,preDelay:.01})}}]),i}(eu),Vu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="MidSideSplit",t._split=t.input=new fu({channels:2,context:t.context}),t._midAdd=new Zs({context:t.context}),t.mid=new Ps({context:t.context,value:Math.SQRT1_2}),t._sideSubtract=new oa({context:t.context}),t.side=new Ps({context:t.context,value:Math.SQRT1_2}),t._split.connect(t._midAdd,0),t._split.connect(t._midAdd.addend,1),t._split.connect(t._sideSubtract,0),t._split.connect(t._sideSubtract.subtrahend,1),t._midAdd.connect(t.mid),t._sideSubtract.connect(t.side),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}]),n}(Eo),Fu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="MidSideMerge",t.mid=new Fo({context:t.context}),t.side=new Fo({context:t.context}),t._left=new Zs({context:t.context}),t._leftMult=new Ps({context:t.context,value:Math.SQRT1_2}),t._right=new oa({context:t.context}),t._rightMult=new Ps({context:t.context,value:Math.SQRT1_2}),t._merge=t.output=new pu({context:t.context}),t.mid.fan(t._left),t.side.connect(t._left.addend),t.mid.connect(t._right),t.side.connect(t._right.subtrahend),t._left.connect(t._leftMult),t._right.connect(t._rightMult),t._leftMult.connect(t._merge,0,0),t._rightMult.connect(t._merge,0,1),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}]),n}(Eo),Iu=function(t){"use strict";d(n,t);var e=x(n);function n(t){var i;return o(this,n),(i=e.call(this,t)).name="MidSideEffect",i._midSideMerge=new Fu({context:i.context}),i._midSideSplit=new Vu({context:i.context}),i._midSend=i._midSideSplit.mid,i._sideSend=i._midSideSplit.side,i._midReturn=i._midSideMerge.mid,i._sideReturn=i._midSideMerge.side,i.effectSend.connect(i._midSideSplit),i._midSideMerge.connect(i.effectReturn),m(i)}return a(n,[{key:"connectEffectMid",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;(i=this._midSend).chain.apply(i,k(e).concat([this._midReturn]))}},{key:"connectEffectSide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i;(i=this._sideSend).chain.apply(i,k(e).concat([this._sideReturn]))}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}]),n}(eu),Pu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["width"]))).name="StereoWidener";var r=Vr(i.getDefaults(),arguments,["width"]);return t.width=new jo({context:t.context,value:r.width,units:"normalRange"}),$r(n(t),["width"]),t._twoTimesWidthMid=new Ps({context:t.context,value:2}),t._twoTimesWidthSide=new Ps({context:t.context,value:2}),t._midMult=new Ps({context:t.context}),t._twoTimesWidthMid.connect(t._midMult.factor),t.connectEffectMid(t._midMult),t._oneMinusWidth=new oa({context:t.context}),t._oneMinusWidth.connect(t._twoTimesWidthMid),qo(t.context.getConstant(1),t._oneMinusWidth),t.width.connect(t._oneMinusWidth.subtrahend),t._sideMult=new Ps({context:t.context}),t.width.connect(t._twoTimesWidthSide),t._twoTimesWidthSide.connect(t._sideMult.factor),t.connectEffectSide(t._sideMult),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Iu.getDefaults(),{width:.5})}}]),i}(Iu),ju=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency","depth"]))).name="Tremolo";var r=Vr(i.getDefaults(),arguments,["frequency","depth"]);return t._lfoL=new Hs({context:t.context,type:r.type,min:1,max:0}),t._lfoR=new Hs({context:t.context,type:r.type,min:1,max:0}),t._amplitudeL=new Fo({context:t.context}),t._amplitudeR=new Fo({context:t.context}),t.frequency=new jo({context:t.context,value:r.frequency,units:"frequency"}),t.depth=new jo({context:t.context,value:r.depth,units:"normalRange"}),$r(n(t),["frequency","depth"]),t.connectEffectLeft(t._amplitudeL),t.connectEffectRight(t._amplitudeR),t._lfoL.connect(t._amplitudeL.gain),t._lfoR.connect(t._amplitudeR.gain),t.frequency.fan(t._lfoL.frequency,t._lfoR.frequency),t.depth.fan(t._lfoR.amplitude,t._lfoL.amplitude),t.spread=r.spread,m(t)}return a(i,[{key:"start",value:function(t){return this._lfoL.start(t),this._lfoR.start(t),this}},{key:"stop",value:function(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}},{key:"sync",value:function(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}},{key:"unsync",value:function(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}},{key:"type",get:function(){return this._lfoL.type},set:function(t){this._lfoL.type=t,this._lfoR.type=t}},{key:"spread",get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(du.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}}]),i}(du),Lu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["frequency","depth"]))).name="Vibrato";var r=Vr(i.getDefaults(),arguments,["frequency","depth"]);return t._delayNode=new Go({context:t.context,delayTime:0,maxDelay:r.maxDelay}),t._lfo=new Hs({context:t.context,type:r.type,min:0,max:r.maxDelay,frequency:r.frequency,phase:-90}).start().connect(t._delayNode.delayTime),t.frequency=t._lfo.frequency,t.depth=t._lfo.amplitude,t.depth.value=r.depth,$r(n(t),["frequency","depth"]),t.effectSend.chain(t._delayNode,t.effectReturn),m(t)}return a(i,[{key:"type",get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}}]),i}(eu),Nu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["type","size"]))).name="Analyser",t._analysers=[],t._buffers=[];var i=Vr(n.getDefaults(),arguments,["type","size"]);t.input=t.output=t._gain=new Fo({context:t.context}),t._split=new fu({context:t.context,channels:i.channels}),t.input.connect(t._split),fr(i.channels,1);for(var r=0;r<i.channels;r++)t._analysers[r]=t.context.createAnalyser(),t._split.connect(t._analysers[r],r,0);return t.size=i.size,t.type=i.type,t.smoothing=i.smoothing,m(t)}return a(n,[{key:"getValue",value:function(){var t=this;return this._analysers.forEach((function(e,n){var i=t._buffers[n];"fft"===t._type?e.getFloatFrequencyData(i):"waveform"===t._type&&e.getFloatTimeDomainData(i)})),1===this.channels?this._buffers[0]:this._buffers}},{key:"size",get:function(){return this._analysers[0].frequencyBinCount},set:function(t){var e=this;this._analysers.forEach((function(n,i){n.fftSize=2*t,e._buffers[i]=new Float32Array(t)}))}},{key:"channels",get:function(){return this._analysers.length}},{key:"type",get:function(){return this._type},set:function(t){hr("waveform"===t||"fft"===t,"Analyser: invalid type: ".concat(t)),this._type=t}},{key:"smoothing",get:function(){return this._analysers[0].smoothingTimeConstant},set:function(t){this._analysers.forEach((function(e){return e.smoothingTimeConstant=t}))}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._analysers.forEach((function(t){return t.disconnect()})),this._split.dispose(),this._gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}}]),n}(Eo),zu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="MeterBase",t.input=t.output=t._analyser=new Nu({context:t.context,size:256,type:"waveform"}),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._analyser.dispose(),this}}]),n}(Eo),Wu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["smoothing"]))).name="Meter",t._rms=0;var i=Vr(n.getDefaults(),arguments,["smoothing"]);return t.input=t.output=t._analyser=new Nu({context:t.context,size:256,type:"waveform",channels:i.channelCount}),t.smoothing=i.smoothing,t.normalRange=i.normalRange,m(t)}return a(n,[{key:"getLevel",value:function(){return xr("'getLevel' has been changed to 'getValue'"),this.getValue()}},{key:"getValue",value:function(){var t=this,e=this._analyser.getValue(),n=(1===this.channels?[e]:e).map((function(e){var n=e.reduce((function(t,e){return t+e*e}),0),i=Math.sqrt(n/e.length);return t._rms=Math.max(i,t._rms*t.smoothing),t.normalRange?t._rms:ho(t._rms)}));return 1===this.channels?n[0]:n}},{key:"channels",get:function(){return this._analyser.channels}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._analyser.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(zu.getDefaults(),{smoothing:.8,normalRange:!1,channelCount:1})}}]),n}(zu),Bu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["size"]))).name="FFT";var i=Vr(n.getDefaults(),arguments,["size"]);return t.normalRange=i.normalRange,t._analyser.type="fft",t.size=i.size,m(t)}return a(n,[{key:"getValue",value:function(){var t=this;return this._analyser.getValue().map((function(e){return t.normalRange?lo(e):e}))}},{key:"size",get:function(){return this._analyser.size},set:function(t){this._analyser.size=t}},{key:"smoothing",get:function(){return this._analyser.smoothing},set:function(t){this._analyser.smoothing=t}},{key:"getFrequencyOfIndex",value:function(t){return hr(0<=t&&t<this.size,"index must be greater than or equal to 0 and less than ".concat(this.size)),t*this.context.sampleRate/(2*this.size)}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}}]),n}(zu),Gu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="DCMeter",t._analyser.type="waveform",t._analyser.size=256,m(t)}return a(n,[{key:"getValue",value:function(){return this._analyser.getValue()[0]}}]),n}(zu),Uu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["size"]))).name="Waveform";var i=Vr(n.getDefaults(),arguments,["size"]);return t._analyser.type="waveform",t.size=i.size,m(t)}return a(n,[{key:"getValue",value:function(){return this._analyser.getValue()}},{key:"size",get:function(){return this._analyser.size},set:function(t){this._analyser.size=t}}],[{key:"getDefaults",value:function(){return Object.assign(zu.getDefaults(),{size:1024})}}]),n}(zu),Yu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["solo"]))).name="Solo";var r=Vr(i.getDefaults(),arguments,["solo"]);return t.input=t.output=new Fo({context:t.context}),i._allSolos.has(t.context)||i._allSolos.set(t.context,new Set),i._allSolos.get(t.context).add(n(t)),t.solo=r.solo,m(t)}return a(i,[{key:"solo",get:function(){return this._isSoloed()},set:function(t){t?this._addSolo():this._removeSolo(),i._allSolos.get(this.context).forEach((function(t){return t._updateSolo()}))}},{key:"muted",get:function(){return 0===this.input.gain.value}},{key:"_addSolo",value:function(){i._soloed.has(this.context)||i._soloed.set(this.context,new Set),i._soloed.get(this.context).add(this)}},{key:"_removeSolo",value:function(){i._soloed.has(this.context)&&i._soloed.get(this.context).delete(this)}},{key:"_isSoloed",value:function(){return i._soloed.has(this.context)&&i._soloed.get(this.context).has(this)}},{key:"_noSolos",value:function(){return!i._soloed.has(this.context)||i._soloed.has(this.context)&&0===i._soloed.get(this.context).size}},{key:"_updateSolo",value:function(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),i._allSolos.get(this.context).delete(this),this._removeSolo(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{solo:!1})}}]),i}(Eo);Yu._allSolos=new Map,Yu._soloed=new Map;var Zu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["pan","volume"]))).name="PanVol";var r=Vr(i.getDefaults(),arguments,["pan","volume"]);return t._panner=t.input=new ru({context:t.context,pan:r.pan,channelCount:r.channelCount}),t.pan=t._panner.pan,t._volume=t.output=new es({context:t.context,volume:r.volume}),t.volume=t._volume.volume,t._panner.connect(t._volume),t.mute=r.mute,$r(n(t),["pan","volume"]),m(t)}return a(i,[{key:"mute",get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}}]),i}(Eo),Xu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["volume","pan"]))).name="Channel";var r=Vr(i.getDefaults(),arguments,["volume","pan"]);return t._solo=t.input=new Yu({solo:r.solo,context:t.context}),t._panVol=t.output=new Zu({context:t.context,pan:r.pan,volume:r.volume,mute:r.mute,channelCount:r.channelCount}),t.pan=t._panVol.pan,t.volume=t._panVol.volume,t._solo.connect(t._panVol),$r(n(t),["pan","volume"]),m(t)}return a(i,[{key:"solo",get:function(){return this._solo.solo},set:function(t){this._solo.solo=t}},{key:"muted",get:function(){return this._solo.muted||this.mute}},{key:"mute",get:function(){return this._panVol.mute},set:function(t){this._panVol.mute=t}},{key:"_getBus",value:function(t){return i.buses.has(t)||i.buses.set(t,new Fo({context:this.context})),i.buses.get(t)}},{key:"send",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._getBus(t),i=new Fo({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}},{key:"receive",value:function(t){return this._getBus(t).connect(this),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}}]),i}(Eo);Xu.buses=new Map;var Qu=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments))).name="Mono",t.input=new Fo({context:t.context}),t._merge=t.output=new pu({channels:2,context:t.context}),t.input.connect(t._merge,0,0),t.input.connect(t._merge,0,1),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._merge.dispose(),this.input.dispose(),this}}]),n}(Eo),Hu=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["lowFrequency","highFrequency"]))).name="MultibandSplit",t.input=new Fo({context:t.context}),t.output=void 0,t.low=new ka({context:t.context,frequency:0,type:"lowpass"}),t._lowMidFilter=new ka({context:t.context,frequency:0,type:"highpass"}),t.mid=new ka({context:t.context,frequency:0,type:"lowpass"}),t.high=new ka({context:t.context,frequency:0,type:"highpass"}),t._internalChannels=[t.low,t.mid,t.high];var r=Vr(i.getDefaults(),arguments,["lowFrequency","highFrequency"]);return t.lowFrequency=new jo({context:t.context,units:"frequency",value:r.lowFrequency}),t.highFrequency=new jo({context:t.context,units:"frequency",value:r.highFrequency}),t.Q=new jo({context:t.context,units:"positive",value:r.Q}),t.input.fan(t.low,t.high),t.input.chain(t._lowMidFilter,t.mid),t.lowFrequency.fan(t.low.frequency,t._lowMidFilter.frequency),t.highFrequency.fan(t.mid.frequency,t.high.frequency),t.Q.connect(t.low.Q),t.Q.connect(t._lowMidFilter.Q),t.Q.connect(t.mid.Q),t.Q.connect(t.high.Q),$r(n(t),["high","mid","low","highFrequency","lowFrequency"]),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),Kr(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}}]),i}(Eo),Ju=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;return o(this,n),(t=e.call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))).name="Listener",t.positionX=new Co({context:t.context,param:t.context.rawContext.listener.positionX}),t.positionY=new Co({context:t.context,param:t.context.rawContext.listener.positionY}),t.positionZ=new Co({context:t.context,param:t.context.rawContext.listener.positionZ}),t.forwardX=new Co({context:t.context,param:t.context.rawContext.listener.forwardX}),t.forwardY=new Co({context:t.context,param:t.context.rawContext.listener.forwardY}),t.forwardZ=new Co({context:t.context,param:t.context.rawContext.listener.forwardZ}),t.upX=new Co({context:t.context,param:t.context.rawContext.listener.upX}),t.upY=new Co({context:t.context,param:t.context.rawContext.listener.upY}),t.upZ=new Co({context:t.context,param:t.context.rawContext.listener.upZ}),m(t)}return a(n,[{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}}]),n}(Eo);Yr((function(t){t.listener=new Ju({context:t})})),Xr((function(t){t.listener.dispose()}));var $u=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Vr(n.getDefaults(),arguments,["positionX","positionY","positionZ"]))).name="Panner3D";var i=Vr(n.getDefaults(),arguments,["positionX","positionY","positionZ"]);return t._panner=t.input=t.output=t.context.createPanner(),t.panningModel=i.panningModel,t.maxDistance=i.maxDistance,t.distanceModel=i.distanceModel,t.coneOuterGain=i.coneOuterGain,t.coneOuterAngle=i.coneOuterAngle,t.coneInnerAngle=i.coneInnerAngle,t.refDistance=i.refDistance,t.rolloffFactor=i.rolloffFactor,t.positionX=new Co({context:t.context,param:t._panner.positionX,value:i.positionX}),t.positionY=new Co({context:t.context,param:t._panner.positionY,value:i.positionY}),t.positionZ=new Co({context:t.context,param:t._panner.positionZ,value:i.positionZ}),t.orientationX=new Co({context:t.context,param:t._panner.orientationX,value:i.orientationX}),t.orientationY=new Co({context:t.context,param:t._panner.orientationY,value:i.orientationY}),t.orientationZ=new Co({context:t.context,param:t._panner.orientationZ,value:i.orientationZ}),m(t)}return a(n,[{key:"setPosition",value:function(t,e,n){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=n,this}},{key:"setOrientation",value:function(t,e,n){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=n,this}},{key:"panningModel",get:function(){return this._panner.panningModel},set:function(t){this._panner.panningModel=t}},{key:"refDistance",get:function(){return this._panner.refDistance},set:function(t){this._panner.refDistance=t}},{key:"rolloffFactor",get:function(){return this._panner.rolloffFactor},set:function(t){this._panner.rolloffFactor=t}},{key:"distanceModel",get:function(){return this._panner.distanceModel},set:function(t){this._panner.distanceModel=t}},{key:"coneInnerAngle",get:function(){return this._panner.coneInnerAngle},set:function(t){this._panner.coneInnerAngle=t}},{key:"coneOuterAngle",get:function(){return this._panner.coneOuterAngle},set:function(t){this._panner.coneOuterAngle=t}},{key:"coneOuterGain",get:function(){return this._panner.coneOuterGain},set:function(t){this._panner.coneOuterGain=t}},{key:"maxDistance",get:function(){return this._panner.maxDistance},set:function(t){this._panner.maxDistance=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}}]),n}(Eo),Ku=function(e){"use strict";d(i,e);var n=x(i);function i(){var t;o(this,i),(t=n.call(this,Vr(i.getDefaults(),arguments))).name="Recorder";var e=Vr(i.getDefaults(),arguments);return t.input=new Fo({context:t.context}),hr(i.supported,"Media Recorder API is not available"),t._stream=t.context.createMediaStreamDestination(),t.input.connect(t._stream),t._recorder=new MediaRecorder(t._stream.stream,{mimeType:e.mimeType}),m(t)}return a(i,[{key:"mimeType",get:function(){return this._recorder.mimeType}},{key:"state",get:function(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}},{key:"start",value:function(){return Sr(this,void 0,void 0,t(T).mark((function e(){var n,i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,hr("started"!==this.state,"Recorder is already started"),i=new Promise((function(t){var e=n,i=function(){e._recorder.removeEventListener("start",i,!1),t()};n._recorder.addEventListener("start",i,!1)})),this._recorder.start(),t.next=6,i;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),e,this)})))}},{key:"stop",value:function(){return Sr(this,void 0,void 0,t(T).mark((function e(){var n,i;return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this,hr("stopped"!==this.state,"Recorder is not started"),i=new Promise((function(t){var e=n,i=function(n){e._recorder.removeEventListener("dataavailable",i,!1),t(n.data)};n._recorder.addEventListener("dataavailable",i,!1)})),this._recorder.stop(),t.next=6,i;case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),e,this)})))}},{key:"pause",value:function(){return hr("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.input.dispose(),this._stream.disconnect(),this}}],[{key:"getDefaults",value:function(){return Eo.getDefaults()}},{key:"supported",get:function(){return null!==br&&Reflect.has(br,"MediaRecorder")}}]),i}(Eo),tc=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["threshold","ratio"]))).name="Compressor",t._compressor=t.context.createDynamicsCompressor(),t.input=t._compressor,t.output=t._compressor;var r=Vr(i.getDefaults(),arguments,["threshold","ratio"]);return t.threshold=new Co({minValue:t._compressor.threshold.minValue,maxValue:t._compressor.threshold.maxValue,context:t.context,convert:!1,param:t._compressor.threshold,units:"decibels",value:r.threshold}),t.attack=new Co({minValue:t._compressor.attack.minValue,maxValue:t._compressor.attack.maxValue,context:t.context,param:t._compressor.attack,units:"time",value:r.attack}),t.release=new Co({minValue:t._compressor.release.minValue,maxValue:t._compressor.release.maxValue,context:t.context,param:t._compressor.release,units:"time",value:r.release}),t.knee=new Co({minValue:t._compressor.knee.minValue,maxValue:t._compressor.knee.maxValue,context:t.context,convert:!1,param:t._compressor.knee,units:"decibels",value:r.knee}),t.ratio=new Co({minValue:t._compressor.ratio.minValue,maxValue:t._compressor.ratio.maxValue,context:t.context,convert:!1,param:t._compressor.ratio,units:"positive",value:r.ratio}),$r(n(t),["knee","release","attack","ratio","threshold"]),m(t)}return a(i,[{key:"reduction",get:function(){return this._compressor.reduction}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}}]),i}(Eo),ec=function(t){"use strict";d(n,t);var e=x(n);function n(){var t;o(this,n),(t=e.call(this,Object.assign(Vr(n.getDefaults(),arguments,["threshold","smoothing"])))).name="Gate";var i=Vr(n.getDefaults(),arguments,["threshold","smoothing"]);return t._follower=new su({context:t.context,smoothing:i.smoothing}),t._gt=new aa({context:t.context,value:lo(i.threshold)}),t.input=new Fo({context:t.context}),t._gate=t.output=new Fo({context:t.context}),t.input.connect(t._gate),t.input.chain(t._follower,t._gt,t._gate.gain),m(t)}return a(n,[{key:"threshold",get:function(){return ho(this._gt.value)},set:function(t){this._gt.value=lo(t)}},{key:"smoothing",get:function(){return this._follower.smoothing},set:function(t){this._follower.smoothing=t}},{key:"dispose",value:function(){return f(l(n.prototype),"dispose",this).call(this),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{smoothing:.1,threshold:-40})}}]),n}(Eo),nc=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Object.assign(Vr(i.getDefaults(),arguments,["threshold"])))).name="Limiter";var r=Vr(i.getDefaults(),arguments,["threshold"]);return t._compressor=t.input=t.output=new tc({context:t.context,ratio:20,attack:.003,release:.01,threshold:r.threshold}),t.threshold=t._compressor.threshold,$r(n(t),"threshold"),m(t)}return a(i,[{key:"reduction",get:function(){return this._compressor.reduction}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._compressor.dispose(),this.threshold.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{threshold:-12})}}]),i}(Eo),ic=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Object.assign(Vr(i.getDefaults(),arguments)))).name="MidSideCompressor";var r=Vr(i.getDefaults(),arguments);return t._midSideSplit=t.input=new Vu({context:t.context}),t._midSideMerge=t.output=new Fu({context:t.context}),t.mid=new tc(Object.assign(r.mid,{context:t.context})),t.side=new tc(Object.assign(r.side,{context:t.context})),t._midSideSplit.mid.chain(t.mid,t._midSideMerge.mid),t._midSideSplit.side.chain(t.side,t._midSideMerge.side),$r(n(t),["mid","side"]),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}}]),i}(Eo),rc=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Object.assign(Vr(i.getDefaults(),arguments)))).name="MultibandCompressor";var r=Vr(i.getDefaults(),arguments);return t._splitter=t.input=new Hu({context:t.context,lowFrequency:r.lowFrequency,highFrequency:r.highFrequency}),t.lowFrequency=t._splitter.lowFrequency,t.highFrequency=t._splitter.highFrequency,t.output=new Fo({context:t.context}),t.low=new tc(Object.assign(r.low,{context:t.context})),t.mid=new tc(Object.assign(r.mid,{context:t.context})),t.high=new tc(Object.assign(r.high,{context:t.context})),t._splitter.low.chain(t.low,t.output),t._splitter.mid.chain(t.mid,t.output),t._splitter.high.chain(t.high,t.output),$r(n(t),["high","mid","low","highFrequency","lowFrequency"]),m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}}]),i}(Eo),oc=function(t){"use strict";d(i,t);var e=x(i);function i(){var t;o(this,i),(t=e.call(this,Vr(i.getDefaults(),arguments,["low","mid","high"]))).name="EQ3",t.output=new Fo({context:t.context}),t._internalChannels=[];var r=Vr(i.getDefaults(),arguments,["low","mid","high"]);return t.input=t._multibandSplit=new Hu({context:t.context,highFrequency:r.highFrequency,lowFrequency:r.lowFrequency}),t._lowGain=new Fo({context:t.context,gain:r.low,units:"decibels"}),t._midGain=new Fo({context:t.context,gain:r.mid,units:"decibels"}),t._highGain=new Fo({context:t.context,gain:r.high,units:"decibels"}),t.low=t._lowGain.gain,t.mid=t._midGain.gain,t.high=t._highGain.gain,t.Q=t._multibandSplit.Q,t.lowFrequency=t._multibandSplit.lowFrequency,t.highFrequency=t._multibandSplit.highFrequency,t._multibandSplit.low.chain(t._lowGain,t.output),t._multibandSplit.mid.chain(t._midGain,t.output),t._multibandSplit.high.chain(t._highGain,t.output),$r(n(t),["low","mid","high","lowFrequency","highFrequency"]),t._internalChannels=[t._multibandSplit],m(t)}return a(i,[{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),Kr(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}}]),i}(Eo),sc=function(e){"use strict";d(i,e);var n=x(i);function i(){var t;o(this,i),(t=n.call(this,Vr(i.getDefaults(),arguments,["url","onload"]))).name="Convolver",t._convolver=t.context.createConvolver();var e=Vr(i.getDefaults(),arguments,["url","onload"]);return t._buffer=new eo(e.url,(function(n){t.buffer=n,e.onload()})),t.input=new Fo({context:t.context}),t.output=new Fo({context:t.context}),t._buffer.loaded&&(t.buffer=t._buffer),t.normalize=e.normalize,t.input.chain(t._convolver,t.output),m(t)}return a(i,[{key:"load",value:function(e){return Sr(this,void 0,void 0,t(T).mark((function n(){return t(T).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._buffer.load(e);case 2:this.buffer=t.sent;case 3:case"end":return t.stop()}}),n,this)})))}},{key:"buffer",get:function(){return this._buffer.length?this._buffer:null},set:function(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));var e=this._buffer.get();this._convolver.buffer=e||null}},{key:"normalize",get:function(){return this._convolver.normalize},set:function(t){this._convolver.normalize=t}},{key:"dispose",value:function(){return f(l(i.prototype),"dispose",this).call(this),this._buffer.dispose(),this._convolver.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Eo.getDefaults(),{normalize:!0,onload:to})}}]),i}(Eo);function ac(){return oo().now()}function uc(){return oo().immediate()}var cc=oo().transport;function lc(){return oo().transport}var hc=oo().destination,fc=oo().destination;function pc(){return oo().destination}var dc=oo().listener;function vc(){return oo().listener}var yc=oo().draw;function mc(){return oo().draw}var _c=oo();function gc(){return eo.loaded()}var kc=eo,xc=Yo,bc=ys}(),c}()},"object"==typeof e?e=w():"function"==typeof define&&define.amd?define([],w):"object"==typeof e?e.Tone=w():b.Tone=w();var A={sequencers:document.querySelectorAll(".sequencer__notes"),leds:document.querySelectorAll(".sequencer__leds"),polyrythms:document.querySelectorAll(".rythms > input"),selectors:document.querySelectorAll(".selector"),play:document.querySelector("#play"),reset:document.querySelector("#reset"),bpm:document.querySelector("#bpm"),xor:document.querySelector("#xor"),randomize:document.querySelector("#random"),vcos:document.querySelectorAll(".vcos > button"),shareButton:document.querySelector("#share"),shareUrl:document.querySelector("#shareUrl")},D=new e.Limiter(-1).toDestination(),O=new e.Volume(-10).connect(D),C=new e.Reverb({decay:5,wet:.3,preDelay:.1}).connect(O),E=(new e.Synth).connect(C),M=(new e.Synth).connect(C),q=new e.MembraneSynth({pitchDecay:.02}).connect(O),R={muted:[!1,!1,!1],tempo:120,notes1:["C4","D4","D#4","G4"],notes2:["G#3","F3","C3","C3"],polys:[16,2,5,9],seq1:[!1,!0,!0,!0],seq2:[!0,!1,!1,!1]};function V(){R.notes1.forEach((function(t,e){A.sequencers[0].querySelectorAll("input")[e].value=t.toString()})),R.notes2.forEach((function(t,e){A.sequencers[1].querySelectorAll("input")[e].value=t.toString()})),R.polys.forEach((function(t,e){A.polyrythms[e].value=t.toString()})),R.seq1.forEach((function(t,e){A.selectors[0].querySelectorAll("button")[e].classList.toggle("active",t)})),R.seq2.forEach((function(t,e){A.selectors[1].querySelectorAll("button")[e].classList.toggle("active",t)}))}R.notes1.forEach((function(t,e){A.sequencers[0].querySelectorAll("input")[e].value=t.toString()})),R.notes2.forEach((function(t,e){A.sequencers[1].querySelectorAll("input")[e].value=t.toString()})),R.polys.forEach((function(t,e){A.polyrythms[e].value=t.toString()})),R.seq1.forEach((function(t,e){A.selectors[0].querySelectorAll("button")[e].classList.toggle("active",t)})),R.seq2.forEach((function(t,e){A.selectors[1].querySelectorAll("button")[e].classList.toggle("active",t)}));var F=!1,I=0,P=0,j=0,L=!1;function N(t,e){return F?1===t.filter((function(t){return e%t==0})).length:t.some((function(t){return e%t==0}))}function z(){I%4!=0||R.muted[2]||q.triggerAttackRelease("C2","8n"),N(R.polys.filter((function(t,e){return R.seq1[e]})),I)&&(P=(P+1)%4,Array.from(A.leds[0].children).forEach((function(t,e){return t.classList.toggle("active",P===e)}))),N(R.polys.filter((function(t,e){return R.seq2[e]})),I)&&(j=(j+1)%4,Array.from(A.leds[1].children).forEach((function(t,e){return t.classList.toggle("active",j===e)}))),N(R.polys.filter((function(t,e){return R.seq2[e]||R.seq1[e]})),I)&&(R.muted[0]||E.triggerAttackRelease(R.notes1[P],"8n"),R.muted[1]||M.triggerAttackRelease(R.notes2[j],"8n")),I++,L&&setTimeout(z,6e4/R.tempo/4)}A.bpm.value=R.tempo.toString(),A.bpm.addEventListener("change",(function(){R.tempo=parseInt(A.bpm.value)})),A.sequencers[0].querySelectorAll("input").forEach((function(t,e){t.addEventListener("change",(function(){R.notes1[e]=t.value}))})),A.sequencers[1].querySelectorAll("input").forEach((function(t,e){t.addEventListener("change",(function(){R.notes2[e]=t.value}))})),Array.from(A.leds[0].children).forEach((function(t,e){return t.classList.toggle("active",P===e)})),Array.from(A.leds[1].children).forEach((function(t,e){return t.classList.toggle("active",j===e)})),A.polyrythms.forEach((function(t,e){t.addEventListener("change",(function(){R.polys[e]=parseInt(t.value)}))})),A.selectors[0].querySelectorAll("button").forEach((function(t,e){t.addEventListener("click",(function(){R.seq1[e]=!R.seq1[e],t.classList.toggle("active",R.seq1[e])}))})),A.selectors[1].querySelectorAll("button").forEach((function(t,e){t.addEventListener("click",(function(){R.seq2[e]=!R.seq2[e],t.classList.toggle("active",R.seq2[e])}))})),A.shareButton.addEventListener("click",(function(){A.shareUrl.hidden=!1,window.location.hash=btoa(JSON.stringify(R)),A.shareUrl.value=window.location})),A.play.addEventListener("click",(function(){L=!L,A.play.classList.toggle("active",L),L&&z()})),A.reset.addEventListener("click",(function(){I=0,P=0,j=0,Array.from(A.leds[0].children).forEach((function(t,e){return t.classList.toggle("active",P===e)})),Array.from(A.leds[1].children).forEach((function(t,e){return t.classList.toggle("active",j===e)}))})),A.vcos.forEach((function(t,e){t.addEventListener("click",(function(){R.muted[e]=!R.muted[e],t.classList.toggle("active",!R.muted[e])}))})),A.xor.addEventListener("click",(function(){F=!F,A.xor.classList.toggle("active",F)})),window.addEventListener("load",(function(){if(window.location.hash.length>0)try{t=window.location.hash.substr(1),R=JSON.parse(atob(t)),V()}catch(t){console.log("failed to parse sequence in url: ".concat(t))}var t})),A.randomize.addEventListener("click",(function(){R.notes1=R.notes1.map((function(t){return{value:t,sort:Math.random()}})).sort((function(t,e){return t.sort-e.sort})).map((function(t){return t.value})),R.notes2=R.notes2.map((function(t){return{value:t,sort:Math.random()}})).sort((function(t,e){return t.sort-e.sort})).map((function(t){return t.value})),R.polys=[Math.ceil(16*Math.random()),Math.ceil(16*Math.random()),Math.ceil(16*Math.random()),Math.ceil(16*Math.random())],R.seq1=[Math.random()>.5,Math.random()>.5,Math.random()>.5,Math.random()>.5],R.seq2=[Math.random()>.8,Math.random()>.8,Math.random()>.8,Math.random()>.8],V()}))}();
//# sourceMappingURL=index.da804924.js.map
